var Jn=Object.defineProperty;var mn=U=>{throw TypeError(U)};var Qn=(U,e,W)=>e in U?Jn(U,e,{enumerable:!0,configurable:!0,writable:!0,value:W}):U[e]=W;var Jt=(U,e,W)=>Qn(U,typeof e!="symbol"?e+"":e,W),De=(U,e,W)=>e.has(U)||mn("Cannot "+W);var t=(U,e,W)=>(De(U,e,"read from private field"),W?W.call(U):e.get(U)),rt=(U,e,W)=>e.has(U)?mn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(U):e.set(U,W),lt=(U,e,W,n)=>(De(U,e,"write to private field"),n?n.call(U,W):e.set(U,W),W),Y=(U,e,W)=>(De(U,e,"access private method"),W);var de=(U,e,W,n)=>({set _(f){lt(U,e,f,W)},get _(){return t(U,e,n)}});import{g as getAugmentedNamespace,a as getDefaultExportFromCjs,r as reactExports,R as React}from"./react-C14kkwO6.js";function _mergeNamespaces(U,e){for(var W=0;W<e.length;W++){const n=e[W];if(typeof n!="string"&&!Array.isArray(n)){for(const f in n)if(f!=="default"&&!(f in U)){const z=Object.getOwnPropertyDescriptor(n,f);z&&Object.defineProperty(U,f,z.get?z:{enumerable:!0,get:()=>n[f]})}}}return Object.freeze(Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(U){throw new Error('Could not dynamically require "'+U+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,W){module.exports=e.pdfjsLib=W()})(globalThis,()=>(()=>{var __webpack_modules__=[,(U,e)=>{var qt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=C,e.bytesToString=ht,e.createValidAbsoluteUrl=nt,e.getModificationDate=Pt,e.getUuid=It,e.getVerbosityLevel=$,e.info=K,e.isArrayBuffer=Q,e.isArrayEqual=wt,e.isNodeJS=void 0,e.normalizeUnicode=Ft,e.objectFromMap=bt,e.objectSize=ft,e.setVerbosityLevel=et,e.shadow=S,e.string32=yt,e.stringToBytes=gt,e.stringToPDFString=mt,e.stringToUTF8String=St,e.unreachable=at,e.utf8StringToString=vt,e.warn=G;const W=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=W;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const f=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=f;const z=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=z;const H=1.35;e.LINE_FACTOR=H;const ut=.35;e.LINE_DESCENT_FACTOR=ut;const k=ut/H;e.BASELINE_FACTOR=k;const w={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=w;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=m;const B="pdfjs_internal_editor_";e.AnnotationEditorPrefix=B;const I={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=I;const _={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=_;const b={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=b;const T={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=T;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=g;const u={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=u;const y={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=y;const D={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=D;const v={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=v;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=o;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=d;const l={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=l;const c={O:"PageOpen",C:"PageClose"};e.PageActionEventType=c;const h={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=h;const O={NONE:0,BINARY:1};e.CMapCompressionType=O;const a={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=a;const E={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=E;let x=h.WARNINGS;function et(Et){Number.isInteger(Et)&&(x=Et)}function $(){return x}function K(Et){x>=h.INFOS&&console.log(`Info: ${Et}`)}function G(Et){x>=h.WARNINGS&&console.log(`Warning: ${Et}`)}function at(Et){throw new Error(Et)}function C(Et,ot){Et||at(ot)}function V(Et){switch(Et==null?void 0:Et.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function nt(Et,ot=null,ct=null){if(!Et)return null;try{if(ct&&typeof Et=="string"){if(ct.addDefaultProtocol&&Et.startsWith("www.")){const Xt=Et.match(/\./g);(Xt==null?void 0:Xt.length)>=2&&(Et=`http://${Et}`)}if(ct.tryConvertEncoding)try{Et=St(Et)}catch{}}const kt=ot?new URL(Et,ot):new URL(Et);if(V(kt))return kt}catch{}return null}function S(Et,ot,ct,kt=!1){return Object.defineProperty(Et,ot,{value:ct,enumerable:!kt,configurable:!0,writable:!1}),ct}const s=function(){function ot(ct,kt){this.constructor===ot&&at("Cannot initialize BaseException."),this.message=ct,this.name=kt}return ot.prototype=new Error,ot.constructor=ot,ot}();e.BaseException=s;class i extends s{constructor(ot,ct){super(ot,"PasswordException"),this.code=ct}}e.PasswordException=i;class p extends s{constructor(ot,ct){super(ot,"UnknownErrorException"),this.details=ct}}e.UnknownErrorException=p;class F extends s{constructor(ot){super(ot,"InvalidPDFException")}}e.InvalidPDFException=F;class M extends s{constructor(ot){super(ot,"MissingPDFException")}}e.MissingPDFException=M;class L extends s{constructor(ot,ct){super(ot,"UnexpectedResponseException"),this.status=ct}}e.UnexpectedResponseException=L;class q extends s{constructor(ot){super(ot,"FormatError")}}e.FormatError=q;class st extends s{constructor(ot){super(ot,"AbortException")}}e.AbortException=st;function ht(Et){(typeof Et!="object"||(Et==null?void 0:Et.length)===void 0)&&at("Invalid argument for bytesToString");const ot=Et.length,ct=8192;if(ot<ct)return String.fromCharCode.apply(null,Et);const kt=[];for(let Xt=0;Xt<ot;Xt+=ct){const Vt=Math.min(Xt+ct,ot),j=Et.subarray(Xt,Vt);kt.push(String.fromCharCode.apply(null,j))}return kt.join("")}function gt(Et){typeof Et!="string"&&at("Invalid argument for stringToBytes");const ot=Et.length,ct=new Uint8Array(ot);for(let kt=0;kt<ot;++kt)ct[kt]=Et.charCodeAt(kt)&255;return ct}function yt(Et){return String.fromCharCode(Et>>24&255,Et>>16&255,Et>>8&255,Et&255)}function ft(Et){return Object.keys(Et).length}function bt(Et){const ot=Object.create(null);for(const[ct,kt]of Et)ot[ct]=kt;return ot}function Z(){const Et=new Uint8Array(4);return Et[0]=1,new Uint32Array(Et.buffer,0,1)[0]===1}function tt(){try{return new Function(""),!0}catch{return!1}}class A{static get isLittleEndian(){return S(this,"isLittleEndian",Z())}static get isEvalSupported(){return S(this,"isEvalSupported",tt())}static get isOffscreenCanvasSupported(){return S(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?S(this,"platform",{isWin:!1,isMac:!1}):S(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ot,ct;return S(this,"isCSSRoundSupported",(ct=(ot=globalThis.CSS)==null?void 0:ot.supports)==null?void 0:ct.call(ot,"width: round(1.5px, 1px)"))}}e.FeatureTest=A;const N=[...Array(256).keys()].map(Et=>Et.toString(16).padStart(2,"0"));class J{static makeHexColor(ot,ct,kt){return`#${N[ot]}${N[ct]}${N[kt]}`}static scaleMinMax(ot,ct){let kt;ot[0]?(ot[0]<0&&(kt=ct[0],ct[0]=ct[1],ct[1]=kt),ct[0]*=ot[0],ct[1]*=ot[0],ot[3]<0&&(kt=ct[2],ct[2]=ct[3],ct[3]=kt),ct[2]*=ot[3],ct[3]*=ot[3]):(kt=ct[0],ct[0]=ct[2],ct[2]=kt,kt=ct[1],ct[1]=ct[3],ct[3]=kt,ot[1]<0&&(kt=ct[2],ct[2]=ct[3],ct[3]=kt),ct[2]*=ot[1],ct[3]*=ot[1],ot[2]<0&&(kt=ct[0],ct[0]=ct[1],ct[1]=kt),ct[0]*=ot[2],ct[1]*=ot[2]),ct[0]+=ot[4],ct[1]+=ot[4],ct[2]+=ot[5],ct[3]+=ot[5]}static transform(ot,ct){return[ot[0]*ct[0]+ot[2]*ct[1],ot[1]*ct[0]+ot[3]*ct[1],ot[0]*ct[2]+ot[2]*ct[3],ot[1]*ct[2]+ot[3]*ct[3],ot[0]*ct[4]+ot[2]*ct[5]+ot[4],ot[1]*ct[4]+ot[3]*ct[5]+ot[5]]}static applyTransform(ot,ct){const kt=ot[0]*ct[0]+ot[1]*ct[2]+ct[4],Xt=ot[0]*ct[1]+ot[1]*ct[3]+ct[5];return[kt,Xt]}static applyInverseTransform(ot,ct){const kt=ct[0]*ct[3]-ct[1]*ct[2],Xt=(ot[0]*ct[3]-ot[1]*ct[2]+ct[2]*ct[5]-ct[4]*ct[3])/kt,Vt=(-ot[0]*ct[1]+ot[1]*ct[0]+ct[4]*ct[1]-ct[5]*ct[0])/kt;return[Xt,Vt]}static getAxialAlignedBoundingBox(ot,ct){const kt=this.applyTransform(ot,ct),Xt=this.applyTransform(ot.slice(2,4),ct),Vt=this.applyTransform([ot[0],ot[3]],ct),j=this.applyTransform([ot[2],ot[1]],ct);return[Math.min(kt[0],Xt[0],Vt[0],j[0]),Math.min(kt[1],Xt[1],Vt[1],j[1]),Math.max(kt[0],Xt[0],Vt[0],j[0]),Math.max(kt[1],Xt[1],Vt[1],j[1])]}static inverseTransform(ot){const ct=ot[0]*ot[3]-ot[1]*ot[2];return[ot[3]/ct,-ot[1]/ct,-ot[2]/ct,ot[0]/ct,(ot[2]*ot[5]-ot[4]*ot[3])/ct,(ot[4]*ot[1]-ot[5]*ot[0])/ct]}static singularValueDecompose2dScale(ot){const ct=[ot[0],ot[2],ot[1],ot[3]],kt=ot[0]*ct[0]+ot[1]*ct[2],Xt=ot[0]*ct[1]+ot[1]*ct[3],Vt=ot[2]*ct[0]+ot[3]*ct[2],j=ot[2]*ct[1]+ot[3]*ct[3],_t=(kt+j)/2,Ct=Math.sqrt((kt+j)**2-4*(kt*j-Vt*Xt))/2,Lt=_t+Ct||1,Bt=_t-Ct||1;return[Math.sqrt(Lt),Math.sqrt(Bt)]}static normalizeRect(ot){const ct=ot.slice(0);return ot[0]>ot[2]&&(ct[0]=ot[2],ct[2]=ot[0]),ot[1]>ot[3]&&(ct[1]=ot[3],ct[3]=ot[1]),ct}static intersect(ot,ct){const kt=Math.max(Math.min(ot[0],ot[2]),Math.min(ct[0],ct[2])),Xt=Math.min(Math.max(ot[0],ot[2]),Math.max(ct[0],ct[2]));if(kt>Xt)return null;const Vt=Math.max(Math.min(ot[1],ot[3]),Math.min(ct[1],ct[3])),j=Math.min(Math.max(ot[1],ot[3]),Math.max(ct[1],ct[3]));return Vt>j?null:[kt,Vt,Xt,j]}static bezierBoundingBox(ot,ct,kt,Xt,Vt,j,_t,Ct){const Lt=[],Bt=[[],[]];let Rt,R,P,X,dt,pt,At,Tt;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(R=6*ot-12*kt+6*Vt,Rt=-3*ot+9*kt-9*Vt+3*_t,P=3*kt-3*ot):(R=6*ct-12*Xt+6*j,Rt=-3*ct+9*Xt-9*j+3*Ct,P=3*Xt-3*ct),Math.abs(Rt)<1e-12){if(Math.abs(R)<1e-12)continue;X=-P/R,0<X&&X<1&&Lt.push(X);continue}At=R*R-4*P*Rt,Tt=Math.sqrt(At),!(At<0)&&(dt=(-R+Tt)/(2*Rt),0<dt&&dt<1&&Lt.push(dt),pt=(-R-Tt)/(2*Rt),0<pt&&pt<1&&Lt.push(pt))}let Ot=Lt.length,Mt;const xt=Ot;for(;Ot--;)X=Lt[Ot],Mt=1-X,Bt[0][Ot]=Mt*Mt*Mt*ot+3*Mt*Mt*X*kt+3*Mt*X*X*Vt+X*X*X*_t,Bt[1][Ot]=Mt*Mt*Mt*ct+3*Mt*Mt*X*Xt+3*Mt*X*X*j+X*X*X*Ct;return Bt[0][xt]=ot,Bt[1][xt]=ct,Bt[0][xt+1]=_t,Bt[1][xt+1]=Ct,Bt[0].length=Bt[1].length=xt+2,[Math.min(...Bt[0]),Math.min(...Bt[1]),Math.max(...Bt[0]),Math.max(...Bt[1])]}}e.Util=J;const it=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function mt(Et){if(Et[0]>="ï"){let ct;if(Et[0]==="þ"&&Et[1]==="ÿ"?ct="utf-16be":Et[0]==="ÿ"&&Et[1]==="þ"?ct="utf-16le":Et[0]==="ï"&&Et[1]==="»"&&Et[2]==="¿"&&(ct="utf-8"),ct)try{const kt=new TextDecoder(ct,{fatal:!0}),Xt=gt(Et);return kt.decode(Xt)}catch(kt){G(`stringToPDFString: "${kt}".`)}}const ot=[];for(let ct=0,kt=Et.length;ct<kt;ct++){const Xt=it[Et.charCodeAt(ct)];ot.push(Xt?String.fromCharCode(Xt):Et.charAt(ct))}return ot.join("")}function St(Et){return decodeURIComponent(escape(Et))}function vt(Et){return unescape(encodeURIComponent(Et))}function Q(Et){return typeof Et=="object"&&(Et==null?void 0:Et.byteLength)!==void 0}function wt(Et,ot){if(Et.length!==ot.length)return!1;for(let ct=0,kt=Et.length;ct<kt;ct++)if(Et[ct]!==ot[ct])return!1;return!0}function Pt(Et=new Date){return[Et.getUTCFullYear().toString(),(Et.getUTCMonth()+1).toString().padStart(2,"0"),Et.getUTCDate().toString().padStart(2,"0"),Et.getUTCHours().toString().padStart(2,"0"),Et.getUTCMinutes().toString().padStart(2,"0"),Et.getUTCSeconds().toString().padStart(2,"0")].join("")}class Wt{constructor(){rt(this,qt,!1);this.promise=new Promise((ot,ct)=>{this.resolve=kt=>{lt(this,qt,!0),ot(kt)},this.reject=kt=>{lt(this,qt,!0),ct(kt)}})}get settled(){return t(this,qt)}}qt=new WeakMap,e.PromiseCapability=Wt;let Ut=null,zt=null;function Ft(Et){return Ut||(Ut=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zt=new Map([["ﬅ","ſt"]])),Et.replaceAll(Ut,(ot,ct,kt)=>ct?ct.normalize("NFKC"):zt.get(kt))}function It(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Et=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Et);else for(let ot=0;ot<32;ot++)Et[ot]=Math.floor(Math.random()*255);return ht(Et)}const Gt="pdfjs_internal_id_";e.AnnotationPrefix=Gt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var U,W,n,f,ae,ye,ut,k,w,m,B,I,_,b,T,Ae,u,y,Le,v,o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(l){if(typeof l=="string"||l instanceof URL?l={url:l}:(0,_util.isArrayBuffer)(l)&&(l={data:l}),typeof l!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!l.url&&!l.data&&!l.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:h}=c,O=l.url?getUrlProp(l.url):null,a=l.data?getDataProp(l.data):null,E=l.httpHeaders||null,x=l.withCredentials===!0,et=l.password??null,$=l.range instanceof PDFDataRangeTransport?l.range:null,K=Number.isInteger(l.rangeChunkSize)&&l.rangeChunkSize>0?l.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let G=l.worker instanceof PDFWorker?l.worker:null;const at=l.verbosity,C=typeof l.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(l.docBaseUrl)?l.docBaseUrl:null,V=typeof l.cMapUrl=="string"?l.cMapUrl:null,nt=l.cMapPacked!==!1,S=l.CMapReaderFactory||DefaultCMapReaderFactory,s=typeof l.standardFontDataUrl=="string"?l.standardFontDataUrl:null,i=l.StandardFontDataFactory||DefaultStandardFontDataFactory,p=l.stopAtErrors!==!0,F=Number.isInteger(l.maxImageSize)&&l.maxImageSize>-1?l.maxImageSize:-1,M=l.isEvalSupported!==!1,L=typeof l.isOffscreenCanvasSupported=="boolean"?l.isOffscreenCanvasSupported:!_util.isNodeJS,q=Number.isInteger(l.canvasMaxAreaInBytes)?l.canvasMaxAreaInBytes:-1,st=typeof l.disableFontFace=="boolean"?l.disableFontFace:_util.isNodeJS,ht=l.fontExtraProperties===!0,gt=l.enableXfa===!0,yt=l.ownerDocument||globalThis.document,ft=l.disableRange===!0,bt=l.disableStream===!0,Z=l.disableAutoFetch===!0,tt=l.pdfBug===!0,A=$?$.length:l.length??NaN,N=typeof l.useSystemFonts=="boolean"?l.useSystemFonts:!_util.isNodeJS&&!st,J=typeof l.useWorkerFetch=="boolean"?l.useWorkerFetch:S===_display_utils.DOMCMapReaderFactory&&i===_display_utils.DOMStandardFontDataFactory&&V&&s&&(0,_display_utils.isValidFetchUrl)(V,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(s,document.baseURI),it=l.canvasFactory||new DefaultCanvasFactory({ownerDocument:yt}),mt=l.filterFactory||new DefaultFilterFactory({docId:h,ownerDocument:yt}),St=null;(0,_util.setVerbosityLevel)(at);const vt={canvasFactory:it,filterFactory:mt};if(J||(vt.cMapReaderFactory=new S({baseUrl:V,isCompressed:nt}),vt.standardFontDataFactory=new i({baseUrl:s})),!G){const Pt={verbosity:at,port:_worker_options.GlobalWorkerOptions.workerPort};G=Pt.port?PDFWorker.fromPort(Pt):new PDFWorker(Pt),c._worker=G}const Q={docId:h,apiVersion:"3.11.174",data:a,password:et,disableAutoFetch:Z,rangeChunkSize:K,length:A,docBaseUrl:C,enableXfa:gt,evaluatorOptions:{maxImageSize:F,disableFontFace:st,ignoreErrors:p,isEvalSupported:M,isOffscreenCanvasSupported:L,canvasMaxAreaInBytes:q,fontExtraProperties:ht,useSystemFonts:N,cMapUrl:J?V:null,standardFontDataUrl:J?s:null}},wt={ignoreErrors:p,isEvalSupported:M,disableFontFace:st,fontExtraProperties:ht,enableXfa:gt,ownerDocument:yt,disableAutoFetch:Z,pdfBug:tt,styleElement:St};return G.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const Pt=_fetchDocument(G,Q),Wt=new Promise(function(Ut){let zt;$?zt=new _transport_stream.PDFDataTransportStream({length:A,initialData:$.initialData,progressiveDone:$.progressiveDone,contentDispositionFilename:$.contentDispositionFilename,disableRange:ft,disableStream:bt},$):a||(zt=(It=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(It):(0,_display_utils.isValidFetchUrl)(It.url)?new _displayFetch_stream.PDFFetchStream(It):new _displayNetwork.PDFNetworkStream(It))({url:O,length:A,httpHeaders:E,withCredentials:x,rangeChunkSize:K,disableRange:ft,disableStream:bt})),Ut(zt)});return Promise.all([Pt,Wt]).then(function([Ut,zt]){if(c.destroyed)throw new Error("Loading aborted");const Ft=new _message_handler.MessageHandler(h,Ut,G.port),It=new WorkerTransport(Ft,c,zt,wt,vt);c._transport=It,Ft.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(l,c){if(l.destroyed)throw new Error("Worker was destroyed");const h=await l.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(l.destroyed)throw new Error("Worker was destroyed");return h}function getUrlProp(l){if(l instanceof URL)return l.href;try{return new URL(l,window.location).href}catch{if(_util.isNodeJS&&typeof l=="string")return l}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(l){if(_util.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength)return l;if(typeof l=="string")return(0,_util.stringToBytes)(l);if(typeof l=="object"&&!isNaN(l==null?void 0:l.length)||(0,_util.isArrayBuffer)(l))return new Uint8Array(l);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${de(e,U)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,h,O;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((h=this._transport)==null?void 0:h.destroy())}catch(a){throw(O=this._worker)!=null&&O.port&&delete this._worker._pendingDestroy,a}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};U=new WeakMap,rt(e,U,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,h,O=!1,a=null){this.length=c,this.initialData=h,this.progressiveDone=O,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,h){for(const O of this._rangeListeners)O(c,h)}onDataProgress(c,h){this._readyCapability.promise.then(()=>{for(const O of this._progressListeners)O(c,h)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const h of this._progressiveReadListeners)h(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,h){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,h){this._pdfInfo=c,this._transport=h,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(O=>{if(!O)return O;const a=[];for(const E in O)a.push(...O[E]);return a}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,h,O,a=!1){rt(this,f);rt(this,W,null);rt(this,n,!1);this._pageIndex=c,this._pageInfo=h,this._transport=O,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=O.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:h=this.rotate,offsetX:O=0,offsetY:a=0,dontFlip:E=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:h,offsetX:O,offsetY:a,dontFlip:E})}getAnnotations({intent:c="display"}={}){const h=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,h.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:h,intent:O="display",annotationMode:a=_util.AnnotationMode.ENABLE,transform:E=null,background:x=null,optionalContentConfigPromise:et=null,annotationCanvasMap:$=null,pageColors:K=null,printAnnotationStorage:G=null}){var i,p;(i=this._stats)==null||i.time("Overall");const at=this._transport.getRenderingIntent(O,a,G);lt(this,n,!1),Y(this,f,ye).call(this),et||(et=this._transport.getOptionalContentConfig());let C=this._intentStates.get(at.cacheKey);C||(C=Object.create(null),this._intentStates.set(at.cacheKey,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const V=!!(at.renderingIntent&_util.RenderingIntentFlag.PRINT);C.displayReadyCapability||(C.displayReadyCapability=new _util.PromiseCapability,C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(at));const nt=F=>{var M,L;C.renderTasks.delete(S),(this._maybeCleanupAfterRender||V)&&lt(this,n,!0),Y(this,f,ae).call(this,!V),F?(S.capability.reject(F),this._abortOperatorList({intentState:C,reason:F instanceof Error?F:new Error(F)})):S.capability.resolve(),(M=this._stats)==null||M.timeEnd("Rendering"),(L=this._stats)==null||L.timeEnd("Overall")},S=new InternalRenderTask({callback:nt,params:{canvasContext:c,viewport:h,transform:E,background:x},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:$,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!V,pdfBug:this._pdfBug,pageColors:K});(C.renderTasks||(C.renderTasks=new Set)).add(S);const s=S.task;return Promise.all([C.displayReadyCapability.promise,et]).then(([F,M])=>{var L;if(this.destroyed){nt();return}(L=this._stats)==null||L.time("Rendering"),S.initializeGraphics({transparency:F,optionalContentConfig:M}),S.operatorListChanged()}).catch(nt),s}getOperatorList({intent:c="display",annotationMode:h=_util.AnnotationMode.ENABLE,printAnnotationStorage:O=null}={}){var $;function a(){x.operatorList.lastChunk&&(x.opListReadCapability.resolve(x.operatorList),x.renderTasks.delete(et))}const E=this._transport.getRenderingIntent(c,h,O,!0);let x=this._intentStates.get(E.cacheKey);x||(x=Object.create(null),this._intentStates.set(E.cacheKey,x));let et;return x.opListReadCapability||(et=Object.create(null),et.operatorListChanged=a,x.opListReadCapability=new _util.PromiseCapability,(x.renderTasks||(x.renderTasks=new Set)).add(et),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},($=this._stats)==null||$.time("Page Request"),this._pumpOperatorList(E)),x.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:h=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:h===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(O=>_xfa_text.XfaText.textContent(O));const h=this.streamTextContent(c);return new Promise(function(O,a){function E(){x.read().then(function({value:$,done:K}){if(K){O(et);return}Object.assign(et.styles,$.styles),et.items.push(...$.items),E()},a)}const x=h.getReader(),et={items:[],styles:Object.create(null)};E()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const h of this._intentStates.values())if(this._abortOperatorList({intentState:h,reason:new Error("Page was destroyed."),force:!0}),!h.opListReadCapability)for(const O of h.renderTasks)c.push(O.completed),O.cancel();return this.objs.clear(),lt(this,n,!1),Y(this,f,ye).call(this),Promise.all(c)}cleanup(c=!1){lt(this,n,!0);const h=Y(this,f,ae).call(this,!1);return c&&h&&this._stats&&(this._stats=new _display_utils.StatTimer),h}_startRenderPage(c,h){var a,E;const O=this._intentStates.get(h);O&&((a=this._stats)==null||a.timeEnd("Page Request"),(E=O.displayReadyCapability)==null||E.resolve(c))}_renderPageChunk(c,h){for(let O=0,a=c.length;O<a;O++)h.operatorList.fnArray.push(c.fnArray[O]),h.operatorList.argsArray.push(c.argsArray[O]);h.operatorList.lastChunk=c.lastChunk,h.operatorList.separateAnnots=c.separateAnnots;for(const O of h.renderTasks)O.operatorListChanged();c.lastChunk&&Y(this,f,ae).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:h,annotationStorageSerializable:O}){const{map:a,transfers:E}=O,et=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:h,annotationStorage:a},E).getReader(),$=this._intentStates.get(h);$.streamReader=et;const K=()=>{et.read().then(({value:G,done:at})=>{if(at){$.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(G,$),K())},G=>{if($.streamReader=null,!this._transport.destroyed){if($.operatorList){$.operatorList.lastChunk=!0;for(const at of $.renderTasks)at.operatorListChanged();Y(this,f,ae).call(this,!0)}if($.displayReadyCapability)$.displayReadyCapability.reject(G);else if($.opListReadCapability)$.opListReadCapability.reject(G);else throw G}})};K()}_abortOperatorList({intentState:c,reason:h,force:O=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!O){if(c.renderTasks.size>0)return;if(h instanceof _display_utils.RenderingCancelledException){let a=RENDERING_CANCELLED_TIMEOUT;h.extraDelay>0&&h.extraDelay<1e3&&(a+=h.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:h,force:!0})},a);return}}if(c.streamReader.cancel(new _util.AbortException(h.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[a,E]of this._intentStates)if(E===c){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}W=new WeakMap,n=new WeakMap,f=new WeakSet,ae=function(c=!1){if(Y(this,f,ye).call(this),!t(this,n)||this.destroyed)return!1;if(c)return lt(this,W,setTimeout(()=>{lt(this,W,null),Y(this,f,ae).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:h,operatorList:O}of this._intentStates.values())if(h.size>0||!O.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),lt(this,n,!1),!0},ye=function(){t(this,W)&&(clearTimeout(t(this,W)),lt(this,W,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){rt(this,ut,new Set);rt(this,k,Promise.resolve())}postMessage(c,h){const O={data:structuredClone(c,h?{transfer:h}:null)};t(this,k).then(()=>{for(const a of t(this,ut))a.call(this,O)})}addEventListener(c,h){t(this,ut).add(h)}removeEventListener(c,h){t(this,ut).delete(h)}terminate(){t(this,ut).clear()}}ut=new WeakMap,k=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const l=(w=document==null?void 0:document.currentScript)==null?void 0:w.src;l&&(PDFWorkerUtil.fallbackWorkerSrc=l.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(l,c){let h;try{if(h=new URL(l),!h.origin||h.origin==="null")return!1}catch{return!1}const O=new URL(c,h);return h.origin===O.origin},PDFWorkerUtil.createCDNWrapper=function(l){const c=`importScripts("${l}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:l=null,port:c=null,verbosity:h=(0,_util.getVerbosityLevel)()}={}){var O;if(this.name=l,this.destroyed=!1,this.verbosity=h,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((O=t(_PDFWorker,m))!=null&&O.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,m)||lt(_PDFWorker,m,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(l){this._port=l,this._messageHandler=new _message_handler.MessageHandler("main","worker",l),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:l}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,l)||(l=PDFWorkerUtil.createCDNWrapper(new URL(l,window.location).href));const c=new Worker(l),h=new _message_handler.MessageHandler("main","worker",c),O=()=>{c.removeEventListener("error",a),h.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||O()};c.addEventListener("error",a),h.on("test",x=>{if(c.removeEventListener("error",a),this.destroyed){O();return}x?(this._messageHandler=h,this._port=c,this._webWorker=c,this._readyCapability.resolve(),h.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),h.destroy(),c.terminate())}),h.on("ready",x=>{if(c.removeEventListener("error",a),this.destroyed){O();return}try{E()}catch{this._setupFakeWorker()}});const E=()=>{const x=new Uint8Array;h.send("test",x,[x.buffer])};E();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(l=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const h=`fake${PDFWorkerUtil.fakeWorkerId++}`,O=new _message_handler.MessageHandler(h+"_worker",h,c);l.setup(O,c);const a=new _message_handler.MessageHandler(h,h+"_worker",c);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(l=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${l.message}".`))})}destroy(){var l;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(l=t(_PDFWorker,m))==null||l.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(l){var h;if(!(l!=null&&l.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(h=t(this,m))==null?void 0:h.get(l.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(l)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var l;try{return((l=globalThis.pdfjsWorker)==null?void 0:l.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};m=new WeakMap,rt(_PDFWorker,m);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,h,O,a,E){rt(this,T);rt(this,B,new Map);rt(this,I,new Map);rt(this,_,new Map);rt(this,b,null);this.messageHandler=c,this.loadingTask=h,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this._params=a,this.canvasFactory=E.canvasFactory,this.filterFactory=E.filterFactory,this.cMapReaderFactory=E.cMapReaderFactory,this.standardFontDataFactory=E.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=O,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,h=_util.AnnotationMode.ENABLE,O=null,a=!1){let E=_util.RenderingIntentFlag.DISPLAY,x=_annotation_storage.SerializableEmpty;switch(c){case"any":E=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":E=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(h){case _util.AnnotationMode.DISABLE:E+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:E+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:E+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,x=(E&_util.RenderingIntentFlag.PRINT&&O instanceof _annotation_storage.PrintAnnotationStorage?O:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${h}`)}return a&&(E+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:E,cacheKey:`${E}_${x.hash}`,annotationStorageSerializable:x}}destroy(){var O;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(O=t(this,b))==null||O.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const a of t(this,I).values())c.push(a._destroy());t(this,I).clear(),t(this,_).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const h=this.messageHandler.sendWithPromise("Terminate",null);return c.push(h),Promise.all(c).then(()=>{var a;this.commonObjs.clear(),this.fontLoader.clear(),t(this,B).clear(),this.filterFactory.destroy(),(a=this._networkStream)==null||a.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:h}=this;c.on("GetReader",(O,a)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=E=>{this._lastProgress={loaded:E.loaded,total:E.total}},a.onPull=()=>{this._fullReader.read().then(function({value:E,done:x}){if(x){a.close();return}(0,_util.assert)(E instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{a.error(E)})},a.onCancel=E=>{this._fullReader.cancel(E),a.ready.catch(x=>{if(!this.destroyed)throw x})}}),c.on("ReaderHeadersReady",O=>{const a=new _util.PromiseCapability,E=this._fullReader;return E.headersReady.then(()=>{var x;(!E.isStreamingSupported||!E.isRangeSupported)&&(this._lastProgress&&((x=h.onProgress)==null||x.call(h,this._lastProgress)),E.onProgress=et=>{var $;($=h.onProgress)==null||$.call(h,{loaded:et.loaded,total:et.total})}),a.resolve({isStreamingSupported:E.isStreamingSupported,isRangeSupported:E.isRangeSupported,contentLength:E.contentLength})},a.reject),a.promise}),c.on("GetRangeReader",(O,a)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const E=this._networkStream.getRangeReader(O.begin,O.end);if(!E){a.close();return}a.onPull=()=>{E.read().then(function({value:x,done:et}){if(et){a.close();return}(0,_util.assert)(x instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(x),1,[x])}).catch(x=>{a.error(x)})},a.onCancel=x=>{E.cancel(x),a.ready.catch(et=>{if(!this.destroyed)throw et})}}),c.on("GetDoc",({pdfInfo:O})=>{this._numPages=O.numPages,this._htmlForXfa=O.htmlForXfa,delete O.htmlForXfa,h._capability.resolve(new PDFDocumentProxy(O,this))}),c.on("DocException",function(O){let a;switch(O.name){case"PasswordException":a=new _util.PasswordException(O.message,O.code);break;case"InvalidPDFException":a=new _util.InvalidPDFException(O.message);break;case"MissingPDFException":a=new _util.MissingPDFException(O.message);break;case"UnexpectedResponseException":a=new _util.UnexpectedResponseException(O.message,O.status);break;case"UnknownErrorException":a=new _util.UnknownErrorException(O.message,O.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}h._capability.reject(a)}),c.on("PasswordRequest",O=>{if(lt(this,b,new _util.PromiseCapability),h.onPassword){const a=E=>{E instanceof Error?t(this,b).reject(E):t(this,b).resolve({password:E})};try{h.onPassword(a,O.code)}catch(E){t(this,b).reject(E)}}else t(this,b).reject(new _util.PasswordException(O.message,O.code));return t(this,b).promise}),c.on("DataLoaded",O=>{var a;(a=h.onProgress)==null||a.call(h,{loaded:O.length,total:O.length}),this.downloadInfoCapability.resolve(O)}),c.on("StartRenderPage",O=>{if(this.destroyed)return;t(this,I).get(O.pageIndex)._startRenderPage(O.transparency,O.cacheKey)}),c.on("commonobj",([O,a,E])=>{var x;if(!this.destroyed&&!this.commonObjs.has(O))switch(a){case"Font":const et=this._params;if("error"in E){const G=E.error;(0,_util.warn)(`Error during font loading: ${G}`),this.commonObjs.resolve(O,G);break}const $=et.pdfBug&&((x=globalThis.FontInspector)!=null&&x.enabled)?(G,at)=>globalThis.FontInspector.fontAdded(G,at):null,K=new _font_loader.FontFaceObject(E,{isEvalSupported:et.isEvalSupported,disableFontFace:et.disableFontFace,ignoreErrors:et.ignoreErrors,inspectFont:$});this.fontLoader.bind(K).catch(G=>c.sendWithPromise("FontFallback",{id:O})).finally(()=>{!et.fontExtraProperties&&K.data&&(K.data=null),this.commonObjs.resolve(O,K)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(O,E);break;default:throw new Error(`Got unknown common object type ${a}`)}}),c.on("obj",([O,a,E,x])=>{var $;if(this.destroyed)return;const et=t(this,I).get(a);if(!et.objs.has(O))switch(E){case"Image":if(et.objs.resolve(O,x),x){let K;if(x.bitmap){const{width:G,height:at}=x;K=G*at*4}else K=(($=x.data)==null?void 0:$.length)||0;K>_util.MAX_IMAGE_SIZE_TO_CACHE&&(et._maybeCleanupAfterRender=!0)}break;case"Pattern":et.objs.resolve(O,x);break;default:throw new Error(`Got unknown object type ${E}`)}}),c.on("DocProgress",O=>{var a;this.destroyed||(a=h.onProgress)==null||a.call(h,{loaded:O.loaded,total:O.total})}),c.on("FetchBuiltInCMap",O=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(O):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",O=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(O):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var O;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:h}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((O=this._fullReader)==null?void 0:O.filename)??null},h).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const h=c-1,O=t(this,_).get(h);if(O)return O;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:h}).then(E=>{if(this.destroyed)throw new Error("Transport destroyed");const x=new PDFPageProxy(h,E,this,this._params.pdfBug);return t(this,I).set(h,x),x});return t(this,_).set(h,a),a}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,h){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:h})}getFieldObjects(){return Y(this,T,Ae).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,T,Ae).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,T,Ae).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",h=t(this,B).get(c);if(h)return h;const O=this.messageHandler.sendWithPromise(c,null).then(a=>{var E,x;return{info:a[0],metadata:a[1]?new _metadata.Metadata(a[1]):null,contentDispositionFilename:((E=this._fullReader)==null?void 0:E.filename)??null,contentLength:((x=this._fullReader)==null?void 0:x.contentLength)??null}});return t(this,B).set(c,O),O}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const h of t(this,I).values())if(!h.cleanup())throw new Error(`startCleanup: Page ${h.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),t(this,B).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:h}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:h})}}B=new WeakMap,I=new WeakMap,_=new WeakMap,b=new WeakMap,T=new WeakSet,Ae=function(c,h=null){const O=t(this,B).get(c);if(O)return O;const a=this.messageHandler.sendWithPromise(c,h);return t(this,B).set(c,a),a};class PDFObjects{constructor(){rt(this,y);rt(this,u,Object.create(null))}get(c,h=null){if(h){const a=Y(this,y,Le).call(this,c);return a.capability.promise.then(()=>h(a.data)),null}const O=t(this,u)[c];if(!(O!=null&&O.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return O.data}has(c){const h=t(this,u)[c];return(h==null?void 0:h.capability.settled)||!1}resolve(c,h=null){const O=Y(this,y,Le).call(this,c);O.data=h,O.capability.resolve()}clear(){var c;for(const h in t(this,u)){const{data:O}=t(this,u)[h];(c=O==null?void 0:O.bitmap)==null||c.close()}lt(this,u,Object.create(null))}}u=new WeakMap,y=new WeakSet,Le=function(c){var h;return(h=t(this,u))[c]||(h[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){rt(this,v,null);lt(this,v,c),this.onContinue=null}get promise(){return t(this,v).capability.promise}cancel(c=0){t(this,v).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=t(this,v).operatorList;if(!c)return!1;const{annotationCanvasMap:h}=t(this,v);return c.form||c.canvas&&(h==null?void 0:h.size)>0}}v=new WeakMap,exports.RenderTask=RenderTask;const d=class d{constructor({callback:c,params:h,objs:O,commonObjs:a,annotationCanvasMap:E,operatorList:x,pageIndex:et,canvasFactory:$,filterFactory:K,useRequestAnimationFrame:G=!1,pdfBug:at=!1,pageColors:C=null}){this.callback=c,this.params=h,this.objs=O,this.commonObjs=a,this.annotationCanvasMap=E,this.operatorListIdx=null,this.operatorList=x,this._pageIndex=et,this.canvasFactory=$,this.filterFactory=K,this._pdfBug=at,this.pageColors=C,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=G===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=h.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:h}){var et,$;if(this.cancelled)return;if(this._canvas){if(t(d,o).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(d,o).add(this._canvas)}this._pdfBug&&((et=globalThis.StepperManager)!=null&&et.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:O,viewport:a,transform:E,background:x}=this.params;this.gfx=new _canvas.CanvasGraphics(O,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:h},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:E,viewport:a,transparency:c,background:x}),this.operatorListIdx=0,this.graphicsReady=!0,($=this.graphicsReadyCallback)==null||$.call(this)}cancel(c=null,h=0){var O;this.running=!1,this.cancelled=!0,(O=this.gfx)==null||O.endDrawing(),t(d,o).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,h))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(d,o).delete(this._canvas),this.callback())))}};o=new WeakMap,rt(d,o,new WeakSet);let InternalRenderTask=d;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(U,e,W)=>{var w,m,B,bn,_;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=W(1),f=W(4),z=W(8);const H=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=H;class ut{constructor(){rt(this,B);rt(this,w,!1);rt(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(T,g){const u=t(this,m).get(T);return u===void 0?g:Object.assign(g,u)}getRawValue(T){return t(this,m).get(T)}remove(T){if(t(this,m).delete(T),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of t(this,m).values())if(g instanceof f.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(T,g){const u=t(this,m).get(T);let y=!1;if(u!==void 0)for(const[D,v]of Object.entries(g))u[D]!==v&&(y=!0,u[D]=v);else y=!0,t(this,m).set(T,g);y&&Y(this,B,bn).call(this),g instanceof f.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(T){return t(this,m).has(T)}getAll(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}setAll(T){for(const[g,u]of Object.entries(T))this.setValue(g,u)}get size(){return t(this,m).size}resetModified(){t(this,w)&&(lt(this,w,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,m).size===0)return H;const T=new Map,g=new z.MurmurHash3_64,u=[],y=Object.create(null);let D=!1;for(const[v,o]of t(this,m)){const d=o instanceof f.AnnotationEditor?o.serialize(!1,y):o;d&&(T.set(v,d),g.update(`${v}:${JSON.stringify(d)}`),D||(D=!!d.bitmap))}if(D)for(const v of T.values())v.bitmap&&u.push(v.bitmap);return T.size>0?{map:T,hash:g.hexdigest(),transfers:u}:H}}w=new WeakMap,m=new WeakMap,B=new WeakSet,bn=function(){t(this,w)||(lt(this,w,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=ut;class k extends ut{constructor(g){super();rt(this,_);const{map:u,hash:y,transfers:D}=g.serializable,v=structuredClone(u,D?{transfer:D}:null);lt(this,_,{map:v,hash:y,transfers:D})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,_)}}_=new WeakMap,e.PrintAnnotationStorage=k},(U,e,W)=>{var k,w,m,B,I,_,b,T,g,u,y,D,v,o,d,Oe,Ie,h,Ne,Be,_n,yn,An,Ue,vn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=W(5),f=W(1),z=W(6);const G=class G{constructor(C){rt(this,d);rt(this,k,"");rt(this,w,!1);rt(this,m,null);rt(this,B,null);rt(this,I,null);rt(this,_,!1);rt(this,b,null);rt(this,T,this.focusin.bind(this));rt(this,g,this.focusout.bind(this));rt(this,u,!1);rt(this,y,!1);rt(this,D,!1);Jt(this,"_initialOptions",Object.create(null));Jt(this,"_uiManager",null);Jt(this,"_focusEventsAllowed",!0);Jt(this,"_l10nPromise",null);rt(this,v,!1);rt(this,o,G._zIndex++);this.constructor===G&&(0,f.unreachable)("Cannot initialize AnnotationEditor."),this.parent=C.parent,this.id=C.id,this.width=this.height=null,this.pageIndex=C.parent.pageIndex,this.name=C.name,this.div=null,this._uiManager=C.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=C.isCentered,this._structTreeParentId=null;const{rotation:V,rawDims:{pageWidth:nt,pageHeight:S,pageX:s,pageY:i}}=this.parent.viewport;this.rotation=V,this.pageRotation=(360+V-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[nt,S],this.pageTranslation=[s,i];const[p,F]=this.parentDimensions;this.x=C.x/p,this.y=C.y/F,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,f.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(C){const V=new ut({id:C.parent.getNextId(),parent:C.parent,uiManager:C._uiManager});V.annotationElementId=C.annotationElementId,V.deleted=!0,V._uiManager.addToAnnotationStorage(V)}static initialize(C,V=null){if(G._l10nPromise||(G._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(S=>[S,C.get(S)]))),V!=null&&V.strings)for(const S of V.strings)G._l10nPromise.set(S,C.get(S));if(G._borderLineWidth!==-1)return;const nt=getComputedStyle(document.documentElement);G._borderLineWidth=parseFloat(nt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(C,V){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(C){return!1}static paste(C,V){(0,f.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,v)}set _isDraggable(C){var V;lt(this,v,C),(V=this.div)==null||V.classList.toggle("draggable",C)}center(){const[C,V]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*V/(C*2),this.y+=this.width*C/(V*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*V/(C*2),this.y-=this.width*C/(V*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(C){this._uiManager.addCommands(C)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,o)}setParent(C){C!==null&&(this.pageIndex=C.pageIndex,this.pageDimensions=C.pageDimensions),this.parent=C}focusin(C){this._focusEventsAllowed&&(t(this,u)?lt(this,u,!1):this.parent.setSelected(this))}focusout(C){var nt;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const V=C.relatedTarget;V!=null&&V.closest(`#${this.id}`)||(C.preventDefault(),(nt=this.parent)!=null&&nt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(C,V,nt,S){const[s,i]=this.parentDimensions;[nt,S]=this.screenToPageTranslation(nt,S),this.x=(C+nt)/s,this.y=(V+S)/i,this.fixAndSetPosition()}translate(C,V){Y(this,d,Oe).call(this,this.parentDimensions,C,V)}translateInPage(C,V){Y(this,d,Oe).call(this,this.pageDimensions,C,V),this.div.scrollIntoView({block:"nearest"})}drag(C,V){const[nt,S]=this.parentDimensions;if(this.x+=C/nt,this.y+=V/S,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:M,y:L}=this.div.getBoundingClientRect();this.parent.findNewParent(this,M,L)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:i}=this;const[p,F]=Y(this,d,Ie).call(this);s+=p,i+=F,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*i).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[C,V]=this.pageDimensions;let{x:nt,y:S,width:s,height:i}=this;switch(s*=C,i*=V,nt*=C,S*=V,this.rotation){case 0:nt=Math.max(0,Math.min(C-s,nt)),S=Math.max(0,Math.min(V-i,S));break;case 90:nt=Math.max(0,Math.min(C-i,nt)),S=Math.min(V,Math.max(s,S));break;case 180:nt=Math.min(C,Math.max(s,nt)),S=Math.min(V,Math.max(i,S));break;case 270:nt=Math.min(C,Math.max(i,nt)),S=Math.max(0,Math.min(V-s,S));break}this.x=nt/=C,this.y=S/=V;const[p,F]=Y(this,d,Ie).call(this);nt+=p,S+=F;const{style:M}=this.div;M.left=`${(100*nt).toFixed(2)}%`,M.top=`${(100*S).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(C,V){var nt;return Y(nt=G,h,Ne).call(nt,C,V,this.parentRotation)}pageTranslationToScreen(C,V){var nt;return Y(nt=G,h,Ne).call(nt,C,V,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:C,pageDimensions:[V,nt]}=this,S=V*C,s=nt*C;return f.FeatureTest.isCSSRoundSupported?[Math.round(S),Math.round(s)]:[S,s]}setDims(C,V){var s;const[nt,S]=this.parentDimensions;this.div.style.width=`${(100*C/nt).toFixed(2)}%`,t(this,_)||(this.div.style.height=`${(100*V/S).toFixed(2)}%`),(s=t(this,m))==null||s.classList.toggle("small",C<G.SMALL_EDITOR_SIZE||V<G.SMALL_EDITOR_SIZE)}fixDims(){const{style:C}=this.div,{height:V,width:nt}=C,S=nt.endsWith("%"),s=!t(this,_)&&V.endsWith("%");if(S&&s)return;const[i,p]=this.parentDimensions;S||(C.width=`${(100*parseFloat(nt)/i).toFixed(2)}%`),!t(this,_)&&!s&&(C.height=`${(100*parseFloat(V)/p).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,m))return;const C=lt(this,m,document.createElement("button"));C.className="altText";const V=await G._l10nPromise.get("editor_alt_text_button_label");C.textContent=V,C.setAttribute("aria-label",V),C.tabIndex="0",C.addEventListener("contextmenu",z.noContextMenu),C.addEventListener("pointerdown",nt=>nt.stopPropagation()),C.addEventListener("click",nt=>{nt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),C.addEventListener("keydown",nt=>{nt.target===C&&nt.key==="Enter"&&(nt.preventDefault(),this._uiManager.editAltText(this))}),Y(this,d,Ue).call(this),this.div.append(C),G.SMALL_EDITOR_SIZE||(G.SMALL_EDITOR_SIZE=Math.min(128,Math.round(C.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,k),decorative:t(this,w)}}set altTextData({altText:C,decorative:V}){t(this,k)===C&&t(this,w)===V||(lt(this,k,C),lt(this,w,V),Y(this,d,Ue).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,T)),this.div.addEventListener("focusout",t(this,g));const[C,V]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*V/C).toFixed(2)}%`,this.div.style.maxHeight=`${(100*C/V).toFixed(2)}%`);const[nt,S]=this.getInitialTranslation();return this.translate(nt,S),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(C){const{isMac:V}=f.FeatureTest.platform;if(C.button!==0||C.ctrlKey&&V){C.preventDefault();return}lt(this,u,!0),Y(this,d,vn).call(this,C)}moveInDOM(){var C;(C=this.parent)==null||C.moveEditorInDOM(this)}_setParentAndPosition(C,V,nt){C.changeParent(this),this.x=V,this.y=nt,this.fixAndSetPosition()}getRect(C,V){const nt=this.parentScale,[S,s]=this.pageDimensions,[i,p]=this.pageTranslation,F=C/nt,M=V/nt,L=this.x*S,q=this.y*s,st=this.width*S,ht=this.height*s;switch(this.rotation){case 0:return[L+F+i,s-q-M-ht+p,L+F+st+i,s-q-M+p];case 90:return[L+M+i,s-q+F+p,L+M+ht+i,s-q+F+st+p];case 180:return[L-F-st+i,s-q+M+p,L-F+i,s-q+M+ht+p];case 270:return[L-M-ht+i,s-q-F-st+p,L-M+i,s-q-F+p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(C,V){const[nt,S,s,i]=C,p=s-nt,F=i-S;switch(this.rotation){case 0:return[nt,V-i,p,F];case 90:return[nt,V-S,F,p];case 180:return[s,V-S,p,F];case 270:return[s,V-i,F,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lt(this,D,!0)}disableEditMode(){lt(this,D,!1)}isInEditMode(){return t(this,D)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var C,V;(C=this.div)==null||C.addEventListener("focusin",t(this,T)),(V=this.div)==null||V.addEventListener("focusout",t(this,g))}serialize(C=!1,V=null){(0,f.unreachable)("An editor must be serializable")}static deserialize(C,V,nt){const S=new this.prototype.constructor({parent:V,id:V.getNextId(),uiManager:nt});S.rotation=C.rotation;const[s,i]=S.pageDimensions,[p,F,M,L]=S.getRectInCurrentCoords(C.rect,i);return S.x=p/s,S.y=F/i,S.width=M/s,S.height=L/i,S}remove(){var C;this.div.removeEventListener("focusin",t(this,T)),this.div.removeEventListener("focusout",t(this,g)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(C=t(this,m))==null||C.remove(),lt(this,m,null),lt(this,B,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,d,_n).call(this),t(this,b).classList.remove("hidden"))}select(){var C;this.makeResizable(),(C=this.div)==null||C.classList.add("selectedEditor")}unselect(){var C,V,nt;(C=t(this,b))==null||C.classList.add("hidden"),(V=this.div)==null||V.classList.remove("selectedEditor"),(nt=this.div)!=null&&nt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(C,V){}disableEditing(){t(this,m)&&(t(this,m).hidden=!0)}enableEditing(){t(this,m)&&(t(this,m).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,y)}set isEditing(C){lt(this,y,C),this.parent&&(C?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(C,V){lt(this,_,!0);const nt=C/V,{style:S}=this.div;S.aspectRatio=nt,S.height="auto"}static get MIN_SIZE(){return 16}};k=new WeakMap,w=new WeakMap,m=new WeakMap,B=new WeakMap,I=new WeakMap,_=new WeakMap,b=new WeakMap,T=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,D=new WeakMap,v=new WeakMap,o=new WeakMap,d=new WeakSet,Oe=function([C,V],nt,S){[nt,S]=this.screenToPageTranslation(nt,S),this.x+=nt/C,this.y+=S/V,this.fixAndSetPosition()},Ie=function(){const[C,V]=this.parentDimensions,{_borderLineWidth:nt}=G,S=nt/C,s=nt/V;switch(this.rotation){case 90:return[-S,s];case 180:return[S,s];case 270:return[S,-s];default:return[-S,-s]}},h=new WeakSet,Ne=function(C,V,nt){switch(nt){case 90:return[V,-C];case 180:return[-C,-V];case 270:return[-V,C];default:return[C,V]}},Be=function(C){switch(C){case 90:{const[V,nt]=this.pageDimensions;return[0,-V/nt,nt/V,0]}case 180:return[-1,0,0,-1];case 270:{const[V,nt]=this.pageDimensions;return[0,V/nt,-nt/V,0]}default:return[1,0,0,1]}},_n=function(){if(t(this,b))return;lt(this,b,document.createElement("div")),t(this,b).classList.add("resizers");const C=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||C.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const V of C){const nt=document.createElement("div");t(this,b).append(nt),nt.classList.add("resizer",V),nt.addEventListener("pointerdown",Y(this,d,yn).bind(this,V)),nt.addEventListener("contextmenu",z.noContextMenu)}this.div.prepend(t(this,b))},yn=function(C,V){V.preventDefault();const{isMac:nt}=f.FeatureTest.platform;if(V.button!==0||V.ctrlKey&&nt)return;const S=Y(this,d,An).bind(this,C),s=this._isDraggable;this._isDraggable=!1;const i={passive:!0,capture:!0};window.addEventListener("pointermove",S,i);const p=this.x,F=this.y,M=this.width,L=this.height,q=this.parent.div.style.cursor,st=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(V.target).cursor;const ht=()=>{this._isDraggable=s,window.removeEventListener("pointerup",ht),window.removeEventListener("blur",ht),window.removeEventListener("pointermove",S,i),this.parent.div.style.cursor=q,this.div.style.cursor=st;const gt=this.x,yt=this.y,ft=this.width,bt=this.height;gt===p&&yt===F&&ft===M&&bt===L||this.addCommands({cmd:()=>{this.width=ft,this.height=bt,this.x=gt,this.y=yt;const[Z,tt]=this.parentDimensions;this.setDims(Z*ft,tt*bt),this.fixAndSetPosition()},undo:()=>{this.width=M,this.height=L,this.x=p,this.y=F;const[Z,tt]=this.parentDimensions;this.setDims(Z*M,tt*L),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ht),window.addEventListener("blur",ht)},An=function(C,V){const[nt,S]=this.parentDimensions,s=this.x,i=this.y,p=this.width,F=this.height,M=G.MIN_SIZE/nt,L=G.MIN_SIZE/S,q=Ft=>Math.round(Ft*1e4)/1e4,st=Y(this,d,Be).call(this,this.rotation),ht=(Ft,It)=>[st[0]*Ft+st[2]*It,st[1]*Ft+st[3]*It],gt=Y(this,d,Be).call(this,360-this.rotation),yt=(Ft,It)=>[gt[0]*Ft+gt[2]*It,gt[1]*Ft+gt[3]*It];let ft,bt,Z=!1,tt=!1;switch(C){case"topLeft":Z=!0,ft=(Ft,It)=>[0,0],bt=(Ft,It)=>[Ft,It];break;case"topMiddle":ft=(Ft,It)=>[Ft/2,0],bt=(Ft,It)=>[Ft/2,It];break;case"topRight":Z=!0,ft=(Ft,It)=>[Ft,0],bt=(Ft,It)=>[0,It];break;case"middleRight":tt=!0,ft=(Ft,It)=>[Ft,It/2],bt=(Ft,It)=>[0,It/2];break;case"bottomRight":Z=!0,ft=(Ft,It)=>[Ft,It],bt=(Ft,It)=>[0,0];break;case"bottomMiddle":ft=(Ft,It)=>[Ft/2,It],bt=(Ft,It)=>[Ft/2,0];break;case"bottomLeft":Z=!0,ft=(Ft,It)=>[0,It],bt=(Ft,It)=>[Ft,0];break;case"middleLeft":tt=!0,ft=(Ft,It)=>[0,It/2],bt=(Ft,It)=>[Ft,It/2];break}const A=ft(p,F),N=bt(p,F);let J=ht(...N);const it=q(s+J[0]),mt=q(i+J[1]);let St=1,vt=1,[Q,wt]=this.screenToPageTranslation(V.movementX,V.movementY);if([Q,wt]=yt(Q/nt,wt/S),Z){const Ft=Math.hypot(p,F);St=vt=Math.max(Math.min(Math.hypot(N[0]-A[0]-Q,N[1]-A[1]-wt)/Ft,1/p,1/F),M/p,L/F)}else tt?St=Math.max(M,Math.min(1,Math.abs(N[0]-A[0]-Q)))/p:vt=Math.max(L,Math.min(1,Math.abs(N[1]-A[1]-wt)))/F;const Pt=q(p*St),Wt=q(F*vt);J=ht(...bt(Pt,Wt));const Ut=it-J[0],zt=mt-J[1];this.width=Pt,this.height=Wt,this.x=Ut,this.y=zt,this.setDims(nt*Pt,S*Wt),this.fixAndSetPosition()},Ue=async function(){var nt;const C=t(this,m);if(!C)return;if(!t(this,k)&&!t(this,w)){C.classList.remove("done"),(nt=t(this,B))==null||nt.remove();return}G._l10nPromise.get("editor_alt_text_edit_button_label").then(S=>{C.setAttribute("aria-label",S)});let V=t(this,B);if(!V){lt(this,B,V=document.createElement("span")),V.className="tooltip",V.setAttribute("role","tooltip");const S=V.id=`alt-text-tooltip-${this.id}`;C.setAttribute("aria-describedby",S);const s=100;C.addEventListener("mouseenter",()=>{lt(this,I,setTimeout(()=>{lt(this,I,null),t(this,B).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},s))}),C.addEventListener("mouseleave",()=>{var i;clearTimeout(t(this,I)),lt(this,I,null),(i=t(this,B))==null||i.classList.remove("show")})}C.classList.add("done"),V.innerText=t(this,w)?await G._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,k),V.parentNode||C.append(V)},vn=function(C){if(!this._isDraggable)return;const V=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let nt,S;V&&(nt={passive:!0,capture:!0},S=i=>{const[p,F]=this.screenToPageTranslation(i.movementX,i.movementY);this._uiManager.dragSelectedEditors(p,F)},window.addEventListener("pointermove",S,nt));const s=()=>{if(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),V&&window.removeEventListener("pointermove",S,nt),lt(this,u,!1),!this._uiManager.endDragSession()){const{isMac:i}=f.FeatureTest.platform;C.ctrlKey&&!i||C.shiftKey||C.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},rt(G,h),Jt(G,"_borderLineWidth",-1),Jt(G,"_colorManager",new n.ColorManager),Jt(G,"_zIndex",1),Jt(G,"SMALL_EDITOR_SIZE",0);let H=G;e.AnnotationEditor=H;class ut extends H{constructor(C){super(C),this.annotationElementId=C.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(U,e,W)=>{var _,b,T,g,u,je,v,o,d,l,c,En,a,E,x,et,$,K,G,at,C,V,nt,S,s,i,p,F,M,L,q,st,ht,gt,yt,ft,bt,Z,tt,A,N,J,it,mt,St,vt,Q,Sn,We,He,ve,Ge,$e,te,ue,Tn,Pn,Ve,fe,ze;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=z,e.opacityToHex=H;var n=W(1),f=W(6);function z(Vt,j,_t){for(const Ct of _t)j.addEventListener(Ct,Vt[Ct].bind(Vt))}function H(Vt){return Math.round(Math.min(255,Math.max(1,255*Vt))).toString(16).padStart(2,"0")}class ut{constructor(){rt(this,_,0)}getId(){return`${n.AnnotationEditorPrefix}${de(this,_)._++}`}}_=new WeakMap;const D=class D{constructor(){rt(this,u);rt(this,b,(0,n.getUuid)());rt(this,T,0);rt(this,g,null)}static get _isSVGFittingCanvas(){const j='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ct=new OffscreenCanvas(1,3).getContext("2d"),Lt=new Image;Lt.src=j;const Bt=Lt.decode().then(()=>(Ct.drawImage(Lt,0,0,1,1,0,0,1,3),new Uint32Array(Ct.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Bt)}async getFromFile(j){const{lastModified:_t,name:Ct,size:Lt,type:Bt}=j;return Y(this,u,je).call(this,`${_t}_${Ct}_${Lt}_${Bt}`,j)}async getFromUrl(j){return Y(this,u,je).call(this,j,j)}async getFromId(j){t(this,g)||lt(this,g,new Map);const _t=t(this,g).get(j);return _t?_t.bitmap?(_t.refCounter+=1,_t):_t.file?this.getFromFile(_t.file):this.getFromUrl(_t.url):null}getSvgUrl(j){const _t=t(this,g).get(j);return _t!=null&&_t.isSvg?_t.svgUrl:null}deleteId(j){t(this,g)||lt(this,g,new Map);const _t=t(this,g).get(j);_t&&(_t.refCounter-=1,_t.refCounter===0&&(_t.bitmap=null))}isValidId(j){return j.startsWith(`image_${t(this,b)}_`)}};b=new WeakMap,T=new WeakMap,g=new WeakMap,u=new WeakSet,je=async function(j,_t){t(this,g)||lt(this,g,new Map);let Ct=t(this,g).get(j);if(Ct===null)return null;if(Ct!=null&&Ct.bitmap)return Ct.refCounter+=1,Ct;try{Ct||(Ct={bitmap:null,id:`image_${t(this,b)}_${de(this,T)._++}`,refCounter:0,isSvg:!1});let Lt;if(typeof _t=="string"){Ct.url=_t;const Bt=await fetch(_t);if(!Bt.ok)throw new Error(Bt.statusText);Lt=await Bt.blob()}else Lt=Ct.file=_t;if(Lt.type==="image/svg+xml"){const Bt=D._isSVGFittingCanvas,Rt=new FileReader,R=new Image,P=new Promise((X,dt)=>{R.onload=()=>{Ct.bitmap=R,Ct.isSvg=!0,X()},Rt.onload=async()=>{const pt=Ct.svgUrl=Rt.result;R.src=await Bt?`${pt}#svgView(preserveAspectRatio(none))`:pt},R.onerror=Rt.onerror=dt});Rt.readAsDataURL(Lt),await P}else Ct.bitmap=await createImageBitmap(Lt);Ct.refCounter=1}catch(Lt){console.error(Lt),Ct=null}return t(this,g).set(j,Ct),Ct&&t(this,g).set(Ct.id,Ct),Ct};let k=D;class w{constructor(j=128){rt(this,v,[]);rt(this,o,!1);rt(this,d);rt(this,l,-1);lt(this,d,j)}add({cmd:j,undo:_t,mustExec:Ct,type:Lt=NaN,overwriteIfSameType:Bt=!1,keepUndo:Rt=!1}){if(Ct&&j(),t(this,o))return;const R={cmd:j,undo:_t,type:Lt};if(t(this,l)===-1){t(this,v).length>0&&(t(this,v).length=0),lt(this,l,0),t(this,v).push(R);return}if(Bt&&t(this,v)[t(this,l)].type===Lt){Rt&&(R.undo=t(this,v)[t(this,l)].undo),t(this,v)[t(this,l)]=R;return}const P=t(this,l)+1;P===t(this,d)?t(this,v).splice(0,1):(lt(this,l,P),P<t(this,v).length&&t(this,v).splice(P)),t(this,v).push(R)}undo(){t(this,l)!==-1&&(lt(this,o,!0),t(this,v)[t(this,l)].undo(),lt(this,o,!1),lt(this,l,t(this,l)-1))}redo(){t(this,l)<t(this,v).length-1&&(lt(this,l,t(this,l)+1),lt(this,o,!0),t(this,v)[t(this,l)].cmd(),lt(this,o,!1))}hasSomethingToUndo(){return t(this,l)!==-1}hasSomethingToRedo(){return t(this,l)<t(this,v).length-1}destroy(){lt(this,v,null)}}v=new WeakMap,o=new WeakMap,d=new WeakMap,l=new WeakMap,e.CommandManager=w;class m{constructor(j){rt(this,c);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:_t}=n.FeatureTest.platform;for(const[Ct,Lt,Bt={}]of j)for(const Rt of Ct){const R=Rt.startsWith("mac+");_t&&R?(this.callbacks.set(Rt.slice(4),{callback:Lt,options:Bt}),this.allKeys.add(Rt.split("+").at(-1))):!_t&&!R&&(this.callbacks.set(Rt,{callback:Lt,options:Bt}),this.allKeys.add(Rt.split("+").at(-1)))}}exec(j,_t){if(!this.allKeys.has(_t.key))return;const Ct=this.callbacks.get(Y(this,c,En).call(this,_t));if(!Ct)return;const{callback:Lt,options:{bubbles:Bt=!1,args:Rt=[],checker:R=null}}=Ct;R&&!R(j,_t)||(Lt.bind(j,...Rt)(),Bt||(_t.stopPropagation(),_t.preventDefault()))}}c=new WeakSet,En=function(j){j.altKey&&this.buffer.push("alt"),j.ctrlKey&&this.buffer.push("ctrl"),j.metaKey&&this.buffer.push("meta"),j.shiftKey&&this.buffer.push("shift"),this.buffer.push(j.key);const _t=this.buffer.join("+");return this.buffer.length=0,_t},e.KeyboardManager=m;const O=class O{get _colors(){const j=new Map([["CanvasText",null],["Canvas",null]]);return(0,f.getColorValues)(j),(0,n.shadow)(this,"_colors",j)}convert(j){const _t=(0,f.getRGB)(j);if(!window.matchMedia("(forced-colors: active)").matches)return _t;for(const[Ct,Lt]of this._colors)if(Lt.every((Bt,Rt)=>Bt===_t[Rt]))return O._colorsMapping.get(Ct);return _t}getHexCode(j){const _t=this._colors.get(j);return _t?n.Util.makeHexColor(..._t):j}};Jt(O,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let B=O;e.ColorManager=B;const Xt=class Xt{constructor(j,_t,Ct,Lt,Bt,Rt){rt(this,Q);rt(this,a,null);rt(this,E,new Map);rt(this,x,new Map);rt(this,et,null);rt(this,$,null);rt(this,K,new w);rt(this,G,0);rt(this,at,new Set);rt(this,C,null);rt(this,V,null);rt(this,nt,new Set);rt(this,S,null);rt(this,s,new ut);rt(this,i,!1);rt(this,p,!1);rt(this,F,null);rt(this,M,n.AnnotationEditorType.NONE);rt(this,L,new Set);rt(this,q,null);rt(this,st,this.blur.bind(this));rt(this,ht,this.focus.bind(this));rt(this,gt,this.copy.bind(this));rt(this,yt,this.cut.bind(this));rt(this,ft,this.paste.bind(this));rt(this,bt,this.keydown.bind(this));rt(this,Z,this.onEditingAction.bind(this));rt(this,tt,this.onPageChanging.bind(this));rt(this,A,this.onScaleChanging.bind(this));rt(this,N,this.onRotationChanging.bind(this));rt(this,J,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rt(this,it,[0,0]);rt(this,mt,null);rt(this,St,null);rt(this,vt,null);lt(this,St,j),lt(this,vt,_t),lt(this,et,Ct),this._eventBus=Lt,this._eventBus._on("editingaction",t(this,Z)),this._eventBus._on("pagechanging",t(this,tt)),this._eventBus._on("scalechanging",t(this,A)),this._eventBus._on("rotationchanging",t(this,N)),lt(this,$,Bt.annotationStorage),lt(this,S,Bt.filterFactory),lt(this,q,Rt),this.viewParameters={realScale:f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const j=Xt.prototype,_t=Bt=>{const{activeElement:Rt}=document;return Rt&&t(Bt,St).contains(Rt)&&Bt.hasSomethingToControl()},Ct=this.TRANSLATE_SMALL,Lt=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],j.selectAll],[["ctrl+z","mac+meta+z"],j.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],j.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],j.delete],[["Escape","mac+Escape"],j.unselectAll],[["ArrowLeft","mac+ArrowLeft"],j.translateSelectedEditors,{args:[-Ct,0],checker:_t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],j.translateSelectedEditors,{args:[-Lt,0],checker:_t}],[["ArrowRight","mac+ArrowRight"],j.translateSelectedEditors,{args:[Ct,0],checker:_t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],j.translateSelectedEditors,{args:[Lt,0],checker:_t}],[["ArrowUp","mac+ArrowUp"],j.translateSelectedEditors,{args:[0,-Ct],checker:_t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],j.translateSelectedEditors,{args:[0,-Lt],checker:_t}],[["ArrowDown","mac+ArrowDown"],j.translateSelectedEditors,{args:[0,Ct],checker:_t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],j.translateSelectedEditors,{args:[0,Lt],checker:_t}]]))}destroy(){Y(this,Q,ve).call(this),Y(this,Q,We).call(this),this._eventBus._off("editingaction",t(this,Z)),this._eventBus._off("pagechanging",t(this,tt)),this._eventBus._off("scalechanging",t(this,A)),this._eventBus._off("rotationchanging",t(this,N));for(const j of t(this,x).values())j.destroy();t(this,x).clear(),t(this,E).clear(),t(this,nt).clear(),lt(this,a,null),t(this,L).clear(),t(this,K).destroy(),t(this,et).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,q)?t(this,S).addHCMFilter(t(this,q).foreground,t(this,q).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,St)).direction)}editAltText(j){var _t;(_t=t(this,et))==null||_t.editAltText(this,j)}onPageChanging({pageNumber:j}){lt(this,G,j-1)}focusMainContainer(){t(this,St).focus()}findParent(j,_t){for(const Ct of t(this,x).values()){const{x:Lt,y:Bt,width:Rt,height:R}=Ct.div.getBoundingClientRect();if(j>=Lt&&j<=Lt+Rt&&_t>=Bt&&_t<=Bt+R)return Ct}return null}disableUserSelect(j=!1){t(this,vt).classList.toggle("noUserSelect",j)}addShouldRescale(j){t(this,nt).add(j)}removeShouldRescale(j){t(this,nt).delete(j)}onScaleChanging({scale:j}){this.commitOrRemove(),this.viewParameters.realScale=j*f.PixelsPerInch.PDF_TO_CSS_UNITS;for(const _t of t(this,nt))_t.onScaleChanging()}onRotationChanging({pagesRotation:j}){this.commitOrRemove(),this.viewParameters.rotation=j}addToAnnotationStorage(j){!j.isEmpty()&&t(this,$)&&!t(this,$).has(j.id)&&t(this,$).setValue(j.id,j)}blur(){if(!this.hasSelection)return;const{activeElement:j}=document;for(const _t of t(this,L))if(_t.div.contains(j)){lt(this,F,[_t,j]),_t._focusEventsAllowed=!1;break}}focus(){if(!t(this,F))return;const[j,_t]=t(this,F);lt(this,F,null),_t.addEventListener("focusin",()=>{j._focusEventsAllowed=!0},{once:!0}),_t.focus()}addEditListeners(){Y(this,Q,He).call(this),Y(this,Q,Ge).call(this)}removeEditListeners(){Y(this,Q,ve).call(this),Y(this,Q,$e).call(this)}copy(j){var Ct;if(j.preventDefault(),(Ct=t(this,a))==null||Ct.commitOrRemove(),!this.hasSelection)return;const _t=[];for(const Lt of t(this,L)){const Bt=Lt.serialize(!0);Bt&&_t.push(Bt)}_t.length!==0&&j.clipboardData.setData("application/pdfjs",JSON.stringify(_t))}cut(j){this.copy(j),this.delete()}paste(j){j.preventDefault();const{clipboardData:_t}=j;for(const Bt of _t.items)for(const Rt of t(this,V))if(Rt.isHandlingMimeForPasting(Bt.type)){Rt.paste(Bt,this.currentLayer);return}let Ct=_t.getData("application/pdfjs");if(!Ct)return;try{Ct=JSON.parse(Ct)}catch(Bt){(0,n.warn)(`paste: "${Bt.message}".`);return}if(!Array.isArray(Ct))return;this.unselectAll();const Lt=this.currentLayer;try{const Bt=[];for(const P of Ct){const X=Lt.deserialize(P);if(!X)return;Bt.push(X)}const Rt=()=>{for(const P of Bt)Y(this,Q,Ve).call(this,P);Y(this,Q,ze).call(this,Bt)},R=()=>{for(const P of Bt)P.remove()};this.addCommands({cmd:Rt,undo:R,mustExec:!0})}catch(Bt){(0,n.warn)(`paste: "${Bt.message}".`)}}keydown(j){var _t;(_t=this.getActive())!=null&&_t.shouldGetKeyboardEvents()||Xt._keyboardManager.exec(this,j)}onEditingAction(j){["undo","redo","delete","selectAll"].includes(j.name)&&this[j.name]()}setEditingState(j){j?(Y(this,Q,Sn).call(this),Y(this,Q,He).call(this),Y(this,Q,Ge).call(this),Y(this,Q,te).call(this,{isEditing:t(this,M)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,Q,fe).call(this),hasSomethingToUndo:t(this,K).hasSomethingToUndo(),hasSomethingToRedo:t(this,K).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Q,We).call(this),Y(this,Q,ve).call(this),Y(this,Q,$e).call(this),Y(this,Q,te).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(j){if(!t(this,V)){lt(this,V,j);for(const _t of t(this,V))Y(this,Q,ue).call(this,_t.defaultPropertiesToUpdate)}}getId(){return t(this,s).getId()}get currentLayer(){return t(this,x).get(t(this,G))}getLayer(j){return t(this,x).get(j)}get currentPageIndex(){return t(this,G)}addLayer(j){t(this,x).set(j.pageIndex,j),t(this,i)?j.enable():j.disable()}removeLayer(j){t(this,x).delete(j.pageIndex)}updateMode(j,_t=null){if(t(this,M)!==j){if(lt(this,M,j),j===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,Q,Pn).call(this);return}this.setEditingState(!0),Y(this,Q,Tn).call(this),this.unselectAll();for(const Ct of t(this,x).values())Ct.updateMode(j);if(_t){for(const Ct of t(this,E).values())if(Ct.annotationElementId===_t){this.setSelected(Ct),Ct.enterInEditMode();break}}}}updateToolbar(j){j!==t(this,M)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:j})}updateParams(j,_t){if(t(this,V)){if(j===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(j);return}for(const Ct of t(this,L))Ct.updateParams(j,_t);for(const Ct of t(this,V))Ct.updateDefaultParams(j,_t)}}enableWaiting(j=!1){if(t(this,p)!==j){lt(this,p,j);for(const _t of t(this,x).values())j?_t.disableClick():_t.enableClick(),_t.div.classList.toggle("waiting",j)}}getEditors(j){const _t=[];for(const Ct of t(this,E).values())Ct.pageIndex===j&&_t.push(Ct);return _t}getEditor(j){return t(this,E).get(j)}addEditor(j){t(this,E).set(j.id,j)}removeEditor(j){var _t;t(this,E).delete(j.id),this.unselect(j),(!j.annotationElementId||!t(this,at).has(j.annotationElementId))&&((_t=t(this,$))==null||_t.remove(j.id))}addDeletedAnnotationElement(j){t(this,at).add(j.annotationElementId),j.deleted=!0}isDeletedAnnotationElement(j){return t(this,at).has(j)}removeDeletedAnnotationElement(j){t(this,at).delete(j.annotationElementId),j.deleted=!1}setActiveEditor(j){t(this,a)!==j&&(lt(this,a,j),j&&Y(this,Q,ue).call(this,j.propertiesToUpdate))}toggleSelected(j){if(t(this,L).has(j)){t(this,L).delete(j),j.unselect(),Y(this,Q,te).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,L).add(j),j.select(),Y(this,Q,ue).call(this,j.propertiesToUpdate),Y(this,Q,te).call(this,{hasSelectedEditor:!0})}setSelected(j){for(const _t of t(this,L))_t!==j&&_t.unselect();t(this,L).clear(),t(this,L).add(j),j.select(),Y(this,Q,ue).call(this,j.propertiesToUpdate),Y(this,Q,te).call(this,{hasSelectedEditor:!0})}isSelected(j){return t(this,L).has(j)}unselect(j){j.unselect(),t(this,L).delete(j),Y(this,Q,te).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,L).size!==0}undo(){t(this,K).undo(),Y(this,Q,te).call(this,{hasSomethingToUndo:t(this,K).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Q,fe).call(this)})}redo(){t(this,K).redo(),Y(this,Q,te).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,K).hasSomethingToRedo(),isEmpty:Y(this,Q,fe).call(this)})}addCommands(j){t(this,K).add(j),Y(this,Q,te).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Q,fe).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const j=[...t(this,L)],_t=()=>{for(const Lt of j)Lt.remove()},Ct=()=>{for(const Lt of j)Y(this,Q,Ve).call(this,Lt)};this.addCommands({cmd:_t,undo:Ct,mustExec:!0})}commitOrRemove(){var j;(j=t(this,a))==null||j.commitOrRemove()}hasSomethingToControl(){return t(this,a)||this.hasSelection}selectAll(){for(const j of t(this,L))j.commit();Y(this,Q,ze).call(this,t(this,E).values())}unselectAll(){if(t(this,a)){t(this,a).commitOrRemove();return}if(this.hasSelection){for(const j of t(this,L))j.unselect();t(this,L).clear(),Y(this,Q,te).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(j,_t,Ct=!1){if(Ct||this.commitOrRemove(),!this.hasSelection)return;t(this,it)[0]+=j,t(this,it)[1]+=_t;const[Lt,Bt]=t(this,it),Rt=[...t(this,L)],R=1e3;t(this,mt)&&clearTimeout(t(this,mt)),lt(this,mt,setTimeout(()=>{lt(this,mt,null),t(this,it)[0]=t(this,it)[1]=0,this.addCommands({cmd:()=>{for(const P of Rt)t(this,E).has(P.id)&&P.translateInPage(Lt,Bt)},undo:()=>{for(const P of Rt)t(this,E).has(P.id)&&P.translateInPage(-Lt,-Bt)},mustExec:!1})},R));for(const P of Rt)P.translateInPage(j,_t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),lt(this,C,new Map);for(const j of t(this,L))t(this,C).set(j,{savedX:j.x,savedY:j.y,savedPageIndex:j.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,C))return!1;this.disableUserSelect(!1);const j=t(this,C);lt(this,C,null);let _t=!1;for(const[{x:Lt,y:Bt,pageIndex:Rt},R]of j)R.newX=Lt,R.newY=Bt,R.newPageIndex=Rt,_t||(_t=Lt!==R.savedX||Bt!==R.savedY||Rt!==R.savedPageIndex);if(!_t)return!1;const Ct=(Lt,Bt,Rt,R)=>{if(t(this,E).has(Lt.id)){const P=t(this,x).get(R);P?Lt._setParentAndPosition(P,Bt,Rt):(Lt.pageIndex=R,Lt.x=Bt,Lt.y=Rt)}};return this.addCommands({cmd:()=>{for(const[Lt,{newX:Bt,newY:Rt,newPageIndex:R}]of j)Ct(Lt,Bt,Rt,R)},undo:()=>{for(const[Lt,{savedX:Bt,savedY:Rt,savedPageIndex:R}]of j)Ct(Lt,Bt,Rt,R)},mustExec:!0}),!0}dragSelectedEditors(j,_t){if(t(this,C))for(const Ct of t(this,C).keys())Ct.drag(j,_t)}rebuild(j){if(j.parent===null){const _t=this.getLayer(j.pageIndex);_t?(_t.changeParent(j),_t.addOrRebuild(j)):(this.addEditor(j),this.addToAnnotationStorage(j),j.rebuild())}else j.parent.addOrRebuild(j)}isActive(j){return t(this,a)===j}getActive(){return t(this,a)}getMode(){return t(this,M)}get imageManager(){return(0,n.shadow)(this,"imageManager",new k)}};a=new WeakMap,E=new WeakMap,x=new WeakMap,et=new WeakMap,$=new WeakMap,K=new WeakMap,G=new WeakMap,at=new WeakMap,C=new WeakMap,V=new WeakMap,nt=new WeakMap,S=new WeakMap,s=new WeakMap,i=new WeakMap,p=new WeakMap,F=new WeakMap,M=new WeakMap,L=new WeakMap,q=new WeakMap,st=new WeakMap,ht=new WeakMap,gt=new WeakMap,yt=new WeakMap,ft=new WeakMap,bt=new WeakMap,Z=new WeakMap,tt=new WeakMap,A=new WeakMap,N=new WeakMap,J=new WeakMap,it=new WeakMap,mt=new WeakMap,St=new WeakMap,vt=new WeakMap,Q=new WeakSet,Sn=function(){window.addEventListener("focus",t(this,ht)),window.addEventListener("blur",t(this,st))},We=function(){window.removeEventListener("focus",t(this,ht)),window.removeEventListener("blur",t(this,st))},He=function(){window.addEventListener("keydown",t(this,bt),{capture:!0})},ve=function(){window.removeEventListener("keydown",t(this,bt),{capture:!0})},Ge=function(){document.addEventListener("copy",t(this,gt)),document.addEventListener("cut",t(this,yt)),document.addEventListener("paste",t(this,ft))},$e=function(){document.removeEventListener("copy",t(this,gt)),document.removeEventListener("cut",t(this,yt)),document.removeEventListener("paste",t(this,ft))},te=function(j){Object.entries(j).some(([Ct,Lt])=>t(this,J)[Ct]!==Lt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,J),j)})},ue=function(j){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:j})},Tn=function(){if(!t(this,i)){lt(this,i,!0);for(const j of t(this,x).values())j.enable()}},Pn=function(){if(this.unselectAll(),t(this,i)){lt(this,i,!1);for(const j of t(this,x).values())j.disable()}},Ve=function(j){const _t=t(this,x).get(j.pageIndex);_t?_t.addOrRebuild(j):this.addEditor(j)},fe=function(){if(t(this,E).size===0)return!0;if(t(this,E).size===1)for(const j of t(this,E).values())return j.isEmpty();return!1},ze=function(j){t(this,L).clear();for(const _t of j)_t.isEmpty()||(t(this,L).add(_t),_t.select());Y(this,Q,te).call(this,{hasSelectedEditor:!0})},Jt(Xt,"TRANSLATE_SMALL",1),Jt(Xt,"TRANSLATE_BIG",10);let I=Xt;e.AnnotationEditorUIManager=I},(U,e,W)=>{var G,at,C,V,nt,S,s,i,p,F,M,L,oe,le,Xe,Ee,Se,pe,ge;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=l,e.getColorValues=E,e.getCurrentTransform=x,e.getCurrentTransformInverse=et,e.getFilenameFromUrl=u,e.getPdfFilenameFromUrl=y,e.getRGB=a,e.getXfaPageViewport=O,e.isDataScheme=T,e.isPdfFile=g,e.isValidFetchUrl=v,e.loadScript=d,e.noContextMenu=o,e.setLayerDimensions=$;var n=W(7),f=W(1);const z="http://www.w3.org/2000/svg",K=class K{};Jt(K,"CSS",96),Jt(K,"PDF",72),Jt(K,"PDF_TO_CSS_UNITS",K.CSS/K.PDF);let H=K;e.PixelsPerInch=H;class ut extends n.BaseFilterFactory{constructor({docId:A,ownerDocument:N=globalThis.document}={}){super();rt(this,L);rt(this,G);rt(this,at);rt(this,C);rt(this,V);rt(this,nt);rt(this,S);rt(this,s);rt(this,i);rt(this,p);rt(this,F);rt(this,M,0);lt(this,C,A),lt(this,V,N)}addFilter(A){if(!A)return"none";let N=t(this,L,oe).get(A);if(N)return N;let J,it,mt,St;if(A.length===1){const Pt=A[0],Wt=new Array(256);for(let Ut=0;Ut<256;Ut++)Wt[Ut]=Pt[Ut]/255;St=J=it=mt=Wt.join(",")}else{const[Pt,Wt,Ut]=A,zt=new Array(256),Ft=new Array(256),It=new Array(256);for(let Gt=0;Gt<256;Gt++)zt[Gt]=Pt[Gt]/255,Ft[Gt]=Wt[Gt]/255,It[Gt]=Ut[Gt]/255;J=zt.join(","),it=Ft.join(","),mt=It.join(","),St=`${J}${it}${mt}`}if(N=t(this,L,oe).get(St),N)return t(this,L,oe).set(A,N),N;const vt=`g_${t(this,C)}_transfer_map_${de(this,M)._++}`,Q=`url(#${vt})`;t(this,L,oe).set(A,Q),t(this,L,oe).set(St,Q);const wt=Y(this,L,Ee).call(this,vt);return Y(this,L,pe).call(this,J,it,mt,wt),Q}addHCMFilter(A,N){var Wt;const J=`${A}-${N}`;if(t(this,S)===J)return t(this,s);if(lt(this,S,J),lt(this,s,"none"),(Wt=t(this,nt))==null||Wt.remove(),!A||!N)return t(this,s);const it=Y(this,L,ge).call(this,A);A=f.Util.makeHexColor(...it);const mt=Y(this,L,ge).call(this,N);if(N=f.Util.makeHexColor(...mt),t(this,L,le).style.color="",A==="#000000"&&N==="#ffffff"||A===N)return t(this,s);const St=new Array(256);for(let Ut=0;Ut<=255;Ut++){const zt=Ut/255;St[Ut]=zt<=.03928?zt/12.92:((zt+.055)/1.055)**2.4}const vt=St.join(","),Q=`g_${t(this,C)}_hcm_filter`,wt=lt(this,i,Y(this,L,Ee).call(this,Q));Y(this,L,pe).call(this,vt,vt,vt,wt),Y(this,L,Xe).call(this,wt);const Pt=(Ut,zt)=>{const Ft=it[Ut]/255,It=mt[Ut]/255,Gt=new Array(zt+1);for(let qt=0;qt<=zt;qt++)Gt[qt]=Ft+qt/zt*(It-Ft);return Gt.join(",")};return Y(this,L,pe).call(this,Pt(0,5),Pt(1,5),Pt(2,5),wt),lt(this,s,`url(#${Q})`),t(this,s)}addHighlightHCMFilter(A,N,J,it){var It;const mt=`${A}-${N}-${J}-${it}`;if(t(this,p)===mt)return t(this,F);if(lt(this,p,mt),lt(this,F,"none"),(It=t(this,i))==null||It.remove(),!A||!N)return t(this,F);const[St,vt]=[A,N].map(Y(this,L,ge).bind(this));let Q=Math.round(.2126*St[0]+.7152*St[1]+.0722*St[2]),wt=Math.round(.2126*vt[0]+.7152*vt[1]+.0722*vt[2]),[Pt,Wt]=[J,it].map(Y(this,L,ge).bind(this));wt<Q&&([Q,wt,Pt,Wt]=[wt,Q,Wt,Pt]),t(this,L,le).style.color="";const Ut=(Gt,qt,Et)=>{const ot=new Array(256),ct=(wt-Q)/Et,kt=Gt/255,Xt=(qt-Gt)/(255*Et);let Vt=0;for(let j=0;j<=Et;j++){const _t=Math.round(Q+j*ct),Ct=kt+j*Xt;for(let Lt=Vt;Lt<=_t;Lt++)ot[Lt]=Ct;Vt=_t+1}for(let j=Vt;j<256;j++)ot[j]=ot[Vt-1];return ot.join(",")},zt=`g_${t(this,C)}_hcm_highlight_filter`,Ft=lt(this,i,Y(this,L,Ee).call(this,zt));return Y(this,L,Xe).call(this,Ft),Y(this,L,pe).call(this,Ut(Pt[0],Wt[0],5),Ut(Pt[1],Wt[1],5),Ut(Pt[2],Wt[2],5),Ft),lt(this,F,`url(#${zt})`),t(this,F)}destroy(A=!1){A&&(t(this,s)||t(this,F))||(t(this,at)&&(t(this,at).parentNode.parentNode.remove(),lt(this,at,null)),t(this,G)&&(t(this,G).clear(),lt(this,G,null)),lt(this,M,0))}}G=new WeakMap,at=new WeakMap,C=new WeakMap,V=new WeakMap,nt=new WeakMap,S=new WeakMap,s=new WeakMap,i=new WeakMap,p=new WeakMap,F=new WeakMap,M=new WeakMap,L=new WeakSet,oe=function(){return t(this,G)||lt(this,G,new Map)},le=function(){if(!t(this,at)){const A=t(this,V).createElement("div"),{style:N}=A;N.visibility="hidden",N.contain="strict",N.width=N.height=0,N.position="absolute",N.top=N.left=0,N.zIndex=-1;const J=t(this,V).createElementNS(z,"svg");J.setAttribute("width",0),J.setAttribute("height",0),lt(this,at,t(this,V).createElementNS(z,"defs")),A.append(J),J.append(t(this,at)),t(this,V).body.append(A)}return t(this,at)},Xe=function(A){const N=t(this,V).createElementNS(z,"feColorMatrix");N.setAttribute("type","matrix"),N.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),A.append(N)},Ee=function(A){const N=t(this,V).createElementNS(z,"filter");return N.setAttribute("color-interpolation-filters","sRGB"),N.setAttribute("id",A),t(this,L,le).append(N),N},Se=function(A,N,J){const it=t(this,V).createElementNS(z,N);it.setAttribute("type","discrete"),it.setAttribute("tableValues",J),A.append(it)},pe=function(A,N,J,it){const mt=t(this,V).createElementNS(z,"feComponentTransfer");it.append(mt),Y(this,L,Se).call(this,mt,"feFuncR",A),Y(this,L,Se).call(this,mt,"feFuncG",N),Y(this,L,Se).call(this,mt,"feFuncB",J)},ge=function(A){return t(this,L,le).style.color=A,a(getComputedStyle(t(this,L,le)).getPropertyValue("color"))},e.DOMFilterFactory=ut;class k extends n.BaseCanvasFactory{constructor({ownerDocument:tt=globalThis.document}={}){super(),this._document=tt}_createCanvas(tt,A){const N=this._document.createElement("canvas");return N.width=tt,N.height=A,N}}e.DOMCanvasFactory=k;async function w(Z,tt=!1){if(v(Z,document.baseURI)){const A=await fetch(Z);if(!A.ok)throw new Error(A.statusText);return tt?new Uint8Array(await A.arrayBuffer()):(0,f.stringToBytes)(await A.text())}return new Promise((A,N)=>{const J=new XMLHttpRequest;J.open("GET",Z,!0),tt&&(J.responseType="arraybuffer"),J.onreadystatechange=()=>{if(J.readyState===XMLHttpRequest.DONE){if(J.status===200||J.status===0){let it;if(tt&&J.response?it=new Uint8Array(J.response):!tt&&J.responseText&&(it=(0,f.stringToBytes)(J.responseText)),it){A(it);return}}N(new Error(J.statusText))}},J.send(null)})}class m extends n.BaseCMapReaderFactory{_fetchData(tt,A){return w(tt,this.isCompressed).then(N=>({cMapData:N,compressionType:A}))}}e.DOMCMapReaderFactory=m;class B extends n.BaseStandardFontDataFactory{_fetchData(tt){return w(tt,!0)}}e.DOMStandardFontDataFactory=B;class I extends n.BaseSVGFactory{_createSVG(tt){return document.createElementNS(z,tt)}}e.DOMSVGFactory=I;class _{constructor({viewBox:tt,scale:A,rotation:N,offsetX:J=0,offsetY:it=0,dontFlip:mt=!1}){this.viewBox=tt,this.scale=A,this.rotation=N,this.offsetX=J,this.offsetY=it;const St=(tt[2]+tt[0])/2,vt=(tt[3]+tt[1])/2;let Q,wt,Pt,Wt;switch(N%=360,N<0&&(N+=360),N){case 180:Q=-1,wt=0,Pt=0,Wt=1;break;case 90:Q=0,wt=1,Pt=1,Wt=0;break;case 270:Q=0,wt=-1,Pt=-1,Wt=0;break;case 0:Q=1,wt=0,Pt=0,Wt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}mt&&(Pt=-Pt,Wt=-Wt);let Ut,zt,Ft,It;Q===0?(Ut=Math.abs(vt-tt[1])*A+J,zt=Math.abs(St-tt[0])*A+it,Ft=(tt[3]-tt[1])*A,It=(tt[2]-tt[0])*A):(Ut=Math.abs(St-tt[0])*A+J,zt=Math.abs(vt-tt[1])*A+it,Ft=(tt[2]-tt[0])*A,It=(tt[3]-tt[1])*A),this.transform=[Q*A,wt*A,Pt*A,Wt*A,Ut-Q*A*St-Pt*A*vt,zt-wt*A*St-Wt*A*vt],this.width=Ft,this.height=It}get rawDims(){const{viewBox:tt}=this;return(0,f.shadow)(this,"rawDims",{pageWidth:tt[2]-tt[0],pageHeight:tt[3]-tt[1],pageX:tt[0],pageY:tt[1]})}clone({scale:tt=this.scale,rotation:A=this.rotation,offsetX:N=this.offsetX,offsetY:J=this.offsetY,dontFlip:it=!1}={}){return new _({viewBox:this.viewBox.slice(),scale:tt,rotation:A,offsetX:N,offsetY:J,dontFlip:it})}convertToViewportPoint(tt,A){return f.Util.applyTransform([tt,A],this.transform)}convertToViewportRectangle(tt){const A=f.Util.applyTransform([tt[0],tt[1]],this.transform),N=f.Util.applyTransform([tt[2],tt[3]],this.transform);return[A[0],A[1],N[0],N[1]]}convertToPdfPoint(tt,A){return f.Util.applyInverseTransform([tt,A],this.transform)}}e.PageViewport=_;class b extends f.BaseException{constructor(tt,A=0){super(tt,"RenderingCancelledException"),this.extraDelay=A}}e.RenderingCancelledException=b;function T(Z){const tt=Z.length;let A=0;for(;A<tt&&Z[A].trim()==="";)A++;return Z.substring(A,A+5).toLowerCase()==="data:"}function g(Z){return typeof Z=="string"&&/\.pdf$/i.test(Z)}function u(Z,tt=!1){return tt||([Z]=Z.split(/[#?]/,1)),Z.substring(Z.lastIndexOf("/")+1)}function y(Z,tt="document.pdf"){if(typeof Z!="string")return tt;if(T(Z))return(0,f.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),tt;const A=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,N=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,J=A.exec(Z);let it=N.exec(J[1])||N.exec(J[2])||N.exec(J[3]);if(it&&(it=it[0],it.includes("%")))try{it=N.exec(decodeURIComponent(it))[0]}catch{}return it||tt}class D{constructor(){Jt(this,"started",Object.create(null));Jt(this,"times",[])}time(tt){tt in this.started&&(0,f.warn)(`Timer is already running for ${tt}`),this.started[tt]=Date.now()}timeEnd(tt){tt in this.started||(0,f.warn)(`Timer has not been started for ${tt}`),this.times.push({name:tt,start:this.started[tt],end:Date.now()}),delete this.started[tt]}toString(){const tt=[];let A=0;for(const{name:N}of this.times)A=Math.max(N.length,A);for(const{name:N,start:J,end:it}of this.times)tt.push(`${N.padEnd(A)} ${it-J}ms
`);return tt.join("")}}e.StatTimer=D;function v(Z,tt){try{const{protocol:A}=tt?new URL(Z,tt):new URL(Z);return A==="http:"||A==="https:"}catch{return!1}}function o(Z){Z.preventDefault()}function d(Z,tt=!1){return new Promise((A,N)=>{const J=document.createElement("script");J.src=Z,J.onload=function(it){tt&&J.remove(),A(it)},J.onerror=function(){N(new Error(`Cannot load script at: ${J.src}`))},(document.head||document.documentElement).append(J)})}function l(Z){console.log("Deprecated API usage: "+Z)}let c;class h{static toDateObject(tt){if(!tt||typeof tt!="string")return null;c||(c=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const A=c.exec(tt);if(!A)return null;const N=parseInt(A[1],10);let J=parseInt(A[2],10);J=J>=1&&J<=12?J-1:0;let it=parseInt(A[3],10);it=it>=1&&it<=31?it:1;let mt=parseInt(A[4],10);mt=mt>=0&&mt<=23?mt:0;let St=parseInt(A[5],10);St=St>=0&&St<=59?St:0;let vt=parseInt(A[6],10);vt=vt>=0&&vt<=59?vt:0;const Q=A[7]||"Z";let wt=parseInt(A[8],10);wt=wt>=0&&wt<=23?wt:0;let Pt=parseInt(A[9],10)||0;return Pt=Pt>=0&&Pt<=59?Pt:0,Q==="-"?(mt+=wt,St+=Pt):Q==="+"&&(mt-=wt,St-=Pt),new Date(Date.UTC(N,J,it,mt,St,vt))}}e.PDFDateString=h;function O(Z,{scale:tt=1,rotation:A=0}){const{width:N,height:J}=Z.attributes.style,it=[0,0,parseInt(N),parseInt(J)];return new _({viewBox:it,scale:tt,rotation:A})}function a(Z){if(Z.startsWith("#")){const tt=parseInt(Z.slice(1),16);return[(tt&16711680)>>16,(tt&65280)>>8,tt&255]}return Z.startsWith("rgb(")?Z.slice(4,-1).split(",").map(tt=>parseInt(tt)):Z.startsWith("rgba(")?Z.slice(5,-1).split(",").map(tt=>parseInt(tt)).slice(0,3):((0,f.warn)(`Not a valid color format: "${Z}"`),[0,0,0])}function E(Z){const tt=document.createElement("span");tt.style.visibility="hidden",document.body.append(tt);for(const A of Z.keys()){tt.style.color=A;const N=window.getComputedStyle(tt).color;Z.set(A,a(N))}tt.remove()}function x(Z){const{a:tt,b:A,c:N,d:J,e:it,f:mt}=Z.getTransform();return[tt,A,N,J,it,mt]}function et(Z){const{a:tt,b:A,c:N,d:J,e:it,f:mt}=Z.getTransform().invertSelf();return[tt,A,N,J,it,mt]}function $(Z,tt,A=!1,N=!0){if(tt instanceof _){const{pageWidth:J,pageHeight:it}=tt.rawDims,{style:mt}=Z,St=f.FeatureTest.isCSSRoundSupported,vt=`var(--scale-factor) * ${J}px`,Q=`var(--scale-factor) * ${it}px`,wt=St?`round(${vt}, 1px)`:`calc(${vt})`,Pt=St?`round(${Q}, 1px)`:`calc(${Q})`;!A||tt.rotation%180===0?(mt.width=wt,mt.height=Pt):(mt.width=Pt,mt.height=wt)}N&&Z.setAttribute("data-main-rotation",tt.rotation)}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=W(1);class f{constructor(){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,B){return"none"}addHighlightHCMFilter(m,B,I,_){return"none"}destroy(m=!1){}}e.BaseFilterFactory=f;class z{constructor(){this.constructor===z&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,B){if(m<=0||B<=0)throw new Error("Invalid canvas size");const I=this._createCanvas(m,B);return{canvas:I,context:I.getContext("2d")}}reset(m,B,I){if(!m.canvas)throw new Error("Canvas is not specified");if(B<=0||I<=0)throw new Error("Invalid canvas size");m.canvas.width=B,m.canvas.height=I}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,B){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=z;class H{constructor({baseUrl:m=null,isCompressed:B=!0}){this.constructor===H&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=B}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const B=this.baseUrl+m+(this.isCompressed?".bcmap":""),I=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(B,I).catch(_=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${B}`)})}_fetchData(m,B){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=H;class ut{constructor({baseUrl:m=null}){this.constructor===ut&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const B=`${this.baseUrl}${m}`;return this._fetchData(B).catch(I=>{throw new Error(`Unable to load font data at: ${B}`)})}_fetchData(m){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=ut;class k{constructor(){this.constructor===k&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,B,I=!1){if(m<=0||B<=0)throw new Error("Invalid SVG dimensions");const _=this._createSVG("svg:svg");return _.setAttribute("version","1.1"),I||(_.setAttribute("width",`${m}px`),_.setAttribute("height",`${B}px`)),_.setAttribute("preserveAspectRatio","none"),_.setAttribute("viewBox",`0 0 ${m} ${B}`),_}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=k},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=W(1);const f=3285377520,z=4294901760,H=65535;class ut{constructor(w){this.h1=w?w&4294967295:f,this.h2=w?w&4294967295:f}update(w){let m,B;if(typeof w=="string"){m=new Uint8Array(w.length*2),B=0;for(let l=0,c=w.length;l<c;l++){const h=w.charCodeAt(l);h<=255?m[B++]=h:(m[B++]=h>>>8,m[B++]=h&255)}}else if((0,n.isArrayBuffer)(w))m=w.slice(),B=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const I=B>>2,_=B-I*4,b=new Uint32Array(m.buffer,0,I);let T=0,g=0,u=this.h1,y=this.h2;const D=3432918353,v=461845907,o=D&H,d=v&H;for(let l=0;l<I;l++)l&1?(T=b[l],T=T*D&z|T*o&H,T=T<<15|T>>>17,T=T*v&z|T*d&H,u^=T,u=u<<13|u>>>19,u=u*5+3864292196):(g=b[l],g=g*D&z|g*o&H,g=g<<15|g>>>17,g=g*v&z|g*d&H,y^=g,y=y<<13|y>>>19,y=y*5+3864292196);switch(T=0,_){case 3:T^=m[I*4+2]<<16;case 2:T^=m[I*4+1]<<8;case 1:T^=m[I*4],T=T*D&z|T*o&H,T=T<<15|T>>>17,T=T*v&z|T*d&H,I&1?u^=T:y^=T}this.h1=u,this.h2=y}hexdigest(){let w=this.h1,m=this.h2;return w^=m>>>1,w=w*3981806797&z|w*36045&H,m=m*4283543511&z|((m<<16|w>>>16)*2950163797&z)>>>16,w^=m>>>1,w=w*444984403&z|w*60499&H,m=m*3301882366&z|((m<<16|w>>>16)*3120437893&z)>>>16,w^=m>>>1,(w>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=ut},(U,e,W)=>{var H;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=W(1);class f{constructor({ownerDocument:k=globalThis.document,styleElement:w=null}){rt(this,H,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const w=this.styleElement.sheet;w.insertRule(k,w.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,H).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(k){if(!(!k||t(this,H).has(k.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:w,src:m,style:B}=k,I=new FontFace(w,m,B);this.addNativeFontFace(I);try{await I.load(),t(this,H).add(w)}catch{(0,n.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(I)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=k.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(B){throw(0,n.warn)(`Failed to load font '${m.family}': '${B}'.`),k.disableFontFace=!0,B}}return}const w=k.createFontFaceRule();if(w){if(this.insertRule(w),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const B=this._queueLoadingCallback(m);this._prepareFontLoadEvent(k,B)})}}get isFontLoadingAPISupported(){var w;const k=!!((w=this._document)!=null&&w.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function w(){for((0,n.assert)(!B.done,"completeRequest() cannot be called twice."),B.done=!0;m.length>0&&m[0].done;){const I=m.shift();setTimeout(I.callback,0)}}const{loadingRequests:m}=this,B={done:!1,complete:w,callback:k};return m.push(B),B}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,w){function m(a,E){return a.charCodeAt(E)<<24|a.charCodeAt(E+1)<<16|a.charCodeAt(E+2)<<8|a.charCodeAt(E+3)&255}function B(a,E,x,et){const $=a.substring(0,E),K=a.substring(E+x);return $+et+K}let I,_;const b=this._document.createElement("canvas");b.width=1,b.height=1;const T=b.getContext("2d");let g=0;function u(a,E){if(++g>30){(0,n.warn)("Load test font never loaded."),E();return}if(T.font="30px "+a,T.fillText(".",0,20),T.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(u.bind(null,a,E))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let D=this._loadTestFont;D=B(D,976,y.length,y);const o=16,d=1482184792;let l=m(D,o);for(I=0,_=y.length-3;I<_;I+=4)l=l-d+m(y,I)|0;I<y.length&&(l=l-d+m(y+"XXX",I)|0),D=B(D,o,4,(0,n.string32)(l));const c=`url(data:font/opentype;base64,${btoa(D)});`,h=`@font-face {font-family:"${y}";src:${c}}`;this.insertRule(h);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const a of[k.loadedName,y]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=a,O.append(E)}this._document.body.append(O),u(y,()=>{O.remove(),w.complete()})}}H=new WeakMap,e.FontLoader=f;class z{constructor(k,{isEvalSupported:w=!0,disableFontFace:m=!1,ignoreErrors:B=!1,inspectFont:I=null}){this.compiledGlyphs=Object.create(null);for(const _ in k)this[_]=k[_];this.isEvalSupported=w!==!1,this.disableFontFace=m===!0,this.ignoreErrors=B===!0,this._inspectFont=I}createNativeFontFace(){var w;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(w=this._inspectFont)==null||w.call(this,this),k}createFontFaceRule(){var B;if(!this.data||this.disableFontFace)return null;const k=(0,n.bytesToString)(this.data),w=`url(data:${this.mimetype};base64,${btoa(k)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${w}}`;else{let I=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(I+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${I}src:${w}}`}return(B=this._inspectFont)==null||B.call(this,this,w),m}getPathGenerator(k,w){if(this.compiledGlyphs[w]!==void 0)return this.compiledGlyphs[w];let m;try{m=k.get(this.loadedName+"_path_"+w)}catch(B){if(!this.ignoreErrors)throw B;return(0,n.warn)(`getPathGenerator - ignoring character: "${B}".`),this.compiledGlyphs[w]=function(I,_){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const B=[];for(const I of m){const _=I.args!==void 0?I.args.join(","):"";B.push("c.",I.cmd,"(",_,`);
`)}return this.compiledGlyphs[w]=new Function("c","size",B.join(""))}return this.compiledGlyphs[w]=function(B,I){for(const _ of m)_.cmd==="scale"&&(_.args=[I,-I]),B[_.cmd].apply(B,_.args)}}}e.FontFaceObject=z},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=W(7);W(1);const f=function(w){return new Promise((m,B)=>{require$$5.readFile(w,(_,b)=>{if(_||!b){B(new Error(_));return}m(new Uint8Array(b))})})};class z extends n.BaseFilterFactory{}e.NodeFilterFactory=z;class H extends n.BaseCanvasFactory{_createCanvas(m,B){return require$$5.createCanvas(m,B)}}e.NodeCanvasFactory=H;class ut extends n.BaseCMapReaderFactory{_fetchData(m,B){return f(m).then(I=>({cMapData:I,compressionType:B}))}}e.NodeCMapReaderFactory=ut;class k extends n.BaseStandardFontDataFactory{_fetchData(m){return f(m)}}e.NodeStandardFontDataFactory=k},(U,e,W)=>{var at,qe,Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=W(1),f=W(6),z=W(12),H=W(13);const ut=16,k=100,w=4096,m=15,B=10,I=1e3,_=16;function b(S,s){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){s.save(),this.__originalSave()},S.restore=function(){s.restore(),this.__originalRestore()},S.translate=function(p,F){s.translate(p,F),this.__originalTranslate(p,F)},S.scale=function(p,F){s.scale(p,F),this.__originalScale(p,F)},S.transform=function(p,F,M,L,q,st){s.transform(p,F,M,L,q,st),this.__originalTransform(p,F,M,L,q,st)},S.setTransform=function(p,F,M,L,q,st){s.setTransform(p,F,M,L,q,st),this.__originalSetTransform(p,F,M,L,q,st)},S.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},S.rotate=function(p){s.rotate(p),this.__originalRotate(p)},S.clip=function(p){s.clip(p),this.__originalClip(p)},S.moveTo=function(i,p){s.moveTo(i,p),this.__originalMoveTo(i,p)},S.lineTo=function(i,p){s.lineTo(i,p),this.__originalLineTo(i,p)},S.bezierCurveTo=function(i,p,F,M,L,q){s.bezierCurveTo(i,p,F,M,L,q),this.__originalBezierCurveTo(i,p,F,M,L,q)},S.rect=function(i,p,F,M){s.rect(i,p,F,M),this.__originalRect(i,p,F,M)},S.closePath=function(){s.closePath(),this.__originalClosePath()},S.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class T{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,i,p){let F;return this.cache[s]!==void 0?(F=this.cache[s],this.canvasFactory.reset(F,i,p)):(F=this.canvasFactory.create(i,p),this.cache[s]=F),F}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const i=this.cache[s];this.canvasFactory.destroy(i),delete this.cache[s]}}}function g(S,s,i,p,F,M,L,q,st,ht){const[gt,yt,ft,bt,Z,tt]=(0,f.getCurrentTransform)(S);if(yt===0&&ft===0){const J=L*gt+Z,it=Math.round(J),mt=q*bt+tt,St=Math.round(mt),vt=(L+st)*gt+Z,Q=Math.abs(Math.round(vt)-it)||1,wt=(q+ht)*bt+tt,Pt=Math.abs(Math.round(wt)-St)||1;return S.setTransform(Math.sign(gt),0,0,Math.sign(bt),it,St),S.drawImage(s,i,p,F,M,0,0,Q,Pt),S.setTransform(gt,yt,ft,bt,Z,tt),[Q,Pt]}if(gt===0&&bt===0){const J=q*ft+Z,it=Math.round(J),mt=L*yt+tt,St=Math.round(mt),vt=(q+ht)*ft+Z,Q=Math.abs(Math.round(vt)-it)||1,wt=(L+st)*yt+tt,Pt=Math.abs(Math.round(wt)-St)||1;return S.setTransform(0,Math.sign(yt),Math.sign(ft),0,it,St),S.drawImage(s,i,p,F,M,0,0,Pt,Q),S.setTransform(gt,yt,ft,bt,Z,tt),[Pt,Q]}S.drawImage(s,i,p,F,M,L,q,st,ht);const A=Math.hypot(gt,yt),N=Math.hypot(ft,bt);return[A*st,N*ht]}function u(S){const{width:s,height:i}=S;if(s>I||i>I)return null;const p=1e3,F=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),M=s+1;let L=new Uint8Array(M*(i+1)),q,st,ht;const gt=s+7&-8;let yt=new Uint8Array(gt*i),ft=0;for(const N of S.data){let J=128;for(;J>0;)yt[ft++]=N&J?0:255,J>>=1}let bt=0;for(ft=0,yt[ft]!==0&&(L[0]=1,++bt),st=1;st<s;st++)yt[ft]!==yt[ft+1]&&(L[st]=yt[ft]?2:1,++bt),ft++;for(yt[ft]!==0&&(L[st]=2,++bt),q=1;q<i;q++){ft=q*gt,ht=q*M,yt[ft-gt]!==yt[ft]&&(L[ht]=yt[ft]?1:8,++bt);let N=(yt[ft]?4:0)+(yt[ft-gt]?8:0);for(st=1;st<s;st++)N=(N>>2)+(yt[ft+1]?4:0)+(yt[ft-gt+1]?8:0),F[N]&&(L[ht+st]=F[N],++bt),ft++;if(yt[ft-gt]!==yt[ft]&&(L[ht+st]=yt[ft]?2:4,++bt),bt>p)return null}for(ft=gt*(i-1),ht=q*M,yt[ft]!==0&&(L[ht]=8,++bt),st=1;st<s;st++)yt[ft]!==yt[ft+1]&&(L[ht+st]=yt[ft]?4:8,++bt),ft++;if(yt[ft]!==0&&(L[ht+st]=4,++bt),bt>p)return null;const Z=new Int32Array([0,M,-1,0,-M,0,0,0,1]),tt=new Path2D;for(q=0;bt&&q<=i;q++){let N=q*M;const J=N+s;for(;N<J&&!L[N];)N++;if(N===J)continue;tt.moveTo(N%M,q);const it=N;let mt=L[N];do{const St=Z[mt];do N+=St;while(!L[N]);const vt=L[N];vt!==5&&vt!==10?(mt=vt,L[N]=0):(mt=vt&51*mt>>4,L[N]&=mt>>2|mt<<2),tt.lineTo(N%M,N/M|0),L[N]||--bt}while(it!==N);--q}return yt=null,L=null,function(N){N.save(),N.scale(1/s,-1/i),N.translate(0,-i),N.fill(tt),N.beginPath(),N.restore()}}class y{constructor(s,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,i])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,i){this.x=s,this.y=i}updatePathMinMax(s,i,p){[i,p]=n.Util.applyTransform([i,p],s),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,p),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,p)}updateRectMinMax(s,i){const p=n.Util.applyTransform(i,s),F=n.Util.applyTransform(i.slice(2),s);this.minX=Math.min(this.minX,p[0],F[0]),this.minY=Math.min(this.minY,p[1],F[1]),this.maxX=Math.max(this.maxX,p[0],F[0]),this.maxY=Math.max(this.maxY,p[1],F[1])}updateScalingPathMinMax(s,i){n.Util.scaleMinMax(s,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(s,i,p,F,M,L,q,st,ht,gt){const yt=n.Util.bezierBoundingBox(i,p,F,M,L,q,st,ht);if(gt){gt[0]=Math.min(gt[0],yt[0],yt[2]),gt[1]=Math.max(gt[1],yt[0],yt[2]),gt[2]=Math.min(gt[2],yt[1],yt[3]),gt[3]=Math.max(gt[3],yt[1],yt[3]);return}this.updateRectMinMax(s,yt)}getPathBoundingBox(s=z.PathType.FILL,i=null){const p=[this.minX,this.minY,this.maxX,this.maxY];if(s===z.PathType.STROKE){i||(0,n.unreachable)("Stroke bounding box must include transform.");const F=n.Util.singularValueDecompose2dScale(i),M=F[0]*this.lineWidth/2,L=F[1]*this.lineWidth/2;p[0]-=M,p[1]-=L,p[2]+=M,p[3]+=L}return p}updateClipFromPath(){const s=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=z.PathType.FILL,i=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(s,i))}}function D(S,s){if(typeof ImageData<"u"&&s instanceof ImageData){S.putImageData(s,0,0);return}const i=s.height,p=s.width,F=i%_,M=(i-F)/_,L=F===0?M:M+1,q=S.createImageData(p,_);let st=0,ht;const gt=s.data,yt=q.data;let ft,bt,Z,tt;if(s.kind===n.ImageKind.GRAYSCALE_1BPP){const A=gt.byteLength,N=new Uint32Array(yt.buffer,0,yt.byteLength>>2),J=N.length,it=p+7>>3,mt=4294967295,St=n.FeatureTest.isLittleEndian?4278190080:255;for(ft=0;ft<L;ft++){for(Z=ft<M?_:F,ht=0,bt=0;bt<Z;bt++){const vt=A-st;let Q=0;const wt=vt>it?p:vt*8-7,Pt=wt&-8;let Wt=0,Ut=0;for(;Q<Pt;Q+=8)Ut=gt[st++],N[ht++]=Ut&128?mt:St,N[ht++]=Ut&64?mt:St,N[ht++]=Ut&32?mt:St,N[ht++]=Ut&16?mt:St,N[ht++]=Ut&8?mt:St,N[ht++]=Ut&4?mt:St,N[ht++]=Ut&2?mt:St,N[ht++]=Ut&1?mt:St;for(;Q<wt;Q++)Wt===0&&(Ut=gt[st++],Wt=128),N[ht++]=Ut&Wt?mt:St,Wt>>=1}for(;ht<J;)N[ht++]=0;S.putImageData(q,0,ft*_)}}else if(s.kind===n.ImageKind.RGBA_32BPP){for(bt=0,tt=p*_*4,ft=0;ft<M;ft++)yt.set(gt.subarray(st,st+tt)),st+=tt,S.putImageData(q,0,bt),bt+=_;ft<L&&(tt=p*F*4,yt.set(gt.subarray(st,st+tt)),S.putImageData(q,0,bt))}else if(s.kind===n.ImageKind.RGB_24BPP)for(Z=_,tt=p*Z,ft=0;ft<L;ft++){for(ft>=M&&(Z=F,tt=p*Z),ht=0,bt=tt;bt--;)yt[ht++]=gt[st++],yt[ht++]=gt[st++],yt[ht++]=gt[st++],yt[ht++]=255;S.putImageData(q,0,ft*_)}else throw new Error(`bad image kind: ${s.kind}`)}function v(S,s){if(s.bitmap){S.drawImage(s.bitmap,0,0);return}const i=s.height,p=s.width,F=i%_,M=(i-F)/_,L=F===0?M:M+1,q=S.createImageData(p,_);let st=0;const ht=s.data,gt=q.data;for(let yt=0;yt<L;yt++){const ft=yt<M?_:F;({srcPos:st}=(0,H.convertBlackAndWhiteToRGBA)({src:ht,srcPos:st,dest:gt,width:p,height:ft,nonBlackColor:0})),S.putImageData(q,0,yt*_)}}function o(S,s){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const p of i)S[p]!==void 0&&(s[p]=S[p]);S.setLineDash!==void 0&&(s.setLineDash(S.getLineDash()),s.lineDashOffset=S.lineDashOffset)}function d(S){if(S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),!n.isNodeJS){const{filter:s}=S;s!=="none"&&s!==""&&(S.filter="none")}}function l(S,s,i,p){const F=S.length;for(let M=3;M<F;M+=4){const L=S[M];if(L===0)S[M-3]=s,S[M-2]=i,S[M-1]=p;else if(L<255){const q=255-L;S[M-3]=S[M-3]*L+s*q>>8,S[M-2]=S[M-2]*L+i*q>>8,S[M-1]=S[M-1]*L+p*q>>8}}}function c(S,s,i){const p=S.length,F=1/255;for(let M=3;M<p;M+=4){const L=i?i[S[M]]:S[M];s[M]=s[M]*L*F|0}}function h(S,s,i){const p=S.length;for(let F=3;F<p;F+=4){const M=S[F-3]*77+S[F-2]*152+S[F-1]*28;s[F]=i?s[F]*i[M>>8]>>8:s[F]*M>>16}}function O(S,s,i,p,F,M,L,q,st,ht,gt){const yt=!!M,ft=yt?M[0]:0,bt=yt?M[1]:0,Z=yt?M[2]:0,tt=F==="Luminosity"?h:c,N=Math.min(p,Math.ceil(1048576/i));for(let J=0;J<p;J+=N){const it=Math.min(N,p-J),mt=S.getImageData(q-ht,J+(st-gt),i,it),St=s.getImageData(q,J+st,i,it);yt&&l(mt.data,ft,bt,Z),tt(mt.data,St.data,L),s.putImageData(St,q,J+st)}}function a(S,s,i,p){const F=p[0],M=p[1],L=p[2]-F,q=p[3]-M;L===0||q===0||(O(s.context,i,L,q,s.subtype,s.backdrop,s.transferMap,F,M,s.offsetX,s.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(i.canvas,0,0),S.restore())}function E(S,s){const i=n.Util.singularValueDecompose2dScale(S);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const p=Math.fround((globalThis.devicePixelRatio||1)*f.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:i[0]<=p||i[1]<=p}const x=["butt","round","square"],et=["miter","round","bevel"],$={},K={},nt=class nt{constructor(s,i,p,F,M,{optionalContentConfig:L,markedContentStack:q=null},st,ht){rt(this,at);this.ctx=s,this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=p,this.canvasFactory=F,this.filterFactory=M,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=q||[],this.optionalContentConfig=L,this.cachedCanvases=new T(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=st,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ht,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,i=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):i}beginDrawing({transform:s,viewport:i,transparency:p=!1,background:F=null}){const M=this.ctx.canvas.width,L=this.ctx.canvas.height,q=this.ctx.fillStyle;if(this.ctx.fillStyle=F||"#ffffff",this.ctx.fillRect(0,0,M,L),this.ctx.fillStyle=q,p){const st=this.cachedCanvases.getCanvas("transparent",M,L);this.compositeCtx=this.ctx,this.transparentCanvas=st.canvas,this.ctx=st.context,this.ctx.save(),this.ctx.transform(...(0,f.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,f.getCurrentTransform)(this.ctx)}executeOperatorList(s,i,p,F){const M=s.argsArray,L=s.fnArray;let q=i||0;const st=M.length;if(st===q)return q;const ht=st-q>B&&typeof p=="function",gt=ht?Date.now()+m:0;let yt=0;const ft=this.commonObjs,bt=this.objs;let Z;for(;;){if(F!==void 0&&q===F.nextBreakPoint)return F.breakIt(q,p),q;if(Z=L[q],Z!==n.OPS.dependency)this[Z].apply(this,M[q]);else for(const tt of M[q]){const A=tt.startsWith("g_")?ft:bt;if(!A.has(tt))return A.get(tt,p),q}if(q++,q===st)return q;if(ht&&++yt>B){if(Date.now()>gt)return p(),q;yt=0}}}endDrawing(){Y(this,at,qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const i of s.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);s.clear()}this._cachedBitmapsMap.clear(),Y(this,at,Ye).call(this)}_scaleImage(s,i){const p=s.width,F=s.height;let M=Math.max(Math.hypot(i[0],i[1]),1),L=Math.max(Math.hypot(i[2],i[3]),1),q=p,st=F,ht="prescale1",gt,yt;for(;M>2&&q>1||L>2&&st>1;){let ft=q,bt=st;M>2&&q>1&&(ft=q>=16384?Math.floor(q/2)-1||1:Math.ceil(q/2),M/=q/ft),L>2&&st>1&&(bt=st>=16384?Math.floor(st/2)-1||1:Math.ceil(st)/2,L/=st/bt),gt=this.cachedCanvases.getCanvas(ht,ft,bt),yt=gt.context,yt.clearRect(0,0,ft,bt),yt.drawImage(s,0,0,q,st,0,0,ft,bt),s=gt.canvas,q=ft,st=bt,ht=ht==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:q,paintHeight:st}}_createMaskCanvas(s){const i=this.ctx,{width:p,height:F}=s,M=this.current.fillColor,L=this.current.patternFill,q=(0,f.getCurrentTransform)(i);let st,ht,gt,yt;if((s.bitmap||s.data)&&s.count>1){const Q=s.bitmap||s.data.buffer;ht=JSON.stringify(L?q:[q.slice(0,4),M]),st=this._cachedBitmapsMap.get(Q),st||(st=new Map,this._cachedBitmapsMap.set(Q,st));const wt=st.get(ht);if(wt&&!L){const Pt=Math.round(Math.min(q[0],q[2])+q[4]),Wt=Math.round(Math.min(q[1],q[3])+q[5]);return{canvas:wt,offsetX:Pt,offsetY:Wt}}gt=wt}gt||(yt=this.cachedCanvases.getCanvas("maskCanvas",p,F),v(yt.context,s));let ft=n.Util.transform(q,[1/p,0,0,-1/F,0,0]);ft=n.Util.transform(ft,[1,0,0,1,0,-F]);const bt=n.Util.applyTransform([0,0],ft),Z=n.Util.applyTransform([p,F],ft),tt=n.Util.normalizeRect([bt[0],bt[1],Z[0],Z[1]]),A=Math.round(tt[2]-tt[0])||1,N=Math.round(tt[3]-tt[1])||1,J=this.cachedCanvases.getCanvas("fillCanvas",A,N),it=J.context,mt=Math.min(bt[0],Z[0]),St=Math.min(bt[1],Z[1]);it.translate(-mt,-St),it.transform(...ft),gt||(gt=this._scaleImage(yt.canvas,(0,f.getCurrentTransformInverse)(it)),gt=gt.img,st&&L&&st.set(ht,gt)),it.imageSmoothingEnabled=E((0,f.getCurrentTransform)(it),s.interpolate),g(it,gt,0,0,gt.width,gt.height,0,0,p,F),it.globalCompositeOperation="source-in";const vt=n.Util.transform((0,f.getCurrentTransformInverse)(it),[1,0,0,1,-mt,-St]);return it.fillStyle=L?M.getPattern(i,this,vt,z.PathType.FILL):M,it.fillRect(0,0,p,F),st&&!L&&(this.cachedCanvases.delete("fillCanvas"),st.set(ht,J.canvas)),{canvas:J.canvas,offsetX:Math.round(mt),offsetY:Math.round(St)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=x[s]}setLineJoin(s){this.ctx.lineJoin=et[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,i){const p=this.ctx;p.setLineDash!==void 0&&(p.setLineDash(s),p.lineDashOffset=i)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[i,p]of s)switch(i){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p[0],p[1]);break;case"CA":this.current.strokeAlpha=p;break;case"ca":this.current.fillAlpha=p,this.ctx.globalAlpha=p;break;case"BM":this.ctx.globalCompositeOperation=p;break;case"SMask":this.current.activeSMask=p?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(p);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,i=this.ctx.canvas.height,p="smaskGroupAt"+this.groupLevel,F=this.cachedCanvases.getCanvas(p,s,i);this.suspendedCtx=this.ctx,this.ctx=F.context;const M=this.ctx;M.setTransform(...(0,f.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,M),b(M,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,p=this.suspendedCtx;a(p,i,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,i,p,F,M,L){this.ctx.transform(s,i,p,F,M,L),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,i,p){const F=this.ctx,M=this.current;let L=M.x,q=M.y,st,ht;const gt=(0,f.getCurrentTransform)(F),yt=gt[0]===0&&gt[3]===0||gt[1]===0&&gt[2]===0,ft=yt?p.slice(0):null;for(let bt=0,Z=0,tt=s.length;bt<tt;bt++)switch(s[bt]|0){case n.OPS.rectangle:L=i[Z++],q=i[Z++];const A=i[Z++],N=i[Z++],J=L+A,it=q+N;F.moveTo(L,q),A===0||N===0?F.lineTo(J,it):(F.lineTo(J,q),F.lineTo(J,it),F.lineTo(L,it)),yt||M.updateRectMinMax(gt,[L,q,J,it]),F.closePath();break;case n.OPS.moveTo:L=i[Z++],q=i[Z++],F.moveTo(L,q),yt||M.updatePathMinMax(gt,L,q);break;case n.OPS.lineTo:L=i[Z++],q=i[Z++],F.lineTo(L,q),yt||M.updatePathMinMax(gt,L,q);break;case n.OPS.curveTo:st=L,ht=q,L=i[Z+4],q=i[Z+5],F.bezierCurveTo(i[Z],i[Z+1],i[Z+2],i[Z+3],L,q),M.updateCurvePathMinMax(gt,st,ht,i[Z],i[Z+1],i[Z+2],i[Z+3],L,q,ft),Z+=6;break;case n.OPS.curveTo2:st=L,ht=q,F.bezierCurveTo(L,q,i[Z],i[Z+1],i[Z+2],i[Z+3]),M.updateCurvePathMinMax(gt,st,ht,L,q,i[Z],i[Z+1],i[Z+2],i[Z+3],ft),L=i[Z+2],q=i[Z+3],Z+=4;break;case n.OPS.curveTo3:st=L,ht=q,L=i[Z+2],q=i[Z+3],F.bezierCurveTo(i[Z],i[Z+1],L,q,L,q),M.updateCurvePathMinMax(gt,st,ht,i[Z],i[Z+1],L,q,L,q,ft),Z+=4;break;case n.OPS.closePath:F.closePath();break}yt&&M.updateScalingPathMinMax(gt,ft),M.setCurrentPoint(L,q)}closePath(){this.ctx.closePath()}stroke(s=!0){const i=this.ctx,p=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof p=="object"&&(p!=null&&p.getPattern)?(i.save(),i.strokeStyle=p.getPattern(i,this,(0,f.getCurrentTransformInverse)(i),z.PathType.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const i=this.ctx,p=this.current.fillColor,F=this.current.patternFill;let M=!1;F&&(i.save(),i.fillStyle=p.getPattern(i,this,(0,f.getCurrentTransformInverse)(i),z.PathType.FILL),M=!0);const L=this.current.getClippedPathBoundingBox();this.contentVisible&&L!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),M&&i.restore(),s&&this.consumePath(L)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=$}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,i=this.ctx;if(s===void 0){i.beginPath();return}i.save(),i.beginPath();for(const p of s)i.setTransform(...p.transform),i.translate(p.x,p.y),p.addToPath(i,p.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,i){var gt;const p=this.commonObjs.get(s),F=this.current;if(!p)throw new Error(`Can't find font for ${s}`);if(F.fontMatrix=p.fontMatrix||n.FONT_IDENTITY_MATRIX,(F.fontMatrix[0]===0||F.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+s),i<0?(i=-i,F.fontDirection=-1):F.fontDirection=1,this.current.font=p,this.current.fontSize=i,p.isType3Font)return;const M=p.loadedName||"sans-serif",L=((gt=p.systemFontInfo)==null?void 0:gt.css)||`"${M}", ${p.fallbackName}`;let q="normal";p.black?q="900":p.bold&&(q="bold");const st=p.italic?"italic":"normal";let ht=i;i<ut?ht=ut:i>k&&(ht=k),this.current.fontSizeScale=i/ht,this.ctx.font=`${st} ${q} ${ht}px ${L}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,i){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=i}setLeadingMoveText(s,i){this.setLeading(-i),this.moveText(s,i)}setTextMatrix(s,i,p,F,M,L){this.current.textMatrix=[s,i,p,F,M,L],this.current.textMatrixScale=Math.hypot(s,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,i,p,F){const M=this.ctx,L=this.current,q=L.font,st=L.textRenderingMode,ht=L.fontSize/L.fontSizeScale,gt=st&n.TextRenderingMode.FILL_STROKE_MASK,yt=!!(st&n.TextRenderingMode.ADD_TO_PATH_FLAG),ft=L.patternFill&&!q.missingFile;let bt;(q.disableFontFace||yt||ft)&&(bt=q.getPathGenerator(this.commonObjs,s)),q.disableFontFace||ft?(M.save(),M.translate(i,p),M.beginPath(),bt(M,ht),F&&M.setTransform(...F),(gt===n.TextRenderingMode.FILL||gt===n.TextRenderingMode.FILL_STROKE)&&M.fill(),(gt===n.TextRenderingMode.STROKE||gt===n.TextRenderingMode.FILL_STROKE)&&M.stroke(),M.restore()):((gt===n.TextRenderingMode.FILL||gt===n.TextRenderingMode.FILL_STROKE)&&M.fillText(s,i,p),(gt===n.TextRenderingMode.STROKE||gt===n.TextRenderingMode.FILL_STROKE)&&M.strokeText(s,i,p)),yt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,f.getCurrentTransform)(M),x:i,y:p,fontSize:ht,addToPath:bt})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const i=s.getImageData(0,0,10,10).data;let p=!1;for(let F=3;F<i.length;F+=4)if(i[F]>0&&i[F]<255){p=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",p)}showText(s){const i=this.current,p=i.font;if(p.isType3Font)return this.showType3Text(s);const F=i.fontSize;if(F===0)return;const M=this.ctx,L=i.fontSizeScale,q=i.charSpacing,st=i.wordSpacing,ht=i.fontDirection,gt=i.textHScale*ht,yt=s.length,ft=p.vertical,bt=ft?1:-1,Z=p.defaultVMetrics,tt=F*i.fontMatrix[0],A=i.textRenderingMode===n.TextRenderingMode.FILL&&!p.disableFontFace&&!i.patternFill;M.save(),M.transform(...i.textMatrix),M.translate(i.x,i.y+i.textRise),ht>0?M.scale(gt,-1):M.scale(gt,1);let N;if(i.patternFill){M.save();const vt=i.fillColor.getPattern(M,this,(0,f.getCurrentTransformInverse)(M),z.PathType.FILL);N=(0,f.getCurrentTransform)(M),M.restore(),M.fillStyle=vt}let J=i.lineWidth;const it=i.textMatrixScale;if(it===0||J===0){const vt=i.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(vt===n.TextRenderingMode.STROKE||vt===n.TextRenderingMode.FILL_STROKE)&&(J=this.getSinglePixelWidth())}else J/=it;if(L!==1&&(M.scale(L,L),J/=L),M.lineWidth=J,p.isInvalidPDFjsFont){const vt=[];let Q=0;for(const wt of s)vt.push(wt.unicode),Q+=wt.width;M.fillText(vt.join(""),0,0),i.x+=Q*tt*gt,M.restore(),this.compose();return}let mt=0,St;for(St=0;St<yt;++St){const vt=s[St];if(typeof vt=="number"){mt+=bt*vt*F/1e3;continue}let Q=!1;const wt=(vt.isSpace?st:0)+q,Pt=vt.fontChar,Wt=vt.accent;let Ut,zt,Ft=vt.width;if(ft){const Gt=vt.vmetric||Z,qt=-(vt.vmetric?Gt[1]:Ft*.5)*tt,Et=Gt[2]*tt;Ft=Gt?-Gt[0]:Ft,Ut=qt/L,zt=(mt+Et)/L}else Ut=mt/L,zt=0;if(p.remeasure&&Ft>0){const Gt=M.measureText(Pt).width*1e3/F*L;if(Ft<Gt&&this.isFontSubpixelAAEnabled){const qt=Ft/Gt;Q=!0,M.save(),M.scale(qt,1),Ut/=qt}else Ft!==Gt&&(Ut+=(Ft-Gt)/2e3*F/L)}if(this.contentVisible&&(vt.isInFont||p.missingFile)){if(A&&!Wt)M.fillText(Pt,Ut,zt);else if(this.paintChar(Pt,Ut,zt,N),Wt){const Gt=Ut+F*Wt.offset.x/L,qt=zt-F*Wt.offset.y/L;this.paintChar(Wt.fontChar,Gt,qt,N)}}const It=ft?Ft*tt-wt*ht:Ft*tt+wt*ht;mt+=It,Q&&M.restore()}ft?i.y-=mt:i.x+=mt*gt,M.restore(),this.compose()}showType3Text(s){const i=this.ctx,p=this.current,F=p.font,M=p.fontSize,L=p.fontDirection,q=F.vertical?1:-1,st=p.charSpacing,ht=p.wordSpacing,gt=p.textHScale*L,yt=p.fontMatrix||n.FONT_IDENTITY_MATRIX,ft=s.length,bt=p.textRenderingMode===n.TextRenderingMode.INVISIBLE;let Z,tt,A,N;if(!(bt||M===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...p.textMatrix),i.translate(p.x,p.y),i.scale(gt,L),Z=0;Z<ft;++Z){if(tt=s[Z],typeof tt=="number"){N=q*tt*M/1e3,this.ctx.translate(N,0),p.x+=N*gt;continue}const J=(tt.isSpace?ht:0)+st,it=F.charProcOperatorList[tt.operatorListId];if(!it){(0,n.warn)(`Type3 character "${tt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=tt,this.save(),i.scale(M,M),i.transform(...yt),this.executeOperatorList(it),this.restore()),A=n.Util.applyTransform([tt.width,0],yt)[0]*M+J,i.translate(A,0),p.x+=A*gt}i.restore(),this.processingType3=null}}setCharWidth(s,i){}setCharWidthAndBounds(s,i,p,F,M,L){this.ctx.rect(p,F,M-p,L-F),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let i;if(s[0]==="TilingPattern"){const p=s[1],F=this.baseTransform||(0,f.getCurrentTransform)(this.ctx),M={createCanvasGraphics:L=>new nt(L,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new z.TilingPattern(s,p,this.ctx,M,F)}else i=this._getPattern(s[1],s[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,i,p){const F=n.Util.makeHexColor(s,i,p);this.ctx.strokeStyle=F,this.current.strokeColor=F}setFillRGBColor(s,i,p){const F=n.Util.makeHexColor(s,i,p);this.ctx.fillStyle=F,this.current.fillColor=F,this.current.patternFill=!1}_getPattern(s,i=null){let p;return this.cachedPatterns.has(s)?p=this.cachedPatterns.get(s):(p=(0,z.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,p)),i&&(p.matrix=i),p}shadingFill(s){if(!this.contentVisible)return;const i=this.ctx;this.save();const p=this._getPattern(s);i.fillStyle=p.getPattern(i,this,(0,f.getCurrentTransformInverse)(i),z.PathType.SHADING);const F=(0,f.getCurrentTransformInverse)(i);if(F){const{width:M,height:L}=i.canvas,[q,st,ht,gt]=n.Util.getAxialAlignedBoundingBox([0,0,M,L],F);this.ctx.fillRect(q,st,ht-q,gt-st)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,f.getCurrentTransform)(this.ctx),i)){const p=i[2]-i[0],F=i[3]-i[1];this.ctx.rect(i[0],i[1],p,F),this.current.updateRectMinMax((0,f.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;s.isolated||(0,n.info)("TODO: Support non-isolated groups."),s.knockout&&(0,n.warn)("Knockout groups not supported.");const p=(0,f.getCurrentTransform)(i);if(s.matrix&&i.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let F=n.Util.getAxialAlignedBoundingBox(s.bbox,(0,f.getCurrentTransform)(i));const M=[0,0,i.canvas.width,i.canvas.height];F=n.Util.intersect(F,M)||[0,0,0,0];const L=Math.floor(F[0]),q=Math.floor(F[1]);let st=Math.max(Math.ceil(F[2])-L,1),ht=Math.max(Math.ceil(F[3])-q,1),gt=1,yt=1;st>w&&(gt=st/w,st=w),ht>w&&(yt=ht/w,ht=w),this.current.startNewPathAndClipBox([0,0,st,ht]);let ft="groupAt"+this.groupLevel;s.smask&&(ft+="_smask_"+this.smaskCounter++%2);const bt=this.cachedCanvases.getCanvas(ft,st,ht),Z=bt.context;Z.scale(1/gt,1/yt),Z.translate(-L,-q),Z.transform(...p),s.smask?this.smaskStack.push({canvas:bt.canvas,context:Z,offsetX:L,offsetY:q,scaleX:gt,scaleY:yt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(L,q),i.scale(gt,yt),i.save()),o(i,Z),this.ctx=Z,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,p=this.groupStack.pop();if(this.ctx=p,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const F=(0,f.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...F);const M=n.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],F);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(M)}}beginAnnotation(s,i,p,F,M){if(Y(this,at,qe).call(this),d(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const L=i[2]-i[0],q=i[3]-i[1];if(M&&this.annotationCanvasMap){p=p.slice(),p[4]-=i[0],p[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=L,i[3]=q;const[st,ht]=n.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(this.ctx)),{viewportScale:gt}=this,yt=Math.ceil(L*this.outputScaleX*gt),ft=Math.ceil(q*this.outputScaleY*gt);this.annotationCanvas=this.canvasFactory.create(yt,ft);const{canvas:bt,context:Z}=this.annotationCanvas;this.annotationCanvasMap.set(s,bt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Z,this.ctx.save(),this.ctx.setTransform(st,0,0,-ht,0,q*ht),d(this.ctx)}else d(this.ctx),this.ctx.rect(i[0],i[1],L,q),this.ctx.clip(),this.endPath()}this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...p),this.transform(...F)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,at,Ye).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const i=s.count;s=this.getObject(s.data,s),s.count=i;const p=this.ctx,F=this.processingType3;if(F&&(F.compiled===void 0&&(F.compiled=u(s)),F.compiled)){F.compiled(p);return}const M=this._createMaskCanvas(s),L=M.canvas;p.save(),p.setTransform(1,0,0,1,0,0),p.drawImage(L,M.offsetX,M.offsetY),p.restore(),this.compose()}paintImageMaskXObjectRepeat(s,i,p=0,F=0,M,L){if(!this.contentVisible)return;s=this.getObject(s.data,s);const q=this.ctx;q.save();const st=(0,f.getCurrentTransform)(q);q.transform(i,p,F,M,0,0);const ht=this._createMaskCanvas(s);q.setTransform(1,0,0,1,ht.offsetX-st[4],ht.offsetY-st[5]);for(let gt=0,yt=L.length;gt<yt;gt+=2){const ft=n.Util.transform(st,[i,p,F,M,L[gt],L[gt+1]]),[bt,Z]=n.Util.applyTransform([0,0],ft);q.drawImage(ht.canvas,bt,Z)}q.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const i=this.ctx,p=this.current.fillColor,F=this.current.patternFill;for(const M of s){const{data:L,width:q,height:st,transform:ht}=M,gt=this.cachedCanvases.getCanvas("maskCanvas",q,st),yt=gt.context;yt.save();const ft=this.getObject(L,M);v(yt,ft),yt.globalCompositeOperation="source-in",yt.fillStyle=F?p.getPattern(yt,this,(0,f.getCurrentTransformInverse)(i),z.PathType.FILL):p,yt.fillRect(0,0,q,st),yt.restore(),i.save(),i.transform(...ht),i.scale(1,-1),g(i,gt.canvas,0,0,q,st,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const i=this.getObject(s);if(!i){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(s,i,p,F){if(!this.contentVisible)return;const M=this.getObject(s);if(!M){(0,n.warn)("Dependent image isn't ready yet");return}const L=M.width,q=M.height,st=[];for(let ht=0,gt=F.length;ht<gt;ht+=2)st.push({transform:[i,0,0,p,F[ht],F[ht+1]],x:0,y:0,w:L,h:q});this.paintInlineImageXObjectGroup(M,st)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:i,width:p,height:F}=s,M=this.cachedCanvases.getCanvas("inlineImage",p,F),L=M.context;return L.filter=this.current.transferMaps,L.drawImage(i,0,0),L.filter="none",M.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const i=s.width,p=s.height,F=this.ctx;if(this.save(),!n.isNodeJS){const{filter:q}=F;q!=="none"&&q!==""&&(F.filter="none")}F.scale(1/i,-1/p);let M;if(s.bitmap)M=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)M=s;else{const st=this.cachedCanvases.getCanvas("inlineImage",i,p).context;D(st,s),M=this.applyTransferMapsToCanvas(st)}const L=this._scaleImage(M,(0,f.getCurrentTransformInverse)(F));F.imageSmoothingEnabled=E((0,f.getCurrentTransform)(F),s.interpolate),g(F,L.img,0,0,L.paintWidth,L.paintHeight,0,-p,i,p),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,i){if(!this.contentVisible)return;const p=this.ctx;let F;if(s.bitmap)F=s.bitmap;else{const M=s.width,L=s.height,st=this.cachedCanvases.getCanvas("inlineImage",M,L).context;D(st,s),F=this.applyTransferMapsToCanvas(st)}for(const M of i)p.save(),p.transform(...M.transform),p.scale(1,-1),g(p,F,M.x,M.y,M.w,M.h,0,-1,1,1),p.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,i){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,i){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const p=this.ctx;this.pendingClip&&(i||(this.pendingClip===K?p.clip("evenodd"):p.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),p.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,f.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const i=Math.abs(s[0]*s[3]-s[2]*s[1]),p=Math.hypot(s[0],s[2]),F=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(p,F)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:i,b:p,c:F,d:M}=this.ctx.getTransform();let L,q;if(p===0&&F===0){const st=Math.abs(i),ht=Math.abs(M);if(st===ht)if(s===0)L=q=1/st;else{const gt=st*s;L=q=gt<1?1/gt:1}else if(s===0)L=1/st,q=1/ht;else{const gt=st*s,yt=ht*s;L=gt<1?1/gt:1,q=yt<1?1/yt:1}}else{const st=Math.abs(i*M-p*F),ht=Math.hypot(i,p),gt=Math.hypot(F,M);if(s===0)L=gt/st,q=ht/st;else{const yt=s*st;L=gt>yt?gt/yt:1,q=ht>yt?ht/yt:1}}this._cachedScaleForStroking[0]=L,this._cachedScaleForStroking[1]=q}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:i}=this,{lineWidth:p}=this.current,[F,M]=this.getScaleForStroking();if(i.lineWidth=p||1,F===1&&M===1){i.stroke();return}const L=i.getLineDash();if(s&&i.save(),i.scale(F,M),L.length>0){const q=Math.max(F,M);i.setLineDash(L.map(st=>st/q)),i.lineDashOffset/=q}i.stroke(),s&&i.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};at=new WeakSet,qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ye=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const i=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let G=nt;e.CanvasGraphics=G;for(const S in n.OPS)G.prototype[S]!==void 0&&(G.prototype[n.OPS[S]]=G.prototype[S])},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=_;var n=W(1),f=W(6);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=z;function H(u,y){if(!y)return;const D=y[2]-y[0],v=y[3]-y[1],o=new Path2D;o.rect(y[0],y[1],D,v),u.clip(o)}class ut{constructor(){this.constructor===ut&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class k extends ut{constructor(y){super(),this._type=y[1],this._bbox=y[2],this._colorStops=y[3],this._p0=y[4],this._p1=y[5],this._r0=y[6],this._r1=y[7],this.matrix=null}_createGradient(y){let D;this._type==="axial"?D=y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(D=y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const v of this._colorStops)D.addColorStop(v[0],v[1]);return D}getPattern(y,D,v,o){let d;if(o===z.STROKE||o===z.FILL){const l=D.current.getClippedPathBoundingBox(o,(0,f.getCurrentTransform)(y))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,O=D.cachedCanvases.getCanvas("pattern",c,h,!0),a=O.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.translate(-l[0],-l[1]),v=n.Util.transform(v,[1,0,0,1,l[0],l[1]]),a.transform(...D.baseTransform),this.matrix&&a.transform(...this.matrix),H(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),d=y.createPattern(O.canvas,"no-repeat");const E=new DOMMatrix(v);d.setTransform(E)}else H(y,this._bbox),d=this._createGradient(y);return d}}function w(u,y,D,v,o,d,l,c){const h=y.coords,O=y.colors,a=u.data,E=u.width*4;let x;h[D+1]>h[v+1]&&(x=D,D=v,v=x,x=d,d=l,l=x),h[v+1]>h[o+1]&&(x=v,v=o,o=x,x=l,l=c,c=x),h[D+1]>h[v+1]&&(x=D,D=v,v=x,x=d,d=l,l=x);const et=(h[D]+y.offsetX)*y.scaleX,$=(h[D+1]+y.offsetY)*y.scaleY,K=(h[v]+y.offsetX)*y.scaleX,G=(h[v+1]+y.offsetY)*y.scaleY,at=(h[o]+y.offsetX)*y.scaleX,C=(h[o+1]+y.offsetY)*y.scaleY;if($>=C)return;const V=O[d],nt=O[d+1],S=O[d+2],s=O[l],i=O[l+1],p=O[l+2],F=O[c],M=O[c+1],L=O[c+2],q=Math.round($),st=Math.round(C);let ht,gt,yt,ft,bt,Z,tt,A;for(let N=q;N<=st;N++){if(N<G){const vt=N<$?0:($-N)/($-G);ht=et-(et-K)*vt,gt=V-(V-s)*vt,yt=nt-(nt-i)*vt,ft=S-(S-p)*vt}else{let vt;N>C?vt=1:G===C?vt=0:vt=(G-N)/(G-C),ht=K-(K-at)*vt,gt=s-(s-F)*vt,yt=i-(i-M)*vt,ft=p-(p-L)*vt}let J;N<$?J=0:N>C?J=1:J=($-N)/($-C),bt=et-(et-at)*J,Z=V-(V-F)*J,tt=nt-(nt-M)*J,A=S-(S-L)*J;const it=Math.round(Math.min(ht,bt)),mt=Math.round(Math.max(ht,bt));let St=E*N+it*4;for(let vt=it;vt<=mt;vt++)J=(ht-vt)/(ht-bt),J<0?J=0:J>1&&(J=1),a[St++]=gt-(gt-Z)*J|0,a[St++]=yt-(yt-tt)*J|0,a[St++]=ft-(ft-A)*J|0,a[St++]=255}}function m(u,y,D){const v=y.coords,o=y.colors;let d,l;switch(y.type){case"lattice":const c=y.verticesPerRow,h=Math.floor(v.length/c)-1,O=c-1;for(d=0;d<h;d++){let a=d*c;for(let E=0;E<O;E++,a++)w(u,D,v[a],v[a+1],v[a+c],o[a],o[a+1],o[a+c]),w(u,D,v[a+c+1],v[a+1],v[a+c],o[a+c+1],o[a+1],o[a+c])}break;case"triangles":for(d=0,l=v.length;d<l;d+=3)w(u,D,v[d],v[d+1],v[d+2],o[d],o[d+1],o[d+2]);break;default:throw new Error("illegal figure")}}class B extends ut{constructor(y){super(),this._coords=y[2],this._colors=y[3],this._figures=y[4],this._bounds=y[5],this._bbox=y[7],this._background=y[8],this.matrix=null}_createMeshCanvas(y,D,v){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-c,a=Math.ceil(this._bounds[3])-h,E=Math.min(Math.ceil(Math.abs(O*y[0]*1.1)),3e3),x=Math.min(Math.ceil(Math.abs(a*y[1]*1.1)),3e3),et=O/E,$=a/x,K={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/et,scaleY:1/$},G=E+2*2,at=x+2*2,C=v.getCanvas("mesh",G,at,!1),V=C.context,nt=V.createImageData(E,x);if(D){const s=nt.data;for(let i=0,p=s.length;i<p;i+=4)s[i]=D[0],s[i+1]=D[1],s[i+2]=D[2],s[i+3]=255}for(const s of this._figures)m(nt,s,K);return V.putImageData(nt,2,2),{canvas:C.canvas,offsetX:c-2*et,offsetY:h-2*$,scaleX:et,scaleY:$}}getPattern(y,D,v,o){H(y,this._bbox);let d;if(o===z.SHADING)d=n.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(y));else if(d=n.Util.singularValueDecompose2dScale(D.baseTransform),this.matrix){const c=n.Util.singularValueDecompose2dScale(this.matrix);d=[d[0]*c[0],d[1]*c[1]]}const l=this._createMeshCanvas(d,o===z.SHADING?null:this._background,D.cachedCanvases);return o!==z.SHADING&&(y.setTransform(...D.baseTransform),this.matrix&&y.transform(...this.matrix)),y.translate(l.offsetX,l.offsetY),y.scale(l.scaleX,l.scaleY),y.createPattern(l.canvas,"no-repeat")}}class I extends ut{getPattern(){return"hotpink"}}function _(u){switch(u[0]){case"RadialAxial":return new k(u);case"Mesh":return new B(u);case"Dummy":return new I}throw new Error(`Unknown IR type: ${u[0]}`)}const b={COLORED:1,UNCOLORED:2},g=class g{constructor(y,D,v,o,d){this.operatorList=y[2],this.matrix=y[3]||[1,0,0,1,0,0],this.bbox=y[4],this.xstep=y[5],this.ystep=y[6],this.paintType=y[7],this.tilingType=y[8],this.color=D,this.ctx=v,this.canvasGraphicsFactory=o,this.baseTransform=d}createPatternCanvas(y){const D=this.operatorList,v=this.bbox,o=this.xstep,d=this.ystep,l=this.paintType,c=this.tilingType,h=this.color,O=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+c);const a=v[0],E=v[1],x=v[2],et=v[3],$=n.Util.singularValueDecompose2dScale(this.matrix),K=n.Util.singularValueDecompose2dScale(this.baseTransform),G=[$[0]*K[0],$[1]*K[1]],at=this.getSizeAndScale(o,this.ctx.canvas.width,G[0]),C=this.getSizeAndScale(d,this.ctx.canvas.height,G[1]),V=y.cachedCanvases.getCanvas("pattern",at.size,C.size,!0),nt=V.context,S=O.createCanvasGraphics(nt);S.groupLevel=y.groupLevel,this.setFillAndStrokeStyleToContext(S,l,h);let s=a,i=E,p=x,F=et;return a<0&&(s=0,p+=Math.abs(a)),E<0&&(i=0,F+=Math.abs(E)),nt.translate(-(at.scale*s),-(C.scale*i)),S.transform(at.scale,0,0,C.scale,0,0),nt.save(),this.clipBbox(S,s,i,p,F),S.baseTransform=(0,f.getCurrentTransform)(S.ctx),S.executeOperatorList(D),S.endDrawing(),{canvas:V.canvas,scaleX:at.scale,scaleY:C.scale,offsetX:s,offsetY:i}}getSizeAndScale(y,D,v){y=Math.abs(y);const o=Math.max(g.MAX_PATTERN_SIZE,D);let d=Math.ceil(y*v);return d>=o?d=o:v=d/y,{scale:v,size:d}}clipBbox(y,D,v,o,d){const l=o-D,c=d-v;y.ctx.rect(D,v,l,c),y.current.updateRectMinMax((0,f.getCurrentTransform)(y.ctx),[D,v,o,d]),y.clip(),y.endPath()}setFillAndStrokeStyleToContext(y,D,v){const o=y.ctx,d=y.current;switch(D){case b.COLORED:const l=this.ctx;o.fillStyle=l.fillStyle,o.strokeStyle=l.strokeStyle,d.fillColor=l.fillStyle,d.strokeColor=l.strokeStyle;break;case b.UNCOLORED:const c=n.Util.makeHexColor(v[0],v[1],v[2]);o.fillStyle=c,o.strokeStyle=c,d.fillColor=c,d.strokeColor=c;break;default:throw new n.FormatError(`Unsupported paint type: ${D}`)}}getPattern(y,D,v,o){let d=v;o!==z.SHADING&&(d=n.Util.transform(d,D.baseTransform),this.matrix&&(d=n.Util.transform(d,this.matrix)));const l=this.createPatternCanvas(D);let c=new DOMMatrix(d);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const h=y.createPattern(l.canvas,"repeat");return h.setTransform(c),h}};Jt(g,"MAX_PATTERN_SIZE",3e3);let T=g;e.TilingPattern=T},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=z,e.convertToRGBA=f,e.grayToRGBA=ut;var n=W(1);function f(k){switch(k.kind){case n.ImageKind.GRAYSCALE_1BPP:return z(k);case n.ImageKind.RGB_24BPP:return H(k)}return null}function z({src:k,srcPos:w=0,dest:m,width:B,height:I,nonBlackColor:_=4294967295,inverseDecode:b=!1}){const T=n.FeatureTest.isLittleEndian?4278190080:255,[g,u]=b?[_,T]:[T,_],y=B>>3,D=B&7,v=k.length;m=new Uint32Array(m.buffer);let o=0;for(let d=0;d<I;d++){for(const c=w+y;w<c;w++){const h=w<v?k[w]:255;m[o++]=h&128?u:g,m[o++]=h&64?u:g,m[o++]=h&32?u:g,m[o++]=h&16?u:g,m[o++]=h&8?u:g,m[o++]=h&4?u:g,m[o++]=h&2?u:g,m[o++]=h&1?u:g}if(D===0)continue;const l=w<v?k[w++]:255;for(let c=0;c<D;c++)m[o++]=l&1<<7-c?u:g}return{srcPos:w,destPos:o}}function H({src:k,srcPos:w=0,dest:m,destPos:B=0,width:I,height:_}){let b=0;const T=k.length>>2,g=new Uint32Array(k.buffer,w,T);if(n.FeatureTest.isLittleEndian){for(;b<T-2;b+=3,B+=4){const u=g[b],y=g[b+1],D=g[b+2];m[B]=u|4278190080,m[B+1]=u>>>24|y<<8|4278190080,m[B+2]=y>>>16|D<<16|4278190080,m[B+3]=D>>>8|4278190080}for(let u=b*4,y=k.length;u<y;u+=3)m[B++]=k[u]|k[u+1]<<8|k[u+2]<<16|4278190080}else{for(;b<T-2;b+=3,B+=4){const u=g[b],y=g[b+1],D=g[b+2];m[B]=u|255,m[B+1]=u<<24|y>>>8|255,m[B+2]=y<<16|D>>>16|255,m[B+3]=D<<8|255}for(let u=b*4,y=k.length;u<y;u+=3)m[B++]=k[u]<<24|k[u+1]<<16|k[u+2]<<8|255}return{srcPos:w,destPos:B}}function ut(k,w){if(n.FeatureTest.isLittleEndian)for(let m=0,B=k.length;m<B;m++)w[m]=k[m]*65793|4278190080;else for(let m=0,B=k.length;m<B;m++)w[m]=k[m]*16843008|255}},(U,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const W=Object.create(null);e.GlobalWorkerOptions=W,W.workerPort=null,W.workerSrc=""},(U,e,W)=>{var k,wn,Cn,Te;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=W(1);const f={UNKNOWN:0,DATA:1,ERROR:2},z={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function H(I){switch(I instanceof Error||typeof I=="object"&&I!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),I.name){case"AbortException":return new n.AbortException(I.message);case"MissingPDFException":return new n.MissingPDFException(I.message);case"PasswordException":return new n.PasswordException(I.message,I.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(I.message,I.status);case"UnknownErrorException":return new n.UnknownErrorException(I.message,I.details);default:return new n.UnknownErrorException(I.message,I.toString())}}class ut{constructor(_,b,T){rt(this,k);this.sourceName=_,this.targetName=b,this.comObj=T,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=g=>{const u=g.data;if(u.targetName!==this.sourceName)return;if(u.stream){Y(this,k,Cn).call(this,u);return}if(u.callback){const D=u.callbackId,v=this.callbackCapabilities[D];if(!v)throw new Error(`Cannot resolve callback ${D}`);if(delete this.callbackCapabilities[D],u.callback===f.DATA)v.resolve(u.data);else if(u.callback===f.ERROR)v.reject(H(u.reason));else throw new Error("Unexpected callback case");return}const y=this.actionHandler[u.action];if(!y)throw new Error(`Unknown action from worker: ${u.action}`);if(u.callbackId){const D=this.sourceName,v=u.sourceName;new Promise(function(o){o(y(u.data))}).then(function(o){T.postMessage({sourceName:D,targetName:v,callback:f.DATA,callbackId:u.callbackId,data:o})},function(o){T.postMessage({sourceName:D,targetName:v,callback:f.ERROR,callbackId:u.callbackId,reason:H(o)})});return}if(u.streamId){Y(this,k,wn).call(this,u);return}y(u.data)},T.addEventListener("message",this._onComObjOnMessage)}on(_,b){const T=this.actionHandler;if(T[_])throw new Error(`There is already an actionName called "${_}"`);T[_]=b}send(_,b,T){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,data:b},T)}sendWithPromise(_,b,T){const g=this.callbackId++,u=new n.PromiseCapability;this.callbackCapabilities[g]=u;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,callbackId:g,data:b},T)}catch(y){u.reject(y)}return u.promise}sendWithStream(_,b,T,g){const u=this.streamId++,y=this.sourceName,D=this.targetName,v=this.comObj;return new ReadableStream({start:o=>{const d=new n.PromiseCapability;return this.streamControllers[u]={controller:o,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},v.postMessage({sourceName:y,targetName:D,action:_,streamId:u,data:b,desiredSize:o.desiredSize},g),d.promise},pull:o=>{const d=new n.PromiseCapability;return this.streamControllers[u].pullCall=d,v.postMessage({sourceName:y,targetName:D,stream:z.PULL,streamId:u,desiredSize:o.desiredSize}),d.promise},cancel:o=>{(0,n.assert)(o instanceof Error,"cancel must have a valid reason");const d=new n.PromiseCapability;return this.streamControllers[u].cancelCall=d,this.streamControllers[u].isClosed=!0,v.postMessage({sourceName:y,targetName:D,stream:z.CANCEL,streamId:u,reason:H(o)}),d.promise}},T)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,wn=function(_){const b=_.streamId,T=this.sourceName,g=_.sourceName,u=this.comObj,y=this,D=this.actionHandler[_.action],v={enqueue(o,d=1,l){if(this.isCancelled)return;const c=this.desiredSize;this.desiredSize-=d,c>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),u.postMessage({sourceName:T,targetName:g,stream:z.ENQUEUE,streamId:b,chunk:o},l)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:T,targetName:g,stream:z.CLOSE,streamId:b}),delete y.streamSinks[b])},error(o){(0,n.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,u.postMessage({sourceName:T,targetName:g,stream:z.ERROR,streamId:b,reason:H(o)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:_.desiredSize,ready:null};v.sinkCapability.resolve(),v.ready=v.sinkCapability.promise,this.streamSinks[b]=v,new Promise(function(o){o(D(_.data,v))}).then(function(){u.postMessage({sourceName:T,targetName:g,stream:z.START_COMPLETE,streamId:b,success:!0})},function(o){u.postMessage({sourceName:T,targetName:g,stream:z.START_COMPLETE,streamId:b,reason:H(o)})})},Cn=function(_){const b=_.streamId,T=this.sourceName,g=_.sourceName,u=this.comObj,y=this.streamControllers[b],D=this.streamSinks[b];switch(_.stream){case z.START_COMPLETE:_.success?y.startCall.resolve():y.startCall.reject(H(_.reason));break;case z.PULL_COMPLETE:_.success?y.pullCall.resolve():y.pullCall.reject(H(_.reason));break;case z.PULL:if(!D){u.postMessage({sourceName:T,targetName:g,stream:z.PULL_COMPLETE,streamId:b,success:!0});break}D.desiredSize<=0&&_.desiredSize>0&&D.sinkCapability.resolve(),D.desiredSize=_.desiredSize,new Promise(function(v){var o;v((o=D.onPull)==null?void 0:o.call(D))}).then(function(){u.postMessage({sourceName:T,targetName:g,stream:z.PULL_COMPLETE,streamId:b,success:!0})},function(v){u.postMessage({sourceName:T,targetName:g,stream:z.PULL_COMPLETE,streamId:b,reason:H(v)})});break;case z.ENQUEUE:if((0,n.assert)(y,"enqueue should have stream controller"),y.isClosed)break;y.controller.enqueue(_.chunk);break;case z.CLOSE:if((0,n.assert)(y,"close should have stream controller"),y.isClosed)break;y.isClosed=!0,y.controller.close(),Y(this,k,Te).call(this,y,b);break;case z.ERROR:(0,n.assert)(y,"error should have stream controller"),y.controller.error(H(_.reason)),Y(this,k,Te).call(this,y,b);break;case z.CANCEL_COMPLETE:_.success?y.cancelCall.resolve():y.cancelCall.reject(H(_.reason)),Y(this,k,Te).call(this,y,b);break;case z.CANCEL:if(!D)break;new Promise(function(v){var o;v((o=D.onCancel)==null?void 0:o.call(D,H(_.reason)))}).then(function(){u.postMessage({sourceName:T,targetName:g,stream:z.CANCEL_COMPLETE,streamId:b,success:!0})},function(v){u.postMessage({sourceName:T,targetName:g,stream:z.CANCEL_COMPLETE,streamId:b,reason:H(v)})}),D.sinkCapability.reject(H(_.reason)),D.isCancelled=!0,delete this.streamSinks[b];break;default:throw new Error("Unexpected stream case")}},Te=async function(_,b){var T,g,u;await Promise.allSettled([(T=_.startCall)==null?void 0:T.promise,(g=_.pullCall)==null?void 0:g.promise,(u=_.cancelCall)==null?void 0:u.promise]),delete this.streamControllers[b]},e.MessageHandler=ut},(U,e,W)=>{var z,H;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=W(1);class f{constructor({parsedData:k,rawData:w}){rt(this,z);rt(this,H);lt(this,z,k),lt(this,H,w)}getRaw(){return t(this,H)}get(k){return t(this,z).get(k)??null}getAll(){return(0,n.objectFromMap)(t(this,z))}has(k){return t(this,z).has(k)}}z=new WeakMap,H=new WeakMap,e.Metadata=f},(U,e,W)=>{var k,w,m,B,I,_,Ke;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=W(1),f=W(8);const z=Symbol("INTERNAL");class H{constructor(g,u){rt(this,k,!0);this.name=g,this.intent=u}get visible(){return t(this,k)}_setVisible(g,u){g!==z&&(0,n.unreachable)("Internal method `_setVisible` called."),lt(this,k,u)}}k=new WeakMap;class ut{constructor(g){rt(this,_);rt(this,w,null);rt(this,m,new Map);rt(this,B,null);rt(this,I,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,lt(this,I,g.order);for(const u of g.groups)t(this,m).set(u.id,new H(u.name,u.intent));if(g.baseState==="OFF")for(const u of t(this,m).values())u._setVisible(z,!1);for(const u of g.on)t(this,m).get(u)._setVisible(z,!0);for(const u of g.off)t(this,m).get(u)._setVisible(z,!1);lt(this,B,this.getHash())}}isVisible(g){if(t(this,m).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return t(this,m).has(g.id)?t(this,m).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Y(this,_,Ke).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const u of g.ids){if(!t(this,m).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(t(this,m).get(u).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const u of g.ids){if(!t(this,m).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,m).get(u).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const u of g.ids){if(!t(this,m).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,m).get(u).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const u of g.ids){if(!t(this,m).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(t(this,m).get(u).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,u=!0){if(!t(this,m).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}t(this,m).get(g)._setVisible(z,!!u),lt(this,w,null)}get hasInitialVisibility(){return t(this,B)===null||this.getHash()===t(this,B)}getOrder(){return t(this,m).size?t(this,I)?t(this,I).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}getGroup(g){return t(this,m).get(g)||null}getHash(){if(t(this,w)!==null)return t(this,w);const g=new f.MurmurHash3_64;for(const[u,y]of t(this,m))g.update(`${u}:${y.visible}`);return lt(this,w,g.hexdigest())}}w=new WeakMap,m=new WeakMap,B=new WeakMap,I=new WeakMap,_=new WeakSet,Ke=function(g){const u=g.length;if(u<2)return!0;const y=g[0];for(let D=1;D<u;D++){const v=g[D];let o;if(Array.isArray(v))o=Y(this,_,Ke).call(this,v);else if(t(this,m).has(v))o=t(this,m).get(v).visible;else return(0,n.warn)(`Optional content group not found: ${v}`),!0;switch(y){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return y==="And"},e.OptionalContentConfig=ut},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=W(1),f=W(6);class z{constructor({length:w,initialData:m,progressiveDone:B=!1,contentDispositionFilename:I=null,disableRange:_=!1,disableStream:b=!1},T){if((0,n.assert)(T,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=B,this._contentDispositionFilename=I,(m==null?void 0:m.length)>0){const g=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=T,this._isStreamingSupported=!b,this._isRangeSupported=!_,this._contentLength=w,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,u)=>{this._onReceiveData({begin:g,chunk:u})}),this._pdfDataRangeTransport.addProgressListener((g,u)=>{this._onProgress({loaded:g,total:u})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:w,chunk:m}){const B=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(w===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(B):this._queuedChunks.push(B);else{const I=this._rangeReaders.some(function(_){return _._begin!==w?!1:(_._enqueue(B),!0)});(0,n.assert)(I,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}_onProgress(w){var m,B,I,_;w.total===void 0?(B=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||B.call(m,{loaded:w.loaded}):(_=(I=this._fullRequestReader)==null?void 0:I.onProgress)==null||_.call(I,{loaded:w.loaded,total:w.total})}_onProgressiveDone(){var w;(w=this._fullRequestReader)==null||w.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(w){const m=this._rangeReaders.indexOf(w);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const w=this._queuedChunks;return this._queuedChunks=null,new H(this,w,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(w,m){if(m<=this._progressiveDataLength)return null;const B=new ut(this,w,m);return this._pdfDataRangeTransport.requestDataRange(w,m),this._rangeReaders.push(B),B}cancelAllRequests(w){var m;(m=this._fullRequestReader)==null||m.cancel(w);for(const B of this._rangeReaders.slice(0))B.cancel(w);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=z;class H{constructor(w,m,B=!1,I=null){this._stream=w,this._done=B||!1,this._filename=(0,f.isPdfFile)(I)?I:null,this._queuedChunks=m||[],this._loaded=0;for(const _ of this._queuedChunks)this._loaded+=_.byteLength;this._requests=[],this._headersReady=Promise.resolve(),w._fullRequestReader=this,this.onProgress=null}_enqueue(w){this._done||(this._requests.length>0?this._requests.shift().resolve({value:w,done:!1}):this._queuedChunks.push(w),this._loaded+=w.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const w=new n.PromiseCapability;return this._requests.push(w),w.promise}cancel(w){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ut{constructor(w,m,B){this._stream=w,this._begin=m,this._end=B,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(w){if(!this._done){if(this._requests.length===0)this._queuedChunk=w;else{this._requests.shift().resolve({value:w,done:!1});for(const B of this._requests)B.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const w=new n.PromiseCapability;return this._requests.push(w),w.promise}cancel(w){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=W(1),f=W(20);function z(B,I,_){return{method:"GET",headers:B,signal:_.signal,mode:"cors",credentials:I?"include":"same-origin",redirect:"follow"}}function H(B){const I=new Headers;for(const _ in B){const b=B[_];b!==void 0&&I.append(_,b)}return I}function ut(B){return B instanceof Uint8Array?B.buffer:B instanceof ArrayBuffer?B:((0,n.warn)(`getArrayBuffer - unexpected data format: ${B}`),new Uint8Array(B).buffer)}class k{constructor(I){this.source=I,this.isHttp=/^https?:/i.test(I.url),this.httpHeaders=this.isHttp&&I.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new w(this),this._fullRequestReader}getRangeReader(I,_){if(_<=this._progressiveDataLength)return null;const b=new m(this,I,_);return this._rangeRequestReaders.push(b),b}cancelAllRequests(I){var _;(_=this._fullRequestReader)==null||_.cancel(I);for(const b of this._rangeRequestReaders.slice(0))b.cancel(I)}}e.PDFFetchStream=k;class w{constructor(I){this._stream=I,this._reader=null,this._loaded=0,this._filename=null;const _=I.source;this._withCredentials=_.withCredentials||!1,this._contentLength=_.length,this._headersCapability=new n.PromiseCapability,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._headers=H(this._stream.httpHeaders);const b=_.url;fetch(b,z(this._headers,this._withCredentials,this._abortController)).then(T=>{if(!(0,f.validateResponseStatus)(T.status))throw(0,f.createResponseStatusError)(T.status,b);this._reader=T.body.getReader(),this._headersCapability.resolve();const g=D=>T.headers.get(D),{allowRangeRequests:u,suggestedLength:y}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=y||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._headersCapability.promise;const{value:I,done:_}=await this._reader.read();return _?{value:I,done:_}:(this._loaded+=I.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ut(I),done:!1})}cancel(I){var _;(_=this._reader)==null||_.cancel(I),this._abortController.abort()}}class m{constructor(I,_,b){this._stream=I,this._reader=null,this._loaded=0;const T=I.source;this._withCredentials=T.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!T.disableStream,this._abortController=new AbortController,this._headers=H(this._stream.httpHeaders),this._headers.append("Range",`bytes=${_}-${b-1}`);const g=T.url;fetch(g,z(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,f.validateResponseStatus)(u.status))throw(0,f.createResponseStatusError)(u.status,g);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._readCapability.promise;const{value:I,done:_}=await this._reader.read();return _?{value:I,done:_}:(this._loaded+=I.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded}),{value:ut(I),done:!1})}cancel(I){var _;(_=this._reader)==null||_.cancel(I),this._abortController.abort()}}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=k,e.extractFilenameFromHeader=ut,e.validateRangeRequestCapabilities=H,e.validateResponseStatus=w;var n=W(1),f=W(21),z=W(6);function H({getResponseHeader:m,isHttp:B,rangeChunkSize:I,disableRange:_}){const b={allowRangeRequests:!1,suggestedLength:void 0},T=parseInt(m("Content-Length"),10);return!Number.isInteger(T)||(b.suggestedLength=T,T<=2*I)||_||!B||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(b.allowRangeRequests=!0),b}function ut(m){const B=m("Content-Disposition");if(B){let I=(0,f.getFilenameFromContentDispositionHeader)(B);if(I.includes("%"))try{I=decodeURIComponent(I)}catch{}if((0,z.isPdfFile)(I))return I}return null}function k(m,B){return m===404||m===0&&B.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+B+'".'):new n.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${B}".`,m)}function w(m){return m===200||m===206}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=f;var n=W(1);function f(z){let H=!0,ut=k("filename\\*","i").exec(z);if(ut){ut=ut[1];let T=I(ut);return T=unescape(T),T=_(T),T=b(T),m(T)}if(ut=B(z),ut){const T=b(ut);return m(T)}if(ut=k("filename","i").exec(z),ut){ut=ut[1];let T=I(ut);return T=b(T),m(T)}function k(T,g){return new RegExp("(?:^|;)\\s*"+T+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function w(T,g){if(T){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const u=new TextDecoder(T,{fatal:!0}),y=(0,n.stringToBytes)(g);g=u.decode(y),H=!1}catch{}}return g}function m(T){return H&&/[\x80-\xff]/.test(T)&&(T=w("utf-8",T),H&&(T=w("iso-8859-1",T))),T}function B(T){const g=[];let u;const y=k("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=y.exec(T))!==null;){let[,v,o,d]=u;if(v=parseInt(v,10),v in g){if(v===0)break;continue}g[v]=[o,d]}const D=[];for(let v=0;v<g.length&&v in g;++v){let[o,d]=g[v];d=I(d),o&&(d=unescape(d),v===0&&(d=_(d))),D.push(d)}return D.join("")}function I(T){if(T.startsWith('"')){const g=T.slice(1).split('\\"');for(let u=0;u<g.length;++u){const y=g[u].indexOf('"');y!==-1&&(g[u]=g[u].slice(0,y),g.length=u+1),g[u]=g[u].replaceAll(/\\(.)/g,"$1")}T=g.join('"')}return T}function _(T){const g=T.indexOf("'");if(g===-1)return T;const u=T.slice(0,g),D=T.slice(g+1).replace(/^[^']*'/,"");return w(u,D)}function b(T){return!T.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(T)?T:T.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,u,y,D){if(y==="q"||y==="Q")return D=D.replaceAll("_"," "),D=D.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,o){return String.fromCharCode(parseInt(o,16))}),w(u,D);try{D=atob(D)}catch{}return w(u,D)})}return""}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=W(1),f=W(20);const z=200,H=206;function ut(I){const _=I.response;return typeof _!="string"?_:(0,n.stringToBytes)(_).buffer}class k{constructor(_,b={}){this.url=_,this.isHttp=/^https?:/i.test(_),this.httpHeaders=this.isHttp&&b.httpHeaders||Object.create(null),this.withCredentials=b.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(_,b,T){const g={begin:_,end:b};for(const u in T)g[u]=T[u];return this.request(g)}requestFull(_){return this.request(_)}request(_){const b=new XMLHttpRequest,T=this.currXhrId++,g=this.pendingRequests[T]={xhr:b};b.open("GET",this.url),b.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const y=this.httpHeaders[u];y!==void 0&&b.setRequestHeader(u,y)}return this.isHttp&&"begin"in _&&"end"in _?(b.setRequestHeader("Range",`bytes=${_.begin}-${_.end-1}`),g.expectedStatus=H):g.expectedStatus=z,b.responseType="arraybuffer",_.onError&&(b.onerror=function(u){_.onError(b.status)}),b.onreadystatechange=this.onStateChange.bind(this,T),b.onprogress=this.onProgress.bind(this,T),g.onHeadersReceived=_.onHeadersReceived,g.onDone=_.onDone,g.onError=_.onError,g.onProgress=_.onProgress,b.send(null),T}onProgress(_,b){var g;const T=this.pendingRequests[_];T&&((g=T.onProgress)==null||g.call(T,b))}onStateChange(_,b){var v,o,d;const T=this.pendingRequests[_];if(!T)return;const g=T.xhr;if(g.readyState>=2&&T.onHeadersReceived&&(T.onHeadersReceived(),delete T.onHeadersReceived),g.readyState!==4||!(_ in this.pendingRequests))return;if(delete this.pendingRequests[_],g.status===0&&this.isHttp){(v=T.onError)==null||v.call(T,g.status);return}const u=g.status||z;if(!(u===z&&T.expectedStatus===H)&&u!==T.expectedStatus){(o=T.onError)==null||o.call(T,g.status);return}const D=ut(g);if(u===H){const l=g.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);T.onDone({begin:parseInt(c[1],10),chunk:D})}else D?T.onDone({begin:0,chunk:D}):(d=T.onError)==null||d.call(T,g.status)}getRequestXhr(_){return this.pendingRequests[_].xhr}isPendingRequest(_){return _ in this.pendingRequests}abortRequest(_){const b=this.pendingRequests[_].xhr;delete this.pendingRequests[_],b.abort()}}class w{constructor(_){this._source=_,this._manager=new k(_.url,{httpHeaders:_.httpHeaders,withCredentials:_.withCredentials}),this._rangeChunkSize=_.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(_){const b=this._rangeRequestReaders.indexOf(_);b>=0&&this._rangeRequestReaders.splice(b,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(_,b){const T=new B(this._manager,_,b);return T.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(T),T}cancelAllRequests(_){var b;(b=this._fullRequestReader)==null||b.cancel(_);for(const T of this._rangeRequestReaders.slice(0))T.cancel(_)}}e.PDFNetworkStream=w;class m{constructor(_,b){this._manager=_;const T={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._fullRequestId=_.requestFull(T),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=b.disableRange||!1,this._contentLength=b.length,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const _=this._fullRequestId,b=this._manager.getRequestXhr(_),T=y=>b.getResponseHeader(y),{allowRangeRequests:g,suggestedLength:u}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:T,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(T),this._isRangeSupported&&this._manager.abortRequest(_),this._headersReceivedCapability.resolve()}_onDone(_){if(_&&(this._requests.length>0?this._requests.shift().resolve({value:_.chunk,done:!1}):this._cachedChunks.push(_.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(_){this._storedError=(0,f.createResponseStatusError)(_,this._url),this._headersReceivedCapability.reject(this._storedError);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(_){var b;(b=this.onProgress)==null||b.call(this,{loaded:_.loaded,total:_.lengthComputable?_.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=new n.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0,this._headersReceivedCapability.reject(_);for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class B{constructor(_,b,T){this._manager=_;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._requestId=_.requestRange(b,T,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var _;(_=this.onClosed)==null||_.call(this,this)}_onDone(_){const b=_.chunk;this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunk=b,this._done=!0;for(const T of this._requests)T.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(_){this._storedError=(0,f.createResponseStatusError)(_,this._url);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(_){var b;this.isStreamingSupported||(b=this.onProgress)==null||b.call(this,{loaded:_.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const _=new n.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=W(1),f=W(20);const z=/^file:\/\/\/[a-zA-Z]:\//;function H(T){const g=require$$5,u=g.parse(T);return u.protocol==="file:"||u.host?u:/^[a-z]:[/\\]/i.test(T)?g.parse(`file:///${T}`):(u.host||(u.protocol="file:"),u)}class ut{constructor(g){this.source=g,this.url=H(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new _(this):new B(this),this._fullRequestReader}getRangeReader(g,u){if(u<=this._progressiveDataLength)return null;const y=this.isFsUrl?new b(this,g,u):new I(this,g,u);return this._rangeRequestReaders.push(y),y}cancelAllRequests(g){var u;(u=this._fullRequestReader)==null||u.cancel(g);for(const y of this._rangeRequestReaders.slice(0))y.cancel(g)}}e.PDFNodeStream=ut;class k{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=g.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class w{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const u=g.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(T,g){return{protocol:T.protocol,auth:T.auth,host:T.hostname,port:T.port,path:T.path,method:"GET",headers:g}}class B extends k{constructor(g){super(g);const u=y=>{if(y.statusCode===404){const d=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=d,this._headersCapability.reject(d);return}this._headersCapability.resolve(),this._setReadableStream(y);const D=d=>this._readableStream.headers[d.toLowerCase()],{allowRangeRequests:v,suggestedLength:o}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:D,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=o||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(D)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(m(this._url,g.httpHeaders),u)}else{const y=require$$5;this._request=y.request(m(this._url,g.httpHeaders),u)}this._request.on("error",y=>{this._storedError=y,this._headersCapability.reject(y)}),this._request.end()}}class I extends w{constructor(g,u,y){super(g),this._httpHeaders={};for(const v in g.httpHeaders){const o=g.httpHeaders[v];o!==void 0&&(this._httpHeaders[v]=o)}this._httpHeaders.Range=`bytes=${u}-${y-1}`;const D=v=>{if(v.statusCode===404){const o=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(v)};if(this._request=null,this._url.protocol==="http:"){const v=require$$5;this._request=v.request(m(this._url,this._httpHeaders),D)}else{const v=require$$5;this._request=v.request(m(this._url,this._httpHeaders),D)}this._request.on("error",v=>{this._storedError=v}),this._request.end()}}class _ extends k{constructor(g){super(g);let u=decodeURIComponent(this._url.path);z.test(this._url.href)&&(u=u.replace(/^\//,""));const y=require$$5;y.lstat(u,(D,v)=>{if(D){D.code==="ENOENT"&&(D=new n.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=D,this._headersCapability.reject(D);return}this._contentLength=v.size,this._setReadableStream(y.createReadStream(u)),this._headersCapability.resolve()})}}class b extends w{constructor(g,u,y){super(g);let D=decodeURIComponent(this._url.path);z.test(this._url.href)&&(D=D.replace(/^\//,""));const v=require$$5;this._setReadableStream(v.createReadStream(D,{start:u,end:y-1}))}}},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=W(6),f=W(1);const z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},H="http://www.w3.org/XML/1998/namespace",ut="http://www.w3.org/1999/xlink",k=["butt","round","square"],w=["miter","round","bevel"],m=function(v,o="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([v],{type:o}));const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let c=`data:${o};base64,`;for(let h=0,O=v.length;h<O;h+=3){const a=v[h]&255,E=v[h+1]&255,x=v[h+2]&255,et=a>>2,$=(a&3)<<4|E>>4,K=h+1<O?(E&15)<<2|x>>6:64,G=h+2<O?x&63:64;c+=l[et]+l[$]+l[K]+l[G]}return c},B=function(){const v=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,d=new Int32Array(256);for(let x=0;x<256;x++){let et=x;for(let $=0;$<8;$++)et=et&1?3988292384^et>>1&2147483647:et>>1&2147483647;d[x]=et}function l(x,et,$){let K=-1;for(let G=et;G<$;G++){const at=(K^x[G])&255,C=d[at];K=K>>>8^C}return K^-1}function c(x,et,$,K){let G=K;const at=et.length;$[G]=at>>24&255,$[G+1]=at>>16&255,$[G+2]=at>>8&255,$[G+3]=at&255,G+=4,$[G]=x.charCodeAt(0)&255,$[G+1]=x.charCodeAt(1)&255,$[G+2]=x.charCodeAt(2)&255,$[G+3]=x.charCodeAt(3)&255,G+=4,$.set(et,G),G+=et.length;const C=l($,K+4,G);$[G]=C>>24&255,$[G+1]=C>>16&255,$[G+2]=C>>8&255,$[G+3]=C&255}function h(x,et,$){let K=1,G=0;for(let at=et;at<$;++at)K=(K+(x[at]&255))%65521,G=(G+K)%65521;return G<<16|K}function O(x){if(!f.isNodeJS)return a(x);try{const et=parseInt(process.versions.node)>=8?x:Buffer.from(x),$=require$$5.deflateSync(et,{level:9});return $ instanceof Uint8Array?$:new Uint8Array($)}catch(et){(0,f.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+et)}return a(x)}function a(x){let et=x.length;const $=65535,K=Math.ceil(et/$),G=new Uint8Array(2+et+K*5+4);let at=0;G[at++]=120,G[at++]=156;let C=0;for(;et>$;)G[at++]=0,G[at++]=255,G[at++]=255,G[at++]=0,G[at++]=0,G.set(x.subarray(C,C+$),at),at+=$,C+=$,et-=$;G[at++]=1,G[at++]=et&255,G[at++]=et>>8&255,G[at++]=~et&65535&255,G[at++]=(~et&65535)>>8&255,G.set(x.subarray(C),at),at+=x.length-C;const V=h(x,0,x.length);return G[at++]=V>>24&255,G[at++]=V>>16&255,G[at++]=V>>8&255,G[at++]=V&255,G}function E(x,et,$,K){const G=x.width,at=x.height;let C,V,nt;const S=x.data;switch(et){case f.ImageKind.GRAYSCALE_1BPP:V=0,C=1,nt=G+7>>3;break;case f.ImageKind.RGB_24BPP:V=2,C=8,nt=G*3;break;case f.ImageKind.RGBA_32BPP:V=6,C=8,nt=G*4;break;default:throw new Error("invalid format")}const s=new Uint8Array((1+nt)*at);let i=0,p=0;for(let ht=0;ht<at;++ht)s[i++]=0,s.set(S.subarray(p,p+nt),i),p+=nt,i+=nt;if(et===f.ImageKind.GRAYSCALE_1BPP&&K){i=0;for(let ht=0;ht<at;ht++){i++;for(let gt=0;gt<nt;gt++)s[i++]^=255}}const F=new Uint8Array([G>>24&255,G>>16&255,G>>8&255,G&255,at>>24&255,at>>16&255,at>>8&255,at&255,C,V,0,0,0]),M=O(s),L=v.length+o*3+F.length+M.length,q=new Uint8Array(L);let st=0;return q.set(v,st),st+=v.length,c("IHDR",F,q,st),st+=o+F.length,c("IDATA",M,q,st),st+=o+M.length,c("IEND",new Uint8Array(0),q,st),m(q,"image/png",$)}return function(et,$,K){const G=et.kind===void 0?f.ImageKind.GRAYSCALE_1BPP:et.kind;return E(et,G,$,K)}}();class I{constructor(){this.fontSizeScale=1,this.fontWeight=z.fontWeight,this.fontSize=0,this.textMatrix=f.IDENTITY_MATRIX,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=f.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,d){this.x=o,this.y=d}}function _(v){let o=[];const d=[];for(const l of v){if(l.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),d.push(o),o=o.at(-1).items;continue}l.fn==="restore"?o=d.pop():o.push(l)}return o}function b(v){if(Number.isInteger(v))return v.toString();const o=v.toFixed(10);let d=o.length-1;if(o[d]!=="0")return o;do d--;while(o[d]==="0");return o.substring(0,o[d]==="."?d:d+1)}function T(v){if(v[4]===0&&v[5]===0){if(v[1]===0&&v[2]===0)return v[0]===1&&v[3]===1?"":`scale(${b(v[0])} ${b(v[3])})`;if(v[0]===v[3]&&v[1]===-v[2]){const o=Math.acos(v[0])*180/Math.PI;return`rotate(${b(o)})`}}else if(v[0]===1&&v[1]===0&&v[2]===0&&v[3]===1)return`translate(${b(v[4])} ${b(v[5])})`;return`matrix(${b(v[0])} ${b(v[1])} ${b(v[2])} ${b(v[3])} ${b(v[4])} ${b(v[5])})`}let g=0,u=0,y=0;class D{constructor(o,d,l=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new I,this.transformMatrix=f.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=o,this.objs=d,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!l,this._operatorIdMapping=[];for(const c in f.OPS)this._operatorIdMapping[f.OPS[c]]=c}getObject(o,d=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):d}save(){this.transformStack.push(this.transformMatrix);const o=this.current;this.extraStack.push(o),this.current=o.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(o){this.save(),this.executeOpTree(o),this.restore()}loadDependencies(o){const d=o.fnArray,l=o.argsArray;for(let c=0,h=d.length;c<h;c++)if(d[c]===f.OPS.dependency)for(const O of l[c]){const a=O.startsWith("g_")?this.commonObjs:this.objs,E=new Promise(x=>{a.get(O,x)});this.current.dependencies.push(E)}return Promise.all(this.current.dependencies)}transform(o,d,l,c,h,O){const a=[o,d,l,c,h,O];this.transformMatrix=f.Util.transform(this.transformMatrix,a),this.tgrp=null}getSVG(o,d){this.viewport=d;const l=this._initialize(d);return this.loadDependencies(o).then(()=>(this.transformMatrix=f.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(o)),l))}convertOpList(o){const d=this._operatorIdMapping,l=o.argsArray,c=o.fnArray,h=[];for(let O=0,a=c.length;O<a;O++){const E=c[O];h.push({fnId:E,fn:d[E],args:l[O]})}return _(h)}executeOpTree(o){for(const d of o){const l=d.fn,c=d.fnId,h=d.args;switch(c|0){case f.OPS.beginText:this.beginText();break;case f.OPS.dependency:break;case f.OPS.setLeading:this.setLeading(h);break;case f.OPS.setLeadingMoveText:this.setLeadingMoveText(h[0],h[1]);break;case f.OPS.setFont:this.setFont(h);break;case f.OPS.showText:this.showText(h[0]);break;case f.OPS.showSpacedText:this.showText(h[0]);break;case f.OPS.endText:this.endText();break;case f.OPS.moveText:this.moveText(h[0],h[1]);break;case f.OPS.setCharSpacing:this.setCharSpacing(h[0]);break;case f.OPS.setWordSpacing:this.setWordSpacing(h[0]);break;case f.OPS.setHScale:this.setHScale(h[0]);break;case f.OPS.setTextMatrix:this.setTextMatrix(h[0],h[1],h[2],h[3],h[4],h[5]);break;case f.OPS.setTextRise:this.setTextRise(h[0]);break;case f.OPS.setTextRenderingMode:this.setTextRenderingMode(h[0]);break;case f.OPS.setLineWidth:this.setLineWidth(h[0]);break;case f.OPS.setLineJoin:this.setLineJoin(h[0]);break;case f.OPS.setLineCap:this.setLineCap(h[0]);break;case f.OPS.setMiterLimit:this.setMiterLimit(h[0]);break;case f.OPS.setFillRGBColor:this.setFillRGBColor(h[0],h[1],h[2]);break;case f.OPS.setStrokeRGBColor:this.setStrokeRGBColor(h[0],h[1],h[2]);break;case f.OPS.setStrokeColorN:this.setStrokeColorN(h);break;case f.OPS.setFillColorN:this.setFillColorN(h);break;case f.OPS.shadingFill:this.shadingFill(h[0]);break;case f.OPS.setDash:this.setDash(h[0],h[1]);break;case f.OPS.setRenderingIntent:this.setRenderingIntent(h[0]);break;case f.OPS.setFlatness:this.setFlatness(h[0]);break;case f.OPS.setGState:this.setGState(h[0]);break;case f.OPS.fill:this.fill();break;case f.OPS.eoFill:this.eoFill();break;case f.OPS.stroke:this.stroke();break;case f.OPS.fillStroke:this.fillStroke();break;case f.OPS.eoFillStroke:this.eoFillStroke();break;case f.OPS.clip:this.clip("nonzero");break;case f.OPS.eoClip:this.clip("evenodd");break;case f.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case f.OPS.paintImageXObject:this.paintImageXObject(h[0]);break;case f.OPS.paintInlineImageXObject:this.paintInlineImageXObject(h[0]);break;case f.OPS.paintImageMaskXObject:this.paintImageMaskXObject(h[0]);break;case f.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(h[0],h[1]);break;case f.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case f.OPS.closePath:this.closePath();break;case f.OPS.closeStroke:this.closeStroke();break;case f.OPS.closeFillStroke:this.closeFillStroke();break;case f.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case f.OPS.nextLine:this.nextLine();break;case f.OPS.transform:this.transform(h[0],h[1],h[2],h[3],h[4],h[5]);break;case f.OPS.constructPath:this.constructPath(h[0],h[1]);break;case f.OPS.endPath:this.endPath();break;case 92:this.group(d.items);break;default:(0,f.warn)(`Unimplemented operator ${l}`);break}}}setWordSpacing(o){this.current.wordSpacing=o}setCharSpacing(o){this.current.charSpacing=o}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(o,d,l,c,h,O){const a=this.current;a.textMatrix=a.lineMatrix=[o,d,l,c,h,O],a.textMatrixScale=Math.hypot(o,d),a.x=a.lineX=0,a.y=a.lineY=0,a.xcoords=[],a.ycoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${b(a.fontSize)}px`),a.tspan.setAttributeNS(null,"y",b(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.append(a.tspan)}beginText(){const o=this.current;o.x=o.lineX=0,o.y=o.lineY=0,o.textMatrix=f.IDENTITY_MATRIX,o.lineMatrix=f.IDENTITY_MATRIX,o.textMatrixScale=1,o.tspan=this.svgFactory.createElement("svg:tspan"),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtgrp=this.svgFactory.createElement("svg:g"),o.xcoords=[],o.ycoords=[]}moveText(o,d){const l=this.current;l.x=l.lineX+=o,l.y=l.lineY+=d,l.xcoords=[],l.ycoords=[],l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${b(l.fontSize)}px`),l.tspan.setAttributeNS(null,"y",b(-l.y))}showText(o){const d=this.current,l=d.font,c=d.fontSize;if(c===0)return;const h=d.fontSizeScale,O=d.charSpacing,a=d.wordSpacing,E=d.fontDirection,x=d.textHScale*E,et=l.vertical,$=et?1:-1,K=l.defaultVMetrics,G=c*d.fontMatrix[0];let at=0;for(const nt of o){if(nt===null){at+=E*a;continue}else if(typeof nt=="number"){at+=$*nt*c/1e3;continue}const S=(nt.isSpace?a:0)+O,s=nt.fontChar;let i,p,F=nt.width;if(et){let L;const q=nt.vmetric||K;L=nt.vmetric?q[1]:F*.5,L=-L*G;const st=q[2]*G;F=q?-q[0]:F,i=L/h,p=(at+st)/h}else i=at/h,p=0;(nt.isInFont||l.missingFile)&&(d.xcoords.push(d.x+i),et&&d.ycoords.push(-d.y+p),d.tspan.textContent+=s);const M=et?F*G-S*E:F*G+S*E;at+=M}d.tspan.setAttributeNS(null,"x",d.xcoords.map(b).join(" ")),et?d.tspan.setAttributeNS(null,"y",d.ycoords.map(b).join(" ")):d.tspan.setAttributeNS(null,"y",b(-d.y)),et?d.y-=at:d.x+=at*x,d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${b(d.fontSize)}px`),d.fontStyle!==z.fontStyle&&d.tspan.setAttributeNS(null,"font-style",d.fontStyle),d.fontWeight!==z.fontWeight&&d.tspan.setAttributeNS(null,"font-weight",d.fontWeight);const C=d.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;if(C===f.TextRenderingMode.FILL||C===f.TextRenderingMode.FILL_STROKE?(d.fillColor!==z.fillColor&&d.tspan.setAttributeNS(null,"fill",d.fillColor),d.fillAlpha<1&&d.tspan.setAttributeNS(null,"fill-opacity",d.fillAlpha)):d.textRenderingMode===f.TextRenderingMode.ADD_TO_PATH?d.tspan.setAttributeNS(null,"fill","transparent"):d.tspan.setAttributeNS(null,"fill","none"),C===f.TextRenderingMode.STROKE||C===f.TextRenderingMode.FILL_STROKE){const nt=1/(d.textMatrixScale||1);this._setStrokeAttributes(d.tspan,nt)}let V=d.textMatrix;d.textRise!==0&&(V=V.slice(),V[5]+=d.textRise),d.txtElement.setAttributeNS(null,"transform",`${T(V)} scale(${b(x)}, -1)`),d.txtElement.setAttributeNS(H,"xml:space","preserve"),d.txtElement.append(d.tspan),d.txtgrp.append(d.txtElement),this._ensureTransformGroup().append(d.txtElement)}setLeadingMoveText(o,d){this.setLeading(-d),this.moveText(o,d)}addFontStyle(o){if(!o.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const d=m(o.data,o.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${o.loadedName}"; src: url(${d}); }
`}setFont(o){const d=this.current,l=this.commonObjs.get(o[0]);let c=o[1];d.font=l,this.embedFonts&&!l.missingFile&&!this.embeddedFonts[l.loadedName]&&(this.addFontStyle(l),this.embeddedFonts[l.loadedName]=l),d.fontMatrix=l.fontMatrix||f.FONT_IDENTITY_MATRIX;let h="normal";l.black?h="900":l.bold&&(h="bold");const O=l.italic?"italic":"normal";c<0?(c=-c,d.fontDirection=-1):d.fontDirection=1,d.fontSize=c,d.fontFamily=l.loadedName,d.fontWeight=h,d.fontStyle=O,d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"y",b(-d.y)),d.xcoords=[],d.ycoords=[]}endText(){var d;const o=this.current;o.textRenderingMode&f.TextRenderingMode.ADD_TO_PATH_FLAG&&((d=o.txtElement)!=null&&d.hasChildNodes())&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(o){o>0&&(this.current.lineWidth=o)}setLineCap(o){this.current.lineCap=k[o]}setLineJoin(o){this.current.lineJoin=w[o]}setMiterLimit(o){this.current.miterLimit=o}setStrokeAlpha(o){this.current.strokeAlpha=o}setStrokeRGBColor(o,d,l){this.current.strokeColor=f.Util.makeHexColor(o,d,l)}setFillAlpha(o){this.current.fillAlpha=o}setFillRGBColor(o,d,l){this.current.fillColor=f.Util.makeHexColor(o,d,l),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(o){this.current.strokeColor=this._makeColorN_Pattern(o)}setFillColorN(o){this.current.fillColor=this._makeColorN_Pattern(o)}shadingFill(o){const{width:d,height:l}=this.viewport,c=f.Util.inverseTransform(this.transformMatrix),[h,O,a,E]=f.Util.getAxialAlignedBoundingBox([0,0,d,l],c),x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",h),x.setAttributeNS(null,"y",O),x.setAttributeNS(null,"width",a-h),x.setAttributeNS(null,"height",E-O),x.setAttributeNS(null,"fill",this._makeShadingPattern(o)),this.current.fillAlpha<1&&x.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(x)}_makeColorN_Pattern(o){return o[0]==="TilingPattern"?this._makeTilingPattern(o):this._makeShadingPattern(o)}_makeTilingPattern(o){const d=o[1],l=o[2],c=o[3]||f.IDENTITY_MATRIX,[h,O,a,E]=o[4],x=o[5],et=o[6],$=o[7],K=`shading${y++}`,[G,at,C,V]=f.Util.normalizeRect([...f.Util.applyTransform([h,O],c),...f.Util.applyTransform([a,E],c)]),[nt,S]=f.Util.singularValueDecompose2dScale(c),s=x*nt,i=et*S,p=this.svgFactory.createElement("svg:pattern");p.setAttributeNS(null,"id",K),p.setAttributeNS(null,"patternUnits","userSpaceOnUse"),p.setAttributeNS(null,"width",s),p.setAttributeNS(null,"height",i),p.setAttributeNS(null,"x",`${G}`),p.setAttributeNS(null,"y",`${at}`);const F=this.svg,M=this.transformMatrix,L=this.current.fillColor,q=this.current.strokeColor,st=this.svgFactory.create(C-G,V-at);if(this.svg=st,this.transformMatrix=c,$===2){const ht=f.Util.makeHexColor(...d);this.current.fillColor=ht,this.current.strokeColor=ht}return this.executeOpTree(this.convertOpList(l)),this.svg=F,this.transformMatrix=M,this.current.fillColor=L,this.current.strokeColor=q,p.append(st.childNodes[0]),this.defs.append(p),`url(#${K})`}_makeShadingPattern(o){switch(typeof o=="string"&&(o=this.objs.get(o)),o[0]){case"RadialAxial":const d=`shading${y++}`,l=o[3];let c;switch(o[1]){case"axial":const h=o[4],O=o[5];c=this.svgFactory.createElement("svg:linearGradient"),c.setAttributeNS(null,"id",d),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"x1",h[0]),c.setAttributeNS(null,"y1",h[1]),c.setAttributeNS(null,"x2",O[0]),c.setAttributeNS(null,"y2",O[1]);break;case"radial":const a=o[4],E=o[5],x=o[6],et=o[7];c=this.svgFactory.createElement("svg:radialGradient"),c.setAttributeNS(null,"id",d),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"cx",E[0]),c.setAttributeNS(null,"cy",E[1]),c.setAttributeNS(null,"r",et),c.setAttributeNS(null,"fx",a[0]),c.setAttributeNS(null,"fy",a[1]),c.setAttributeNS(null,"fr",x);break;default:throw new Error(`Unknown RadialAxial type: ${o[1]}`)}for(const h of l){const O=this.svgFactory.createElement("svg:stop");O.setAttributeNS(null,"offset",h[0]),O.setAttributeNS(null,"stop-color",h[1]),c.append(O)}return this.defs.append(c),`url(#${d})`;case"Mesh":return(0,f.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${o[0]}`)}}setDash(o,d){this.current.dashArray=o,this.current.dashPhase=d}constructPath(o,d){const l=this.current;let c=l.x,h=l.y,O=[],a=0;for(const E of o)switch(E|0){case f.OPS.rectangle:c=d[a++],h=d[a++];const x=d[a++],et=d[a++],$=c+x,K=h+et;O.push("M",b(c),b(h),"L",b($),b(h),"L",b($),b(K),"L",b(c),b(K),"Z");break;case f.OPS.moveTo:c=d[a++],h=d[a++],O.push("M",b(c),b(h));break;case f.OPS.lineTo:c=d[a++],h=d[a++],O.push("L",b(c),b(h));break;case f.OPS.curveTo:c=d[a+4],h=d[a+5],O.push("C",b(d[a]),b(d[a+1]),b(d[a+2]),b(d[a+3]),b(c),b(h)),a+=6;break;case f.OPS.curveTo2:O.push("C",b(c),b(h),b(d[a]),b(d[a+1]),b(d[a+2]),b(d[a+3])),c=d[a+2],h=d[a+3],a+=4;break;case f.OPS.curveTo3:c=d[a+2],h=d[a+3],O.push("C",b(d[a]),b(d[a+1]),b(c),b(h),b(c),b(h)),a+=4;break;case f.OPS.closePath:O.push("Z");break}O=O.join(" "),l.path&&o.length>0&&o[0]!==f.OPS.rectangle&&o[0]!==f.OPS.moveTo?O=l.path.getAttributeNS(null,"d")+O:(l.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(l.path)),l.path.setAttributeNS(null,"d",O),l.path.setAttributeNS(null,"fill","none"),l.element=l.path,l.setCurrentPoint(c,h)}endPath(){const o=this.current;if(o.path=null,!this.pendingClip)return;if(!o.element){this.pendingClip=null;return}const d=`clippath${g++}`,l=this.svgFactory.createElement("svg:clipPath");l.setAttributeNS(null,"id",d),l.setAttributeNS(null,"transform",T(this.transformMatrix));const c=o.element.cloneNode(!0);if(this.pendingClip==="evenodd"?c.setAttributeNS(null,"clip-rule","evenodd"):c.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,l.append(c),this.defs.append(l),o.activeClipUrl){o.clipGroup=null;for(const h of this.extraStack)h.clipGroup=null;l.setAttributeNS(null,"clip-path",o.activeClipUrl)}o.activeClipUrl=`url(#${d})`,this.tgrp=null}clip(o){this.pendingClip=o}closePath(){const o=this.current;if(o.path){const d=`${o.path.getAttributeNS(null,"d")}Z`;o.path.setAttributeNS(null,"d",d)}}setLeading(o){this.current.leading=-o}setTextRise(o){this.current.textRise=o}setTextRenderingMode(o){this.current.textRenderingMode=o}setHScale(o){this.current.textHScale=o/100}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[d,l]of o)switch(d){case"LW":this.setLineWidth(l);break;case"LC":this.setLineCap(l);break;case"LJ":this.setLineJoin(l);break;case"ML":this.setMiterLimit(l);break;case"D":this.setDash(l[0],l[1]);break;case"RI":this.setRenderingIntent(l);break;case"FL":this.setFlatness(l);break;case"Font":this.setFont(l);break;case"CA":this.setStrokeAlpha(l);break;case"ca":this.setFillAlpha(l);break;default:(0,f.warn)(`Unimplemented graphic state operator ${d}`);break}}fill(){const o=this.current;o.element&&(o.element.setAttributeNS(null,"fill",o.fillColor),o.element.setAttributeNS(null,"fill-opacity",o.fillAlpha),this.endPath())}stroke(){const o=this.current;o.element&&(this._setStrokeAttributes(o.element),o.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(o,d=1){const l=this.current;let c=l.dashArray;d!==1&&c.length>0&&(c=c.map(function(h){return d*h})),o.setAttributeNS(null,"stroke",l.strokeColor),o.setAttributeNS(null,"stroke-opacity",l.strokeAlpha),o.setAttributeNS(null,"stroke-miterlimit",b(l.miterLimit)),o.setAttributeNS(null,"stroke-linecap",l.lineCap),o.setAttributeNS(null,"stroke-linejoin",l.lineJoin),o.setAttributeNS(null,"stroke-width",b(d*l.lineWidth)+"px"),o.setAttributeNS(null,"stroke-dasharray",c.map(b).join(" ")),o.setAttributeNS(null,"stroke-dashoffset",b(d*l.dashPhase)+"px")}eoFill(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width","1px"),o.setAttributeNS(null,"height","1px"),o.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(o)}paintImageXObject(o){const d=this.getObject(o);if(!d){(0,f.warn)(`Dependent image with object ID ${o} is not ready yet`);return}this.paintInlineImageXObject(d)}paintInlineImageXObject(o,d){const l=o.width,c=o.height,h=B(o,this.forceDataSchema,!!d),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",b(l)),O.setAttributeNS(null,"height",b(c)),this.current.element=O,this.clip("nonzero");const a=this.svgFactory.createElement("svg:image");a.setAttributeNS(ut,"xlink:href",h),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",b(-c)),a.setAttributeNS(null,"width",b(l)+"px"),a.setAttributeNS(null,"height",b(c)+"px"),a.setAttributeNS(null,"transform",`scale(${b(1/l)} ${b(-1/c)})`),d?d.append(a):this._ensureTransformGroup().append(a)}paintImageMaskXObject(o){const d=this.getObject(o.data,o);if(d.bitmap){(0,f.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const l=this.current,c=d.width,h=d.height,O=l.fillColor;l.maskId=`mask${u++}`;const a=this.svgFactory.createElement("svg:mask");a.setAttributeNS(null,"id",l.maskId);const E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",b(c)),E.setAttributeNS(null,"height",b(h)),E.setAttributeNS(null,"fill",O),E.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(a),this._ensureTransformGroup().append(E),this.paintInlineImageXObject(d,a)}paintFormXObjectBegin(o,d){if(Array.isArray(o)&&o.length===6&&this.transform(o[0],o[1],o[2],o[3],o[4],o[5]),d){const l=d[2]-d[0],c=d[3]-d[1],h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x",d[0]),h.setAttributeNS(null,"y",d[1]),h.setAttributeNS(null,"width",b(l)),h.setAttributeNS(null,"height",b(c)),this.current.element=h,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(o){const d=this.svgFactory.create(o.width,o.height),l=this.svgFactory.createElement("svg:defs");d.append(l),this.defs=l;const c=this.svgFactory.createElement("svg:g");return c.setAttributeNS(null,"transform",T(o.transform)),d.append(c),this.svg=c,d}_ensureClipGroup(){if(!this.current.clipGroup){const o=this.svgFactory.createElement("svg:g");o.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(o),this.current.clipGroup=o}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",T(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=D},(U,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class W{static textContent(f){const z=[],H={items:z,styles:Object.create(null)};function ut(k){var B;if(!k)return;let w=null;const m=k.name;if(m==="#text")w=k.value;else if(W.shouldBuildText(m))(B=k==null?void 0:k.attributes)!=null&&B.textContent?w=k.attributes.textContent:k.value&&(w=k.value);else return;if(w!==null&&z.push({str:w}),!!k.children)for(const I of k.children)ut(I)}return ut(f),H}static shouldBuildText(f){return!(f==="textarea"||f==="input"||f==="option"||f==="select")}}e.XfaText=W},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=T,e.updateTextLayer=g;var n=W(1),f=W(6);const z=1e5,H=30,ut=.8,k=new Map;function w(u,y){let D;if(y&&n.FeatureTest.isOffscreenCanvasSupported)D=new OffscreenCanvas(u,u).getContext("2d",{alpha:!1});else{const v=document.createElement("canvas");v.width=v.height=u,D=v.getContext("2d",{alpha:!1})}return D}function m(u,y){const D=k.get(u);if(D)return D;const v=w(H,y);v.font=`${H}px ${u}`;const o=v.measureText("");let d=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);if(d){const h=d/(d+l);return k.set(u,h),v.canvas.width=v.canvas.height=0,h}v.strokeStyle="red",v.clearRect(0,0,H,H),v.strokeText("g",0,0);let c=v.getImageData(0,0,H,H).data;l=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){l=Math.ceil(h/4/H);break}v.clearRect(0,0,H,H),v.strokeText("A",0,H),c=v.getImageData(0,0,H,H).data,d=0;for(let h=0,O=c.length;h<O;h+=4)if(c[h]>0){d=H-Math.floor(h/4/H);break}if(v.canvas.width=v.canvas.height=0,d){const h=d/(d+l);return k.set(u,h),h}return k.set(u,ut),ut}function B(u,y,D){const v=document.createElement("span"),o={angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,fontSize:0};u._textDivs.push(v);const d=n.Util.transform(u._transform,y.transform);let l=Math.atan2(d[1],d[0]);const c=D[y.fontName];c.vertical&&(l+=Math.PI/2);const h=Math.hypot(d[2],d[3]),O=h*m(c.fontFamily,u._isOffscreenCanvasSupported);let a,E;l===0?(a=d[4],E=d[5]-O):(a=d[4]+O*Math.sin(l),E=d[5]-O*Math.cos(l));const x="calc(var(--scale-factor)*",et=v.style;u._container===u._rootContainer?(et.left=`${(100*a/u._pageWidth).toFixed(2)}%`,et.top=`${(100*E/u._pageHeight).toFixed(2)}%`):(et.left=`${x}${a.toFixed(2)}px)`,et.top=`${x}${E.toFixed(2)}px)`),et.fontSize=`${x}${h.toFixed(2)}px)`,et.fontFamily=c.fontFamily,o.fontSize=h,v.setAttribute("role","presentation"),v.textContent=y.str,v.dir=y.dir,u._fontInspectorEnabled&&(v.dataset.fontName=y.fontName),l!==0&&(o.angle=l*(180/Math.PI));let $=!1;if(y.str.length>1)$=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const K=Math.abs(y.transform[0]),G=Math.abs(y.transform[3]);K!==G&&Math.max(K,G)/Math.min(K,G)>1.5&&($=!0)}$&&(o.canvasWidth=c.vertical?y.height:y.width),u._textDivProperties.set(v,o),u._isReadableStream&&u._layoutText(v)}function I(u){const{div:y,scale:D,properties:v,ctx:o,prevFontSize:d,prevFontFamily:l}=u,{style:c}=y;let h="";if(v.canvasWidth!==0&&v.hasText){const{fontFamily:O}=c,{canvasWidth:a,fontSize:E}=v;(d!==E||l!==O)&&(o.font=`${E*D}px ${O}`,u.prevFontSize=E,u.prevFontFamily=O);const{width:x}=o.measureText(y.textContent);x>0&&(h=`scaleX(${a*D/x})`)}v.angle!==0&&(h=`rotate(${v.angle}deg) ${h}`),h.length>0&&(c.transform=h)}function _(u){if(u._canceled)return;const y=u._textDivs,D=u._capability;if(y.length>z){D.resolve();return}if(!u._isReadableStream)for(const o of y)u._layoutText(o);D.resolve()}class b{constructor({textContentSource:y,container:D,viewport:v,textDivs:o,textDivProperties:d,textContentItemsStr:l,isOffscreenCanvasSupported:c}){var x;this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=D,this._textDivs=o||[],this._textContentItemsStr=l||[],this._isOffscreenCanvasSupported=c,this._fontInspectorEnabled=!!((x=globalThis.FontInspector)!=null&&x.enabled),this._reader=null,this._textDivProperties=d||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:w(0,c)};const{pageWidth:h,pageHeight:O,pageX:a,pageY:E}=v.rawDims;this._transform=[1,0,0,-1,-a,E+O],this._pageWidth=h,this._pageHeight=O,(0,f.setLayerDimensions)(D,v),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(y,D){for(const v of y){if(v.str===void 0){if(v.type==="beginMarkedContentProps"||v.type==="beginMarkedContent"){const o=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),v.id!==null&&this._container.setAttribute("id",`${v.id}`),o.append(this._container)}else v.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(v.str),B(this,v,D)}}_layoutText(y){const D=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,I(this._layoutTextParams),D.hasText&&this._container.append(y),D.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(){const y=new n.PromiseCapability;let D=Object.create(null);if(this._isReadableStream){const v=()=>{this._reader.read().then(({value:o,done:d})=>{if(d){y.resolve();return}Object.assign(D,o.styles),this._processItems(o.items,D),v()},y.reject)};this._reader=this._textContentSource.getReader(),v()}else if(this._textContentSource){const{items:v,styles:o}=this._textContentSource;this._processItems(v,o),y.resolve()}else throw new Error('No "textContentSource" parameter specified.');y.promise.then(()=>{D=null,_(this)},this._capability.reject)}}e.TextLayerRenderTask=b;function T(u){!u.textContentSource&&(u.textContent||u.textContentStream)&&((0,f.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),u.textContentSource=u.textContent||u.textContentStream);const{container:y,viewport:D}=u,v=getComputedStyle(y),o=v.getPropertyValue("visibility"),d=parseFloat(v.getPropertyValue("--scale-factor"));o==="visible"&&(!d||Math.abs(d-D.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const l=new b(u);return l._render(),l}function g({container:u,viewport:y,textDivs:D,textDivProperties:v,isOffscreenCanvasSupported:o,mustRotate:d=!0,mustRescale:l=!0}){if(d&&(0,f.setLayerDimensions)(u,{rotation:y.rotation}),l){const c=w(0,o),O={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:c};for(const a of D)O.properties=v.get(a),O.div=a,I(O)}}},(U,e,W)=>{var m,B,I,_,b,T,g,u,y,D,v,Je,Pe,Qe,Ze;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=W(1),f=W(4),z=W(28),H=W(33),ut=W(6),k=W(34);const h=class h{constructor({uiManager:a,pageIndex:E,div:x,accessibilityManager:et,annotationLayer:$,viewport:K,l10n:G}){rt(this,v);rt(this,m);rt(this,B,!1);rt(this,I,null);rt(this,_,this.pointerup.bind(this));rt(this,b,this.pointerdown.bind(this));rt(this,T,new Map);rt(this,g,!1);rt(this,u,!1);rt(this,y,!1);rt(this,D);const at=[z.FreeTextEditor,H.InkEditor,k.StampEditor];if(!h._initialized){h._initialized=!0;for(const C of at)C.initialize(G)}a.registerEditorTypes(at),lt(this,D,a),this.pageIndex=E,this.div=x,lt(this,m,et),lt(this,I,$),this.viewport=K,t(this,D).addLayer(this)}get isEmpty(){return t(this,T).size===0}updateToolbar(a){t(this,D).updateToolbar(a)}updateMode(a=t(this,D).getMode()){Y(this,v,Ze).call(this),a===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),a!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",a===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",a===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",a===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(a){if(!a&&t(this,D).getMode()!==n.AnnotationEditorType.INK)return;if(!a){for(const x of t(this,T).values())if(x.isEmpty()){x.setInBackground();return}}Y(this,v,Pe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(a){t(this,D).setEditingState(a)}addCommands(a){t(this,D).addCommands(a)}enable(){this.div.style.pointerEvents="auto";const a=new Set;for(const x of t(this,T).values())x.enableEditing(),x.annotationElementId&&a.add(x.annotationElementId);if(!t(this,I))return;const E=t(this,I).getEditableAnnotations();for(const x of E){if(x.hide(),t(this,D).isDeletedAnnotationElement(x.data.id)||a.has(x.data.id))continue;const et=this.deserialize(x);et&&(this.addOrRebuild(et),et.enableEditing())}}disable(){var E;lt(this,y,!0),this.div.style.pointerEvents="none";const a=new Set;for(const x of t(this,T).values()){if(x.disableEditing(),!x.annotationElementId||x.serialize()!==null){a.add(x.annotationElementId);continue}(E=this.getEditableAnnotation(x.annotationElementId))==null||E.show(),x.remove()}if(t(this,I)){const x=t(this,I).getEditableAnnotations();for(const et of x){const{id:$}=et.data;a.has($)||t(this,D).isDeletedAnnotationElement($)||et.show()}}Y(this,v,Ze).call(this),this.isEmpty&&(this.div.hidden=!0),lt(this,y,!1)}getEditableAnnotation(a){var E;return((E=t(this,I))==null?void 0:E.getEditableAnnotation(a))||null}setActiveEditor(a){t(this,D).getActive()!==a&&t(this,D).setActiveEditor(a)}enableClick(){this.div.addEventListener("pointerdown",t(this,b)),this.div.addEventListener("pointerup",t(this,_))}disableClick(){this.div.removeEventListener("pointerdown",t(this,b)),this.div.removeEventListener("pointerup",t(this,_))}attach(a){t(this,T).set(a.id,a);const{annotationElementId:E}=a;E&&t(this,D).isDeletedAnnotationElement(E)&&t(this,D).removeDeletedAnnotationElement(a)}detach(a){var E;t(this,T).delete(a.id),(E=t(this,m))==null||E.removePointerInTextLayer(a.contentDiv),!t(this,y)&&a.annotationElementId&&t(this,D).addDeletedAnnotationElement(a)}remove(a){this.detach(a),t(this,D).removeEditor(a),a.div.contains(document.activeElement)&&setTimeout(()=>{t(this,D).focusMainContainer()},0),a.div.remove(),a.isAttachedToDOM=!1,t(this,u)||this.addInkEditorIfNeeded(!1)}changeParent(a){var E;a.parent!==this&&(a.annotationElementId&&(t(this,D).addDeletedAnnotationElement(a.annotationElementId),f.AnnotationEditor.deleteAnnotationElement(a),a.annotationElementId=null),this.attach(a),(E=a.parent)==null||E.detach(a),a.setParent(this),a.div&&a.isAttachedToDOM&&(a.div.remove(),this.div.append(a.div)))}add(a){if(this.changeParent(a),t(this,D).addEditor(a),this.attach(a),!a.isAttachedToDOM){const E=a.render();this.div.append(E),a.isAttachedToDOM=!0}a.fixAndSetPosition(),a.onceAdded(),t(this,D).addToAnnotationStorage(a)}moveEditorInDOM(a){var x;if(!a.isAttachedToDOM)return;const{activeElement:E}=document;a.div.contains(E)&&(a._focusEventsAllowed=!1,setTimeout(()=>{a.div.contains(document.activeElement)?a._focusEventsAllowed=!0:(a.div.addEventListener("focusin",()=>{a._focusEventsAllowed=!0},{once:!0}),E.focus())},0)),a._structTreeParentId=(x=t(this,m))==null?void 0:x.moveElementInDOM(this.div,a.div,a.contentDiv,!0)}addOrRebuild(a){a.needsToBeRebuilt()?a.rebuild():this.add(a)}addUndoableEditor(a){const E=()=>a._uiManager.rebuild(a),x=()=>{a.remove()};this.addCommands({cmd:E,undo:x,mustExec:!1})}getNextId(){return t(this,D).getId()}pasteEditor(a,E){t(this,D).updateToolbar(a),t(this,D).updateMode(a);const{offsetX:x,offsetY:et}=Y(this,v,Qe).call(this),$=this.getNextId(),K=Y(this,v,Je).call(this,{parent:this,id:$,x,y:et,uiManager:t(this,D),isCentered:!0,...E});K&&this.add(K)}deserialize(a){switch(a.annotationType??a.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return z.FreeTextEditor.deserialize(a,this,t(this,D));case n.AnnotationEditorType.INK:return H.InkEditor.deserialize(a,this,t(this,D));case n.AnnotationEditorType.STAMP:return k.StampEditor.deserialize(a,this,t(this,D))}return null}addNewEditor(){Y(this,v,Pe).call(this,Y(this,v,Qe).call(this),!0)}setSelected(a){t(this,D).setSelected(a)}toggleSelected(a){t(this,D).toggleSelected(a)}isSelected(a){return t(this,D).isSelected(a)}unselect(a){t(this,D).unselect(a)}pointerup(a){const{isMac:E}=n.FeatureTest.platform;if(!(a.button!==0||a.ctrlKey&&E)&&a.target===this.div&&t(this,g)){if(lt(this,g,!1),!t(this,B)){lt(this,B,!0);return}if(t(this,D).getMode()===n.AnnotationEditorType.STAMP){t(this,D).unselectAll();return}Y(this,v,Pe).call(this,a,!1)}}pointerdown(a){if(t(this,g)){lt(this,g,!1);return}const{isMac:E}=n.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&E||a.target!==this.div)return;lt(this,g,!0);const x=t(this,D).getActive();lt(this,B,!x||x.isEmpty())}findNewParent(a,E,x){const et=t(this,D).findParent(E,x);return et===null||et===this?!1:(et.changeParent(a),!0)}destroy(){var a,E;((a=t(this,D).getActive())==null?void 0:a.parent)===this&&(t(this,D).commitOrRemove(),t(this,D).setActiveEditor(null));for(const x of t(this,T).values())(E=t(this,m))==null||E.removePointerInTextLayer(x.contentDiv),x.setParent(null),x.isAttachedToDOM=!1,x.div.remove();this.div=null,t(this,T).clear(),t(this,D).removeLayer(this)}render({viewport:a}){this.viewport=a,(0,ut.setLayerDimensions)(this.div,a);for(const E of t(this,D).getEditors(this.pageIndex))this.add(E);this.updateMode()}update({viewport:a}){t(this,D).commitOrRemove(),this.viewport=a,(0,ut.setLayerDimensions)(this.div,{rotation:a.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:a,pageHeight:E}=this.viewport.rawDims;return[a,E]}};m=new WeakMap,B=new WeakMap,I=new WeakMap,_=new WeakMap,b=new WeakMap,T=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,D=new WeakMap,v=new WeakSet,Je=function(a){switch(t(this,D).getMode()){case n.AnnotationEditorType.FREETEXT:return new z.FreeTextEditor(a);case n.AnnotationEditorType.INK:return new H.InkEditor(a);case n.AnnotationEditorType.STAMP:return new k.StampEditor(a)}return null},Pe=function(a,E){const x=this.getNextId(),et=Y(this,v,Je).call(this,{parent:this,id:x,x:a.offsetX,y:a.offsetY,uiManager:t(this,D),isCentered:E});return et&&this.add(et),et},Qe=function(){const{x:a,y:E,width:x,height:et}=this.div.getBoundingClientRect(),$=Math.max(0,a),K=Math.max(0,E),G=Math.min(window.innerWidth,a+x),at=Math.min(window.innerHeight,E+et),C=($+G)/2-a,V=(K+at)/2-E,[nt,S]=this.viewport.rotation%180===0?[C,V]:[V,C];return{offsetX:nt,offsetY:S}},Ze=function(){lt(this,u,!0);for(const a of t(this,T).values())a.isEmpty()&&a.remove();lt(this,u,!1)},Jt(h,"_initialized",!1);let w=h;e.AnnotationEditorLayer=w},(U,e,W)=>{var k,w,m,B,I,_,b,T,g,u,xn,Rn,kn,me,tn,Fn,en;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=W(1),f=W(5),z=W(4),H=W(29);const h=class h extends z.AnnotationEditor{constructor(E){super({...E,name:"freeTextEditor"});rt(this,u);rt(this,k,this.editorDivBlur.bind(this));rt(this,w,this.editorDivFocus.bind(this));rt(this,m,this.editorDivInput.bind(this));rt(this,B,this.editorDivKeydown.bind(this));rt(this,I);rt(this,_,"");rt(this,b,`${this.id}-editor`);rt(this,T);rt(this,g,null);lt(this,I,E.color||h._defaultColor||z.AnnotationEditor._defaultLineColor),lt(this,T,E.fontSize||h._defaultFontSize)}static get _keyboardManager(){const E=h.prototype,x=K=>K.isEmpty(),et=f.AnnotationEditorUIManager.TRANSLATE_SMALL,$=f.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new f.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],E.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],E.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],E._translateEmpty,{args:[-et,0],checker:x}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],E._translateEmpty,{args:[-$,0],checker:x}],[["ArrowRight","mac+ArrowRight"],E._translateEmpty,{args:[et,0],checker:x}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],E._translateEmpty,{args:[$,0],checker:x}],[["ArrowUp","mac+ArrowUp"],E._translateEmpty,{args:[0,-et],checker:x}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],E._translateEmpty,{args:[0,-$],checker:x}],[["ArrowDown","mac+ArrowDown"],E._translateEmpty,{args:[0,et],checker:x}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],E._translateEmpty,{args:[0,$],checker:x}]]))}static initialize(E){z.AnnotationEditor.initialize(E,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const x=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(x.getPropertyValue("--freetext-padding"))}static updateDefaultParams(E,x){switch(E){case n.AnnotationEditorParamsType.FREETEXT_SIZE:h._defaultFontSize=x;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:h._defaultColor=x;break}}updateParams(E,x){switch(E){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,u,xn).call(this,x);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,u,Rn).call(this,x);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,h._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,h._defaultColor||z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,T)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,I)]]}_translateEmpty(E,x){this._uiManager.translateSelectedEditors(E,x,!0)}getInitialTranslation(){const E=this.parentScale;return[-h._internalPadding*E,-(h._internalPadding+t(this,T))*E]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,B)),this.editorDiv.addEventListener("focus",t(this,w)),this.editorDiv.addEventListener("blur",t(this,k)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,b)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,B)),this.editorDiv.removeEventListener("focus",t(this,w)),this.editorDiv.removeEventListener("blur",t(this,k)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(E){this._focusEventsAllowed&&(super.focusin(E),E.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var E;if(this.width){Y(this,u,en).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(E=this._initialOptions)!=null&&E.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const E=t(this,_),x=lt(this,_,Y(this,u,kn).call(this).trimEnd());if(E===x)return;const et=$=>{if(lt(this,_,$),!$){this.remove();return}Y(this,u,tn).call(this),this._uiManager.rebuild(this),Y(this,u,me).call(this)};this.addCommands({cmd:()=>{et(x)},undo:()=>{et(E)},mustExec:!1}),Y(this,u,me).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(E){this.enterInEditMode()}keydown(E){E.target===this.div&&E.key==="Enter"&&(this.enterInEditMode(),E.preventDefault())}editorDivKeydown(E){h._keyboardManager.exec(this,E)}editorDivFocus(E){this.isEditing=!0}editorDivBlur(E){this.isEditing=!1}editorDivInput(E){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let E,x;this.width&&(E=this.x,x=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,b)),this.enableEditing(),z.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then($=>{var K;return(K=this.editorDiv)==null?void 0:K.setAttribute("aria-label",$)}),z.AnnotationEditor._l10nPromise.get("free_text2_default_content").then($=>{var K;return(K=this.editorDiv)==null?void 0:K.setAttribute("default-content",$)}),this.editorDiv.contentEditable=!0;const{style:et}=this.editorDiv;if(et.fontSize=`calc(${t(this,T)}px * var(--scale-factor))`,et.color=t(this,I),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,f.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[$,K]=this.parentDimensions;if(this.annotationElementId){const{position:G}=t(this,g);let[at,C]=this.getInitialTranslation();[at,C]=this.pageTranslationToScreen(at,C);const[V,nt]=this.pageDimensions,[S,s]=this.pageTranslation;let i,p;switch(this.rotation){case 0:i=E+(G[0]-S)/V,p=x+this.height-(G[1]-s)/nt;break;case 90:i=E+(G[0]-S)/V,p=x-(G[1]-s)/nt,[at,C]=[C,-at];break;case 180:i=E-this.width+(G[0]-S)/V,p=x-(G[1]-s)/nt,[at,C]=[-at,-C];break;case 270:i=E+(G[0]-S-this.height*nt)/V,p=x+(G[1]-s-this.width*V)/nt,[at,C]=[-C,at];break}this.setAt(i*$,p*K,at,C)}else this.setAt(E*$,x*K,this.width*$,this.height*K);Y(this,u,tn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(E,x,et){let $=null;if(E instanceof H.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:G,fontColor:at},rect:C,rotation:V,id:nt},textContent:S,textPosition:s,parent:{page:{pageNumber:i}}}=E;if(!S||S.length===0)return null;$=E={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(at),fontSize:G,value:S.join(`
`),position:s,pageIndex:i-1,rect:C,rotation:V,id:nt,deleted:!1}}const K=super.deserialize(E,x,et);return lt(K,T,E.fontSize),lt(K,I,n.Util.makeHexColor(...E.color)),lt(K,_,E.value),K.annotationElementId=E.id||null,lt(K,g,$),K}serialize(E=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const x=h._internalPadding*this.parentScale,et=this.getRect(x,x),$=z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,I)),K={annotationType:n.AnnotationEditorType.FREETEXT,color:$,fontSize:t(this,T),value:t(this,_),pageIndex:this.pageIndex,rect:et,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return E?K:this.annotationElementId&&!Y(this,u,Fn).call(this,K)?null:(K.id=this.annotationElementId,K)}};k=new WeakMap,w=new WeakMap,m=new WeakMap,B=new WeakMap,I=new WeakMap,_=new WeakMap,b=new WeakMap,T=new WeakMap,g=new WeakMap,u=new WeakSet,xn=function(E){const x=$=>{this.editorDiv.style.fontSize=`calc(${$}px * var(--scale-factor))`,this.translate(0,-($-t(this,T))*this.parentScale),lt(this,T,$),Y(this,u,me).call(this)},et=t(this,T);this.addCommands({cmd:()=>{x(E)},undo:()=>{x(et)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Rn=function(E){const x=t(this,I);this.addCommands({cmd:()=>{lt(this,I,this.editorDiv.style.color=E)},undo:()=>{lt(this,I,this.editorDiv.style.color=x)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},kn=function(){const E=this.editorDiv.getElementsByTagName("div");if(E.length===0)return this.editorDiv.innerText;const x=[];for(const et of E)x.push(et.innerText.replace(/\r\n?|\n/,""));return x.join(`
`)},me=function(){const[E,x]=this.parentDimensions;let et;if(this.isAttachedToDOM)et=this.div.getBoundingClientRect();else{const{currentLayer:$,div:K}=this,G=K.style.display;K.style.display="hidden",$.div.append(this.div),et=K.getBoundingClientRect(),K.remove(),K.style.display=G}this.rotation%180===this.parentRotation%180?(this.width=et.width/E,this.height=et.height/x):(this.width=et.height/E,this.height=et.width/x),this.fixAndSetPosition()},tn=function(){if(this.editorDiv.replaceChildren(),!!t(this,_))for(const E of t(this,_).split(`
`)){const x=document.createElement("div");x.append(E?document.createTextNode(E):document.createElement("br")),this.editorDiv.append(x)}},Fn=function(E){const{value:x,fontSize:et,color:$,rect:K,pageIndex:G}=t(this,g);return E.value!==x||E.fontSize!==et||E.rect.some((at,C)=>Math.abs(at-K[C])>=1)||E.color.some((at,C)=>at!==$[C])||E.pageIndex!==G},en=function(E=!1){if(!this.annotationElementId)return;if(Y(this,u,me).call(this),!E&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,u,en).call(this,!0),0);return}const x=h._internalPadding*this.parentScale;t(this,g).rect=this.getRect(x,x)},Jt(h,"_freeTextDefaultContent",""),Jt(h,"_internalPadding",0),Jt(h,"_defaultColor",null),Jt(h,"_defaultFontSize",10),Jt(h,"_type","freetext");let ut=h;e.FreeTextEditor=ut},(U,e,W)=>{var p,M,re,Mn,st,ht,gt,yt,ft,bt,Z,tt,A,N,J,it,mt,St,vt,Q,wt,Pt,Dn,we,nn,sn,It,Gt,qt,Et,ot,ct,kt,rn,Vt,j,_t,Ct,Ln,an;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=W(1),f=W(6),z=W(3),H=W(30),ut=W(31),k=W(32);const w=1e3,m=9,B=new WeakSet;function I(Rt){return{width:Rt[2]-Rt[0],height:Rt[3]-Rt[1]}}class _{static create(R){switch(R.data.annotationType){case n.AnnotationType.LINK:return new T(R);case n.AnnotationType.TEXT:return new g(R);case n.AnnotationType.WIDGET:switch(R.data.fieldType){case"Tx":return new y(R);case"Btn":return R.data.radioButton?new o(R):R.data.checkBox?new v(R):new d(R);case"Ch":return new l(R);case"Sig":return new D(R)}return new u(R);case n.AnnotationType.POPUP:return new c(R);case n.AnnotationType.FREETEXT:return new O(R);case n.AnnotationType.LINE:return new a(R);case n.AnnotationType.SQUARE:return new E(R);case n.AnnotationType.CIRCLE:return new x(R);case n.AnnotationType.POLYLINE:return new et(R);case n.AnnotationType.CARET:return new K(R);case n.AnnotationType.INK:return new G(R);case n.AnnotationType.POLYGON:return new $(R);case n.AnnotationType.HIGHLIGHT:return new at(R);case n.AnnotationType.UNDERLINE:return new C(R);case n.AnnotationType.SQUIGGLY:return new V(R);case n.AnnotationType.STRIKEOUT:return new nt(R);case n.AnnotationType.STAMP:return new S(R);case n.AnnotationType.FILEATTACHMENT:return new s(R);default:return new b(R)}}}const F=class F{constructor(R,{isRenderable:P=!1,ignoreBorder:X=!1,createQuadrilaterals:dt=!1}={}){rt(this,p,!1);this.isRenderable=P,this.data=R.data,this.layer=R.layer,this.linkService=R.linkService,this.downloadManager=R.downloadManager,this.imageResourcesPath=R.imageResourcesPath,this.renderForms=R.renderForms,this.svgFactory=R.svgFactory,this.annotationStorage=R.annotationStorage,this.enableScripting=R.enableScripting,this.hasJSActions=R.hasJSActions,this._fieldObjects=R.fieldObjects,this.parent=R.parent,P&&(this.container=this._createContainer(X)),dt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:R,contentsObj:P,richText:X}){return!!(R!=null&&R.str||P!=null&&P.str||X!=null&&X.str)}get hasPopupData(){return F._hasPopupData(this.data)}_createContainer(R){const{data:P,parent:{page:X,viewport:dt}}=this,pt=document.createElement("section");pt.setAttribute("data-annotation-id",P.id),this instanceof u||(pt.tabIndex=w),pt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&pt.setAttribute("aria-haspopup","dialog"),P.noRotate&&pt.classList.add("norotate");const{pageWidth:At,pageHeight:Tt,pageX:Ot,pageY:Mt}=dt.rawDims;if(!P.rect||this instanceof c){const{rotation:jt}=P;return!P.hasOwnCanvas&&jt!==0&&this.setRotation(jt,pt),pt}const{width:xt,height:Ht}=I(P.rect),Dt=n.Util.normalizeRect([P.rect[0],X.view[3]-P.rect[1]+X.view[1],P.rect[2],X.view[3]-P.rect[3]+X.view[1]]);if(!R&&P.borderStyle.width>0){pt.style.borderWidth=`${P.borderStyle.width}px`;const jt=P.borderStyle.horizontalCornerRadius,$t=P.borderStyle.verticalCornerRadius;if(jt>0||$t>0){const Kt=`calc(${jt}px * var(--scale-factor)) / calc(${$t}px * var(--scale-factor))`;pt.style.borderRadius=Kt}else if(this instanceof o){const Kt=`calc(${xt}px * var(--scale-factor)) / calc(${Ht}px * var(--scale-factor))`;pt.style.borderRadius=Kt}switch(P.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:pt.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:pt.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:pt.style.borderBottomStyle="solid";break}const Yt=P.borderColor||null;Yt?(lt(this,p,!0),pt.style.borderColor=n.Util.makeHexColor(Yt[0]|0,Yt[1]|0,Yt[2]|0)):pt.style.borderWidth=0}pt.style.left=`${100*(Dt[0]-Ot)/At}%`,pt.style.top=`${100*(Dt[1]-Mt)/Tt}%`;const{rotation:Nt}=P;return P.hasOwnCanvas||Nt===0?(pt.style.width=`${100*xt/At}%`,pt.style.height=`${100*Ht/Tt}%`):this.setRotation(Nt,pt),pt}setRotation(R,P=this.container){if(!this.data.rect)return;const{pageWidth:X,pageHeight:dt}=this.parent.viewport.rawDims,{width:pt,height:At}=I(this.data.rect);let Tt,Ot;R%180===0?(Tt=100*pt/X,Ot=100*At/dt):(Tt=100*At/X,Ot=100*pt/dt),P.style.width=`${Tt}%`,P.style.height=`${Ot}%`,P.setAttribute("data-main-rotation",(360-R)%360)}get _commonActions(){const R=(P,X,dt)=>{const pt=dt.detail[P],At=pt[0],Tt=pt.slice(1);dt.target.style[X]=H.ColorConverters[`${At}_HTML`](Tt),this.annotationStorage.setValue(this.data.id,{[X]:H.ColorConverters[`${At}_rgb`](Tt)})};return(0,n.shadow)(this,"_commonActions",{display:P=>{const{display:X}=P.detail,dt=X%2===1;this.container.style.visibility=dt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:dt,noPrint:X===1||X===2})},print:P=>{this.annotationStorage.setValue(this.data.id,{noPrint:!P.detail.print})},hidden:P=>{const{hidden:X}=P.detail;this.container.style.visibility=X?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:X,noView:X})},focus:P=>{setTimeout(()=>P.target.focus({preventScroll:!1}),0)},userName:P=>{P.target.title=P.detail.userName},readonly:P=>{P.target.disabled=P.detail.readonly},required:P=>{this._setRequired(P.target,P.detail.required)},bgColor:P=>{R("bgColor","backgroundColor",P)},fillColor:P=>{R("fillColor","backgroundColor",P)},fgColor:P=>{R("fgColor","color",P)},textColor:P=>{R("textColor","color",P)},borderColor:P=>{R("borderColor","borderColor",P)},strokeColor:P=>{R("strokeColor","borderColor",P)},rotation:P=>{const X=P.detail.rotation;this.setRotation(X),this.annotationStorage.setValue(this.data.id,{rotation:X})}})}_dispatchEventFromSandbox(R,P){const X=this._commonActions;for(const dt of Object.keys(P.detail)){const pt=R[dt]||X[dt];pt==null||pt(P)}}_setDefaultPropertiesFromJS(R){if(!this.enableScripting)return;const P=this.annotationStorage.getRawValue(this.data.id);if(!P)return;const X=this._commonActions;for(const[dt,pt]of Object.entries(P)){const At=X[dt];if(At){const Tt={detail:{[dt]:pt},target:R};At(Tt),delete P[dt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:R}=this.data;if(!R)return;const[P,X,dt,pt]=this.data.rect;if(R.length===1){const[,{x:$t,y:Yt},{x:Kt,y:Zt}]=R[0];if(dt===$t&&pt===Yt&&P===Kt&&X===Zt)return}const{style:At}=this.container;let Tt;if(t(this,p)){const{borderColor:$t,borderWidth:Yt}=At;At.borderWidth=0,Tt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${$t}" stroke-width="${Yt}">`],this.container.classList.add("hasBorder")}const Ot=dt-P,Mt=pt-X,{svgFactory:xt}=this,Ht=xt.createElement("svg");Ht.classList.add("quadrilateralsContainer"),Ht.setAttribute("width",0),Ht.setAttribute("height",0);const Dt=xt.createElement("defs");Ht.append(Dt);const Nt=xt.createElement("clipPath"),jt=`clippath_${this.data.id}`;Nt.setAttribute("id",jt),Nt.setAttribute("clipPathUnits","objectBoundingBox"),Dt.append(Nt);for(const[,{x:$t,y:Yt},{x:Kt,y:Zt}]of R){const Qt=xt.createElement("rect"),ee=(Kt-P)/Ot,se=(pt-Yt)/Mt,ie=($t-Kt)/Ot,gn=(Yt-Zt)/Mt;Qt.setAttribute("x",ee),Qt.setAttribute("y",se),Qt.setAttribute("width",ie),Qt.setAttribute("height",gn),Nt.append(Qt),Tt==null||Tt.push(`<rect vector-effect="non-scaling-stroke" x="${ee}" y="${se}" width="${ie}" height="${gn}"/>`)}t(this,p)&&(Tt.push("</g></svg>')"),At.backgroundImage=Tt.join("")),this.container.append(Ht),this.container.style.clipPath=`url(#${jt})`}_createPopup(){const{container:R,data:P}=this;R.setAttribute("aria-haspopup","dialog");const X=new c({data:{color:P.color,titleObj:P.titleObj,modificationDate:P.modificationDate,contentsObj:P.contentsObj,richText:P.richText,parentRect:P.rect,borderStyle:0,id:`popup_${P.id}`,rotation:P.rotation},parent:this.parent,elements:[this]});this.parent.div.append(X.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(R,P=null){const X=[];if(this._fieldObjects){const dt=this._fieldObjects[R];if(dt)for(const{page:pt,id:At,exportValues:Tt}of dt){if(pt===-1||At===P)continue;const Ot=typeof Tt=="string"?Tt:null,Mt=document.querySelector(`[data-element-id="${At}"]`);if(Mt&&!B.has(Mt)){(0,n.warn)(`_getElementsByName - element not allowed: ${At}`);continue}X.push({id:At,exportValue:Ot,domElement:Mt})}return X}for(const dt of document.getElementsByName(R)){const{exportValue:pt}=dt,At=dt.getAttribute("data-element-id");At!==P&&B.has(dt)&&X.push({id:At,exportValue:pt,domElement:dt})}return X}show(){var R;this.container&&(this.container.hidden=!1),(R=this.popup)==null||R.maybeShow()}hide(){var R;this.container&&(this.container.hidden=!0),(R=this.popup)==null||R.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const R=this.getElementsToTriggerPopup();if(Array.isArray(R))for(const P of R)P.classList.add("highlightArea");else R.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:R,data:{id:P}}=this;this.container.addEventListener("dblclick",()=>{var X;(X=this.linkService.eventBus)==null||X.dispatch("switchannotationeditormode",{source:this,mode:R,editId:P})})}};p=new WeakMap;let b=F;class T extends b{constructor(P,X=null){super(P,{isRenderable:!0,ignoreBorder:!!(X!=null&&X.ignoreBorder),createQuadrilaterals:!0});rt(this,M);this.isTooltipOnly=P.data.isTooltipOnly}render(){const{data:P,linkService:X}=this,dt=document.createElement("a");dt.setAttribute("data-element-id",P.id);let pt=!1;return P.url?(X.addLinkAttributes(dt,P.url,P.newWindow),pt=!0):P.action?(this._bindNamedAction(dt,P.action),pt=!0):P.attachment?(this._bindAttachment(dt,P.attachment),pt=!0):P.setOCGState?(Y(this,M,Mn).call(this,dt,P.setOCGState),pt=!0):P.dest?(this._bindLink(dt,P.dest),pt=!0):(P.actions&&(P.actions.Action||P.actions["Mouse Up"]||P.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(dt,P),pt=!0),P.resetForm?(this._bindResetFormAction(dt,P.resetForm),pt=!0):this.isTooltipOnly&&!pt&&(this._bindLink(dt,""),pt=!0)),this.container.classList.add("linkAnnotation"),pt&&this.container.append(dt),this.container}_bindLink(P,X){P.href=this.linkService.getDestinationHash(X),P.onclick=()=>(X&&this.linkService.goToDestination(X),!1),(X||X==="")&&Y(this,M,re).call(this)}_bindNamedAction(P,X){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeNamedAction(X),!1),Y(this,M,re).call(this)}_bindAttachment(P,X){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>{var dt;return(dt=this.downloadManager)==null||dt.openOrDownloadData(this.container,X.content,X.filename),!1},Y(this,M,re).call(this)}_bindJSAction(P,X){P.href=this.linkService.getAnchorUrl("");const dt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const pt of Object.keys(X.actions)){const At=dt.get(pt);At&&(P[At]=()=>{var Tt;return(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:X.id,name:pt}}),!1})}P.onclick||(P.onclick=()=>!1),Y(this,M,re).call(this)}_bindResetFormAction(P,X){const dt=P.onclick;if(dt||(P.href=this.linkService.getAnchorUrl("")),Y(this,M,re).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),dt||(P.onclick=()=>!1);return}P.onclick=()=>{var Ht;dt==null||dt();const{fields:pt,refs:At,include:Tt}=X,Ot=[];if(pt.length!==0||At.length!==0){const Dt=new Set(At);for(const Nt of pt){const jt=this._fieldObjects[Nt]||[];for(const{id:$t}of jt)Dt.add($t)}for(const Nt of Object.values(this._fieldObjects))for(const jt of Nt)Dt.has(jt.id)===Tt&&Ot.push(jt)}else for(const Dt of Object.values(this._fieldObjects))Ot.push(...Dt);const Mt=this.annotationStorage,xt=[];for(const Dt of Ot){const{id:Nt}=Dt;switch(xt.push(Nt),Dt.type){case"text":{const $t=Dt.defaultValue||"";Mt.setValue(Nt,{value:$t});break}case"checkbox":case"radiobutton":{const $t=Dt.defaultValue===Dt.exportValues;Mt.setValue(Nt,{value:$t});break}case"combobox":case"listbox":{const $t=Dt.defaultValue||"";Mt.setValue(Nt,{value:$t});break}default:continue}const jt=document.querySelector(`[data-element-id="${Nt}"]`);if(jt){if(!B.has(jt)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Nt}`);continue}}else continue;jt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:xt,name:"ResetForm"}})),!1}}}M=new WeakSet,re=function(){this.container.setAttribute("data-internal-link","")},Mn=function(P,X){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeSetOCGState(X),!1),Y(this,M,re).call(this)};class g extends b{constructor(R){super(R,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const R=document.createElement("img");return R.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",R.alt="[{{type}} Annotation]",R.dataset.l10nId="text_annotation_type",R.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(R),this.container}}class u extends b{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(R){var P;this.data.hasOwnCanvas&&(((P=R.previousSibling)==null?void 0:P.nodeName)==="CANVAS"&&(R.previousSibling.hidden=!0),R.hidden=!1)}_getKeyModifier(R){const{isWin:P,isMac:X}=n.FeatureTest.platform;return P&&R.ctrlKey||X&&R.metaKey}_setEventListener(R,P,X,dt,pt){X.includes("mouse")?R.addEventListener(X,At=>{var Tt;(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:dt,value:pt(At),shift:At.shiftKey,modifier:this._getKeyModifier(At)}})}):R.addEventListener(X,At=>{var Tt;if(X==="blur"){if(!P.focused||!At.relatedTarget)return;P.focused=!1}else if(X==="focus"){if(P.focused)return;P.focused=!0}pt&&((Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:dt,value:pt(At)}}))})}_setEventListeners(R,P,X,dt){var pt,At,Tt;for(const[Ot,Mt]of X)(Mt==="Action"||(pt=this.data.actions)!=null&&pt[Mt])&&((Mt==="Focus"||Mt==="Blur")&&(P||(P={focused:!1})),this._setEventListener(R,P,Ot,Mt,dt),Mt==="Focus"&&!((At=this.data.actions)!=null&&At.Blur)?this._setEventListener(R,P,"blur","Blur",null):Mt==="Blur"&&!((Tt=this.data.actions)!=null&&Tt.Focus)&&this._setEventListener(R,P,"focus","Focus",null))}_setBackgroundColor(R){const P=this.data.backgroundColor||null;R.style.backgroundColor=P===null?"transparent":n.Util.makeHexColor(P[0],P[1],P[2])}_setTextStyle(R){const P=["left","center","right"],{fontColor:X}=this.data.defaultAppearanceData,dt=this.data.defaultAppearanceData.fontSize||m,pt=R.style;let At;const Tt=2,Ot=Mt=>Math.round(10*Mt)/10;if(this.data.multiLine){const Mt=Math.abs(this.data.rect[3]-this.data.rect[1]-Tt),xt=Math.round(Mt/(n.LINE_FACTOR*dt))||1,Ht=Mt/xt;At=Math.min(dt,Ot(Ht/n.LINE_FACTOR))}else{const Mt=Math.abs(this.data.rect[3]-this.data.rect[1]-Tt);At=Math.min(dt,Ot(Mt/n.LINE_FACTOR))}pt.fontSize=`calc(${At}px * var(--scale-factor))`,pt.color=n.Util.makeHexColor(X[0],X[1],X[2]),this.data.textAlignment!==null&&(pt.textAlign=P[this.data.textAlignment])}_setRequired(R,P){P?R.setAttribute("required",!0):R.removeAttribute("required"),R.setAttribute("aria-required",P)}}class y extends u{constructor(R){const P=R.renderForms||!R.data.hasAppearance&&!!R.data.fieldValue;super(R,{isRenderable:P})}setPropertyOnSiblings(R,P,X,dt){const pt=this.annotationStorage;for(const At of this._getElementsByName(R.name,R.id))At.domElement&&(At.domElement[P]=X),pt.setValue(At.id,{[dt]:X})}render(){var dt,pt;const R=this.annotationStorage,P=this.data.id;this.container.classList.add("textWidgetAnnotation");let X=null;if(this.renderForms){const At=R.getValue(P,{value:this.data.fieldValue});let Tt=At.value||"";const Ot=R.getValue(P,{charLimit:this.data.maxLen}).charLimit;Ot&&Tt.length>Ot&&(Tt=Tt.slice(0,Ot));let Mt=At.formattedValue||((dt=this.data.textContent)==null?void 0:dt.join(`
`))||null;Mt&&this.data.comb&&(Mt=Mt.replaceAll(/\s+/g,""));const xt={userValue:Tt,formattedValue:Mt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(X=document.createElement("textarea"),X.textContent=Mt??Tt,this.data.doNotScroll&&(X.style.overflowY="hidden")):(X=document.createElement("input"),X.type="text",X.setAttribute("value",Mt??Tt),this.data.doNotScroll&&(X.style.overflowX="hidden")),this.data.hasOwnCanvas&&(X.hidden=!0),B.add(X),X.setAttribute("data-element-id",P),X.disabled=this.data.readOnly,X.name=this.data.fieldName,X.tabIndex=w,this._setRequired(X,this.data.required),Ot&&(X.maxLength=Ot),X.addEventListener("input",Dt=>{R.setValue(P,{value:Dt.target.value}),this.setPropertyOnSiblings(X,"value",Dt.target.value,"value"),xt.formattedValue=null}),X.addEventListener("resetform",Dt=>{const Nt=this.data.defaultFieldValue??"";X.value=xt.userValue=Nt,xt.formattedValue=null});let Ht=Dt=>{const{formattedValue:Nt}=xt;Nt!=null&&(Dt.target.value=Nt),Dt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){X.addEventListener("focus",Nt=>{if(xt.focused)return;const{target:jt}=Nt;xt.userValue&&(jt.value=xt.userValue),xt.lastCommittedValue=jt.value,xt.commitKey=1,xt.focused=!0}),X.addEventListener("updatefromsandbox",Nt=>{this.showElementAndHideCanvas(Nt.target);const jt={value($t){xt.userValue=$t.detail.value??"",R.setValue(P,{value:xt.userValue.toString()}),$t.target.value=xt.userValue},formattedValue($t){const{formattedValue:Yt}=$t.detail;xt.formattedValue=Yt,Yt!=null&&$t.target!==document.activeElement&&($t.target.value=Yt),R.setValue(P,{formattedValue:Yt})},selRange($t){$t.target.setSelectionRange(...$t.detail.selRange)},charLimit:$t=>{var Qt;const{charLimit:Yt}=$t.detail,{target:Kt}=$t;if(Yt===0){Kt.removeAttribute("maxLength");return}Kt.setAttribute("maxLength",Yt);let Zt=xt.userValue;!Zt||Zt.length<=Yt||(Zt=Zt.slice(0,Yt),Kt.value=xt.userValue=Zt,R.setValue(P,{value:Zt}),(Qt=this.linkService.eventBus)==null||Qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Zt,willCommit:!0,commitKey:1,selStart:Kt.selectionStart,selEnd:Kt.selectionEnd}}))}};this._dispatchEventFromSandbox(jt,Nt)}),X.addEventListener("keydown",Nt=>{var Yt;xt.commitKey=1;let jt=-1;if(Nt.key==="Escape"?jt=0:Nt.key==="Enter"&&!this.data.multiLine?jt=2:Nt.key==="Tab"&&(xt.commitKey=3),jt===-1)return;const{value:$t}=Nt.target;xt.lastCommittedValue!==$t&&(xt.lastCommittedValue=$t,xt.userValue=$t,(Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:$t,willCommit:!0,commitKey:jt,selStart:Nt.target.selectionStart,selEnd:Nt.target.selectionEnd}}))});const Dt=Ht;Ht=null,X.addEventListener("blur",Nt=>{var $t;if(!xt.focused||!Nt.relatedTarget)return;xt.focused=!1;const{value:jt}=Nt.target;xt.userValue=jt,xt.lastCommittedValue!==jt&&(($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:jt,willCommit:!0,commitKey:xt.commitKey,selStart:Nt.target.selectionStart,selEnd:Nt.target.selectionEnd}})),Dt(Nt)}),(pt=this.data.actions)!=null&&pt.Keystroke&&X.addEventListener("beforeinput",Nt=>{var se;xt.lastCommittedValue=null;const{data:jt,target:$t}=Nt,{value:Yt,selectionStart:Kt,selectionEnd:Zt}=$t;let Qt=Kt,ee=Zt;switch(Nt.inputType){case"deleteWordBackward":{const ie=Yt.substring(0,Kt).match(/\w*[^\w]*$/);ie&&(Qt-=ie[0].length);break}case"deleteWordForward":{const ie=Yt.substring(Kt).match(/^[^\w]*\w*/);ie&&(ee+=ie[0].length);break}case"deleteContentBackward":Kt===Zt&&(Qt-=1);break;case"deleteContentForward":Kt===Zt&&(ee+=1);break}Nt.preventDefault(),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Yt,change:jt||"",willCommit:!1,selStart:Qt,selEnd:ee}})}),this._setEventListeners(X,xt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Nt=>Nt.target.value)}if(Ht&&X.addEventListener("blur",Ht),this.data.comb){const Nt=(this.data.rect[2]-this.data.rect[0])/Ot;X.classList.add("comb"),X.style.letterSpacing=`calc(${Nt}px * var(--scale-factor) - 1ch)`}}else X=document.createElement("div"),X.textContent=this.data.fieldValue,X.style.verticalAlign="middle",X.style.display="table-cell";return this._setTextStyle(X),this._setBackgroundColor(X),this._setDefaultPropertiesFromJS(X),this.container.append(X),this.container}}class D extends u{constructor(R){super(R,{isRenderable:!!R.data.hasOwnCanvas})}}class v extends u{constructor(R){super(R,{isRenderable:R.renderForms})}render(){const R=this.annotationStorage,P=this.data,X=P.id;let dt=R.getValue(X,{value:P.exportValue===P.fieldValue}).value;typeof dt=="string"&&(dt=dt!=="Off",R.setValue(X,{value:dt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const pt=document.createElement("input");return B.add(pt),pt.setAttribute("data-element-id",X),pt.disabled=P.readOnly,this._setRequired(pt,this.data.required),pt.type="checkbox",pt.name=P.fieldName,dt&&pt.setAttribute("checked",!0),pt.setAttribute("exportValue",P.exportValue),pt.tabIndex=w,pt.addEventListener("change",At=>{const{name:Tt,checked:Ot}=At.target;for(const Mt of this._getElementsByName(Tt,X)){const xt=Ot&&Mt.exportValue===P.exportValue;Mt.domElement&&(Mt.domElement.checked=xt),R.setValue(Mt.id,{value:xt})}R.setValue(X,{value:Ot})}),pt.addEventListener("resetform",At=>{const Tt=P.defaultFieldValue||"Off";At.target.checked=Tt===P.exportValue}),this.enableScripting&&this.hasJSActions&&(pt.addEventListener("updatefromsandbox",At=>{const Tt={value(Ot){Ot.target.checked=Ot.detail.value!=="Off",R.setValue(X,{value:Ot.target.checked})}};this._dispatchEventFromSandbox(Tt,At)}),this._setEventListeners(pt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],At=>At.target.checked)),this._setBackgroundColor(pt),this._setDefaultPropertiesFromJS(pt),this.container.append(pt),this.container}}class o extends u{constructor(R){super(R,{isRenderable:R.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const R=this.annotationStorage,P=this.data,X=P.id;let dt=R.getValue(X,{value:P.fieldValue===P.buttonValue}).value;typeof dt=="string"&&(dt=dt!==P.buttonValue,R.setValue(X,{value:dt}));const pt=document.createElement("input");if(B.add(pt),pt.setAttribute("data-element-id",X),pt.disabled=P.readOnly,this._setRequired(pt,this.data.required),pt.type="radio",pt.name=P.fieldName,dt&&pt.setAttribute("checked",!0),pt.tabIndex=w,pt.addEventListener("change",At=>{const{name:Tt,checked:Ot}=At.target;for(const Mt of this._getElementsByName(Tt,X))R.setValue(Mt.id,{value:!1});R.setValue(X,{value:Ot})}),pt.addEventListener("resetform",At=>{const Tt=P.defaultFieldValue;At.target.checked=Tt!=null&&Tt===P.buttonValue}),this.enableScripting&&this.hasJSActions){const At=P.buttonValue;pt.addEventListener("updatefromsandbox",Tt=>{const Ot={value:Mt=>{const xt=At===Mt.detail.value;for(const Ht of this._getElementsByName(Mt.target.name)){const Dt=xt&&Ht.id===X;Ht.domElement&&(Ht.domElement.checked=Dt),R.setValue(Ht.id,{value:Dt})}}};this._dispatchEventFromSandbox(Ot,Tt)}),this._setEventListeners(pt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Tt=>Tt.target.checked)}return this._setBackgroundColor(pt),this._setDefaultPropertiesFromJS(pt),this.container.append(pt),this.container}}class d extends T{constructor(R){super(R,{ignoreBorder:R.data.hasAppearance})}render(){const R=super.render();R.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(R.title=this.data.alternativeText);const P=R.lastChild;return this.enableScripting&&this.hasJSActions&&P&&(this._setDefaultPropertiesFromJS(P),P.addEventListener("updatefromsandbox",X=>{this._dispatchEventFromSandbox({},X)})),R}}class l extends u{constructor(R){super(R,{isRenderable:R.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const R=this.annotationStorage,P=this.data.id,X=R.getValue(P,{value:this.data.fieldValue}),dt=document.createElement("select");B.add(dt),dt.setAttribute("data-element-id",P),dt.disabled=this.data.readOnly,this._setRequired(dt,this.data.required),dt.name=this.data.fieldName,dt.tabIndex=w;let pt=this.data.combo&&this.data.options.length>0;this.data.combo||(dt.size=this.data.options.length,this.data.multiSelect&&(dt.multiple=!0)),dt.addEventListener("resetform",xt=>{const Ht=this.data.defaultFieldValue;for(const Dt of dt.options)Dt.selected=Dt.value===Ht});for(const xt of this.data.options){const Ht=document.createElement("option");Ht.textContent=xt.displayValue,Ht.value=xt.exportValue,X.value.includes(xt.exportValue)&&(Ht.setAttribute("selected",!0),pt=!1),dt.append(Ht)}let At=null;if(pt){const xt=document.createElement("option");xt.value=" ",xt.setAttribute("hidden",!0),xt.setAttribute("selected",!0),dt.prepend(xt),At=()=>{xt.remove(),dt.removeEventListener("input",At),At=null},dt.addEventListener("input",At)}const Tt=xt=>{const Ht=xt?"value":"textContent",{options:Dt,multiple:Nt}=dt;return Nt?Array.prototype.filter.call(Dt,jt=>jt.selected).map(jt=>jt[Ht]):Dt.selectedIndex===-1?null:Dt[Dt.selectedIndex][Ht]};let Ot=Tt(!1);const Mt=xt=>{const Ht=xt.target.options;return Array.prototype.map.call(Ht,Dt=>({displayValue:Dt.textContent,exportValue:Dt.value}))};return this.enableScripting&&this.hasJSActions?(dt.addEventListener("updatefromsandbox",xt=>{const Ht={value(Dt){At==null||At();const Nt=Dt.detail.value,jt=new Set(Array.isArray(Nt)?Nt:[Nt]);for(const $t of dt.options)$t.selected=jt.has($t.value);R.setValue(P,{value:Tt(!0)}),Ot=Tt(!1)},multipleSelection(Dt){dt.multiple=!0},remove(Dt){const Nt=dt.options,jt=Dt.detail.remove;Nt[jt].selected=!1,dt.remove(jt),Nt.length>0&&Array.prototype.findIndex.call(Nt,Yt=>Yt.selected)===-1&&(Nt[0].selected=!0),R.setValue(P,{value:Tt(!0),items:Mt(Dt)}),Ot=Tt(!1)},clear(Dt){for(;dt.length!==0;)dt.remove(0);R.setValue(P,{value:null,items:[]}),Ot=Tt(!1)},insert(Dt){const{index:Nt,displayValue:jt,exportValue:$t}=Dt.detail.insert,Yt=dt.children[Nt],Kt=document.createElement("option");Kt.textContent=jt,Kt.value=$t,Yt?Yt.before(Kt):dt.append(Kt),R.setValue(P,{value:Tt(!0),items:Mt(Dt)}),Ot=Tt(!1)},items(Dt){const{items:Nt}=Dt.detail;for(;dt.length!==0;)dt.remove(0);for(const jt of Nt){const{displayValue:$t,exportValue:Yt}=jt,Kt=document.createElement("option");Kt.textContent=$t,Kt.value=Yt,dt.append(Kt)}dt.options.length>0&&(dt.options[0].selected=!0),R.setValue(P,{value:Tt(!0),items:Mt(Dt)}),Ot=Tt(!1)},indices(Dt){const Nt=new Set(Dt.detail.indices);for(const jt of Dt.target.options)jt.selected=Nt.has(jt.index);R.setValue(P,{value:Tt(!0)}),Ot=Tt(!1)},editable(Dt){Dt.target.disabled=!Dt.detail.editable}};this._dispatchEventFromSandbox(Ht,xt)}),dt.addEventListener("input",xt=>{var Dt;const Ht=Tt(!0);R.setValue(P,{value:Ht}),xt.preventDefault(),(Dt=this.linkService.eventBus)==null||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Ot,changeEx:Ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(dt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],xt=>xt.target.value)):dt.addEventListener("input",function(xt){R.setValue(P,{value:Tt(!0)})}),this.data.combo&&this._setTextStyle(dt),this._setBackgroundColor(dt),this._setDefaultPropertiesFromJS(dt),this.container.append(dt),this.container}}class c extends b{constructor(R){const{data:P,elements:X}=R;super(R,{isRenderable:b._hasPopupData(P)}),this.elements=X}render(){this.container.classList.add("popupAnnotation");const R=new h({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),P=[];for(const X of this.elements)X.popup=R,P.push(X.data.id),X.addHighlightArea();return this.container.setAttribute("aria-controls",P.map(X=>`${n.AnnotationPrefix}${X}`).join(",")),this.container}}class h{constructor({container:R,color:P,elements:X,titleObj:dt,modificationDate:pt,contentsObj:At,richText:Tt,parent:Ot,rect:Mt,parentRect:xt,open:Ht}){rt(this,Pt);rt(this,st,null);rt(this,ht,Y(this,Pt,Dn).bind(this));rt(this,gt,Y(this,Pt,sn).bind(this));rt(this,yt,Y(this,Pt,nn).bind(this));rt(this,ft,Y(this,Pt,we).bind(this));rt(this,bt,null);rt(this,Z,null);rt(this,tt,null);rt(this,A,null);rt(this,N,null);rt(this,J,null);rt(this,it,!1);rt(this,mt,null);rt(this,St,null);rt(this,vt,null);rt(this,Q,null);rt(this,wt,!1);var Nt;lt(this,Z,R),lt(this,Q,dt),lt(this,tt,At),lt(this,vt,Tt),lt(this,N,Ot),lt(this,bt,P),lt(this,St,Mt),lt(this,J,xt),lt(this,A,X);const Dt=f.PDFDateString.toDateObject(pt);Dt&&lt(this,st,Ot.l10n.get("annotation_date_string",{date:Dt.toLocaleDateString(),time:Dt.toLocaleTimeString()})),this.trigger=X.flatMap(jt=>jt.getElementsToTriggerPopup());for(const jt of this.trigger)jt.addEventListener("click",t(this,ft)),jt.addEventListener("mouseenter",t(this,yt)),jt.addEventListener("mouseleave",t(this,gt)),jt.classList.add("popupTriggerArea");for(const jt of X)(Nt=jt.container)==null||Nt.addEventListener("keydown",t(this,ht));t(this,Z).hidden=!0,Ht&&Y(this,Pt,we).call(this)}render(){if(t(this,mt))return;const{page:{view:R},viewport:{rawDims:{pageWidth:P,pageHeight:X,pageX:dt,pageY:pt}}}=t(this,N),At=lt(this,mt,document.createElement("div"));if(At.className="popup",t(this,bt)){const Qt=At.style.outlineColor=n.Util.makeHexColor(...t(this,bt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?At.style.backgroundColor=`color-mix(in srgb, ${Qt} 30%, white)`:At.style.backgroundColor=n.Util.makeHexColor(...t(this,bt).map(se=>Math.floor(.7*(255-se)+se)))}const Tt=document.createElement("span");Tt.className="header";const Ot=document.createElement("h1");if(Tt.append(Ot),{dir:Ot.dir,str:Ot.textContent}=t(this,Q),At.append(Tt),t(this,st)){const Qt=document.createElement("span");Qt.classList.add("popupDate"),t(this,st).then(ee=>{Qt.textContent=ee}),Tt.append(Qt)}const Mt=t(this,tt),xt=t(this,vt);if(xt!=null&&xt.str&&(!(Mt!=null&&Mt.str)||Mt.str===xt.str))k.XfaLayer.render({xfaHtml:xt.html,intent:"richText",div:At}),At.lastChild.classList.add("richText","popupContent");else{const Qt=this._formatContents(Mt);At.append(Qt)}let Ht=!!t(this,J),Dt=Ht?t(this,J):t(this,St);for(const Qt of t(this,A))if(!Dt||n.Util.intersect(Qt.data.rect,Dt)!==null){Dt=Qt.data.rect,Ht=!0;break}const Nt=n.Util.normalizeRect([Dt[0],R[3]-Dt[1]+R[1],Dt[2],R[3]-Dt[3]+R[1]]),$t=Ht?Dt[2]-Dt[0]+5:0,Yt=Nt[0]+$t,Kt=Nt[1],{style:Zt}=t(this,Z);Zt.left=`${100*(Yt-dt)/P}%`,Zt.top=`${100*(Kt-pt)/X}%`,t(this,Z).append(At)}_formatContents({str:R,dir:P}){const X=document.createElement("p");X.classList.add("popupContent"),X.dir=P;const dt=R.split(/(?:\r\n?|\n)/);for(let pt=0,At=dt.length;pt<At;++pt){const Tt=dt[pt];X.append(document.createTextNode(Tt)),pt<At-1&&X.append(document.createElement("br"))}return X}forceHide(){lt(this,wt,this.isVisible),t(this,wt)&&(t(this,Z).hidden=!0)}maybeShow(){t(this,wt)&&(lt(this,wt,!1),t(this,Z).hidden=!1)}get isVisible(){return t(this,Z).hidden===!1}}st=new WeakMap,ht=new WeakMap,gt=new WeakMap,yt=new WeakMap,ft=new WeakMap,bt=new WeakMap,Z=new WeakMap,tt=new WeakMap,A=new WeakMap,N=new WeakMap,J=new WeakMap,it=new WeakMap,mt=new WeakMap,St=new WeakMap,vt=new WeakMap,Q=new WeakMap,wt=new WeakMap,Pt=new WeakSet,Dn=function(R){R.altKey||R.shiftKey||R.ctrlKey||R.metaKey||(R.key==="Enter"||R.key==="Escape"&&t(this,it))&&Y(this,Pt,we).call(this)},we=function(){lt(this,it,!t(this,it)),t(this,it)?(Y(this,Pt,nn).call(this),t(this,Z).addEventListener("click",t(this,ft)),t(this,Z).addEventListener("keydown",t(this,ht))):(Y(this,Pt,sn).call(this),t(this,Z).removeEventListener("click",t(this,ft)),t(this,Z).removeEventListener("keydown",t(this,ht)))},nn=function(){t(this,mt)||this.render(),this.isVisible?t(this,it)&&t(this,Z).classList.add("focused"):(t(this,Z).hidden=!1,t(this,Z).style.zIndex=parseInt(t(this,Z).style.zIndex)+1e3)},sn=function(){t(this,Z).classList.remove("focused"),!(t(this,it)||!this.isVisible)&&(t(this,Z).hidden=!0,t(this,Z).style.zIndex=parseInt(t(this,Z).style.zIndex)-1e3)};class O extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0}),this.textContent=R.data.textContent,this.textPosition=R.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const R=document.createElement("div");R.classList.add("annotationTextContent"),R.setAttribute("role","comment");for(const P of this.textContent){const X=document.createElement("span");X.textContent=P,R.append(X)}this.container.append(R)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=O;class a extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});rt(this,It,null)}render(){this.container.classList.add("lineAnnotation");const P=this.data,{width:X,height:dt}=I(P.rect),pt=this.svgFactory.create(X,dt,!0),At=lt(this,It,this.svgFactory.createElement("svg:line"));return At.setAttribute("x1",P.rect[2]-P.lineCoordinates[0]),At.setAttribute("y1",P.rect[3]-P.lineCoordinates[1]),At.setAttribute("x2",P.rect[2]-P.lineCoordinates[2]),At.setAttribute("y2",P.rect[3]-P.lineCoordinates[3]),At.setAttribute("stroke-width",P.borderStyle.width||1),At.setAttribute("stroke","transparent"),At.setAttribute("fill","transparent"),pt.append(At),this.container.append(pt),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,It)}addHighlightArea(){this.container.classList.add("highlightArea")}}It=new WeakMap;class E extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});rt(this,Gt,null)}render(){this.container.classList.add("squareAnnotation");const P=this.data,{width:X,height:dt}=I(P.rect),pt=this.svgFactory.create(X,dt,!0),At=P.borderStyle.width,Tt=lt(this,Gt,this.svgFactory.createElement("svg:rect"));return Tt.setAttribute("x",At/2),Tt.setAttribute("y",At/2),Tt.setAttribute("width",X-At),Tt.setAttribute("height",dt-At),Tt.setAttribute("stroke-width",At||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),pt.append(Tt),this.container.append(pt),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Gt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gt=new WeakMap;class x extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});rt(this,qt,null)}render(){this.container.classList.add("circleAnnotation");const P=this.data,{width:X,height:dt}=I(P.rect),pt=this.svgFactory.create(X,dt,!0),At=P.borderStyle.width,Tt=lt(this,qt,this.svgFactory.createElement("svg:ellipse"));return Tt.setAttribute("cx",X/2),Tt.setAttribute("cy",dt/2),Tt.setAttribute("rx",X/2-At/2),Tt.setAttribute("ry",dt/2-At/2),Tt.setAttribute("stroke-width",At||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),pt.append(Tt),this.container.append(pt),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,qt)}addHighlightArea(){this.container.classList.add("highlightArea")}}qt=new WeakMap;class et extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});rt(this,Et,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:X,height:dt}=I(P.rect),pt=this.svgFactory.create(X,dt,!0);let At=[];for(const Ot of P.vertices){const Mt=Ot.x-P.rect[0],xt=P.rect[3]-Ot.y;At.push(Mt+","+xt)}At=At.join(" ");const Tt=lt(this,Et,this.svgFactory.createElement(this.svgElementName));return Tt.setAttribute("points",At),Tt.setAttribute("stroke-width",P.borderStyle.width||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),pt.append(Tt),this.container.append(pt),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Et)}addHighlightArea(){this.container.classList.add("highlightArea")}}Et=new WeakMap;class $ extends et{constructor(R){super(R),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class G extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});rt(this,ot,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:X,height:dt}=I(P.rect),pt=this.svgFactory.create(X,dt,!0);for(const At of P.inkLists){let Tt=[];for(const Mt of At){const xt=Mt.x-P.rect[0],Ht=P.rect[3]-Mt.y;Tt.push(`${xt},${Ht}`)}Tt=Tt.join(" ");const Ot=this.svgFactory.createElement(this.svgElementName);t(this,ot).push(Ot),Ot.setAttribute("points",Tt),Ot.setAttribute("stroke-width",P.borderStyle.width||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),!P.popupRef&&this.hasPopupData&&this._createPopup(),pt.append(Ot)}return this.container.append(pt),this.container}getElementsToTriggerPopup(){return t(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap,e.InkAnnotationElement=G;class at extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class C extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class V extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class nt extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class S extends b{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=S;class s extends b{constructor(P){var pt;super(P,{isRenderable:!0});rt(this,kt);rt(this,ct,null);const{filename:X,content:dt}=this.data.file;this.filename=(0,f.getFilenameFromUrl)(X,!0),this.content=dt,(pt=this.linkService.eventBus)==null||pt.dispatch("fileattachmentannotation",{source:this,filename:X,content:dt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:P,data:X}=this;let dt;X.hasAppearance||X.fillAlpha===0?dt=document.createElement("div"):(dt=document.createElement("img"),dt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(X.name)?"paperclip":"pushpin"}.svg`,X.fillAlpha&&X.fillAlpha<1&&(dt.style=`filter: opacity(${Math.round(X.fillAlpha*100)}%);`)),dt.addEventListener("dblclick",Y(this,kt,rn).bind(this)),lt(this,ct,dt);const{isMac:pt}=n.FeatureTest.platform;return P.addEventListener("keydown",At=>{At.key==="Enter"&&(pt?At.metaKey:At.ctrlKey)&&Y(this,kt,rn).call(this)}),!X.popupRef&&this.hasPopupData?this._createPopup():dt.classList.add("popupTriggerArea"),P.append(dt),P}getElementsToTriggerPopup(){return t(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap,kt=new WeakSet,rn=function(){var P;(P=this.downloadManager)==null||P.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:R,accessibilityManager:P,annotationCanvasMap:X,l10n:dt,page:pt,viewport:At}){rt(this,Ct);rt(this,Vt,null);rt(this,j,null);rt(this,_t,new Map);this.div=R,lt(this,Vt,P),lt(this,j,X),this.l10n=dt,this.page=pt,this.viewport=At,this.zIndex=0,this.l10n||(this.l10n=ut.NullL10n)}async render(R){const{annotations:P}=R,X=this.div;(0,f.setLayerDimensions)(X,this.viewport);const dt=new Map,pt={data:null,layer:X,linkService:R.linkService,downloadManager:R.downloadManager,imageResourcesPath:R.imageResourcesPath||"",renderForms:R.renderForms!==!1,svgFactory:new f.DOMSVGFactory,annotationStorage:R.annotationStorage||new z.AnnotationStorage,enableScripting:R.enableScripting===!0,hasJSActions:R.hasJSActions,fieldObjects:R.fieldObjects,parent:this,elements:null};for(const At of P){if(At.noHTML)continue;const Tt=At.annotationType===n.AnnotationType.POPUP;if(Tt){const xt=dt.get(At.id);if(!xt)continue;pt.elements=xt}else{const{width:xt,height:Ht}=I(At.rect);if(xt<=0||Ht<=0)continue}pt.data=At;const Ot=_.create(pt);if(!Ot.isRenderable)continue;if(!Tt&&At.popupRef){const xt=dt.get(At.popupRef);xt?xt.push(Ot):dt.set(At.popupRef,[Ot])}Ot.annotationEditorType>0&&t(this,_t).set(Ot.data.id,Ot);const Mt=Ot.render();At.hidden&&(Mt.style.visibility="hidden"),Y(this,Ct,Ln).call(this,Mt,At.id)}Y(this,Ct,an).call(this),await this.l10n.translate(X)}update({viewport:R}){const P=this.div;this.viewport=R,(0,f.setLayerDimensions)(P,{rotation:R.rotation}),Y(this,Ct,an).call(this),P.hidden=!1}getEditableAnnotations(){return Array.from(t(this,_t).values())}getEditableAnnotation(R){return t(this,_t).get(R)}}Vt=new WeakMap,j=new WeakMap,_t=new WeakMap,Ct=new WeakSet,Ln=function(R,P){var dt;const X=R.firstChild||R;X.id=`${n.AnnotationPrefix}${P}`,this.div.append(R),(dt=t(this,Vt))==null||dt.moveElementInDOM(this.div,R,X,!1)},an=function(){if(!t(this,j))return;const R=this.div;for(const[P,X]of t(this,j)){const dt=R.querySelector(`[data-annotation-id="${P}"]`);if(!dt)continue;const{firstChild:pt}=dt;pt?pt.nodeName==="CANVAS"?pt.replaceWith(X):pt.before(X):dt.append(X)}t(this,j).clear()},e.AnnotationLayer=i},(U,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function W(z){return Math.floor(Math.max(0,Math.min(1,z))*255).toString(16).padStart(2,"0")}function n(z){return Math.max(0,Math.min(255,255*z))}class f{static CMYK_G([H,ut,k,w]){return["G",1-Math.min(1,.3*H+.59*k+.11*ut+w)]}static G_CMYK([H]){return["CMYK",0,0,0,1-H]}static G_RGB([H]){return["RGB",H,H,H]}static G_rgb([H]){return H=n(H),[H,H,H]}static G_HTML([H]){const ut=W(H);return`#${ut}${ut}${ut}`}static RGB_G([H,ut,k]){return["G",.3*H+.59*ut+.11*k]}static RGB_rgb(H){return H.map(n)}static RGB_HTML(H){return`#${H.map(W).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([H,ut,k,w]){return["RGB",1-Math.min(1,H+w),1-Math.min(1,k+w),1-Math.min(1,ut+w)]}static CMYK_rgb([H,ut,k,w]){return[n(1-Math.min(1,H+w)),n(1-Math.min(1,k+w)),n(1-Math.min(1,ut+w))]}static CMYK_HTML(H){const ut=this.CMYK_RGB(H).slice(1);return this.RGB_HTML(ut)}static RGB_CMYK([H,ut,k]){const w=1-H,m=1-ut,B=1-k,I=Math.min(w,m,B);return["CMYK",w,m,B,I]}}e.ColorConverters=f},(U,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const W={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};W.print_progress_percent="{{progress}}%";function n(H,ut){switch(H){case"find_match_count":H=`find_match_count[${ut.total===1?"one":"other"}]`;break;case"find_match_count_limit":H=`find_match_count_limit[${ut.limit===1?"one":"other"}]`;break}return W[H]||""}function f(H,ut){return ut?H.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(k,w)=>w in ut?ut[w]:"{{"+w+"}}"):H}const z={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(H,ut=null,k=n(H,ut)){return f(k,ut)},async translate(H){}};e.NullL10n=z},(U,e,W)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=W(25);class f{static setupStorage(H,ut,k,w,m){const B=w.getValue(ut,{value:null});switch(k.name){case"textarea":if(B.value!==null&&(H.textContent=B.value),m==="print")break;H.addEventListener("input",I=>{w.setValue(ut,{value:I.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(B.value===k.attributes.xfaOn?H.setAttribute("checked",!0):B.value===k.attributes.xfaOff&&H.removeAttribute("checked"),m==="print")break;H.addEventListener("change",I=>{w.setValue(ut,{value:I.target.checked?I.target.getAttribute("xfaOn"):I.target.getAttribute("xfaOff")})})}else{if(B.value!==null&&H.setAttribute("value",B.value),m==="print")break;H.addEventListener("input",I=>{w.setValue(ut,{value:I.target.value})})}break;case"select":if(B.value!==null){H.setAttribute("value",B.value);for(const I of k.children)I.attributes.value===B.value?I.attributes.selected=!0:I.attributes.hasOwnProperty("selected")&&delete I.attributes.selected}H.addEventListener("input",I=>{const _=I.target.options,b=_.selectedIndex===-1?"":_[_.selectedIndex].value;w.setValue(ut,{value:b})});break}}static setAttributes({html:H,element:ut,storage:k=null,intent:w,linkService:m}){const{attributes:B}=ut,I=H instanceof HTMLAnchorElement;B.type==="radio"&&(B.name=`${B.name}-${w}`);for(const[_,b]of Object.entries(B))if(b!=null)switch(_){case"class":b.length&&H.setAttribute(_,b.join(" "));break;case"dataId":break;case"id":H.setAttribute("data-element-id",b);break;case"style":Object.assign(H.style,b);break;case"textContent":H.textContent=b;break;default:(!I||_!=="href"&&_!=="newWindow")&&H.setAttribute(_,b)}I&&m.addLinkAttributes(H,B.href,B.newWindow),k&&B.dataId&&this.setupStorage(H,B.dataId,ut,k)}static render(H){var T;const ut=H.annotationStorage,k=H.linkService,w=H.xfaHtml,m=H.intent||"display",B=document.createElement(w.name);w.attributes&&this.setAttributes({html:B,element:w,intent:m,linkService:k});const I=[[w,-1,B]],_=H.div;if(_.append(B),H.viewport){const g=`matrix(${H.viewport.transform.join(",")})`;_.style.transform=g}m!=="richText"&&_.setAttribute("class","xfaLayer xfaFont");const b=[];for(;I.length>0;){const[g,u,y]=I.at(-1);if(u+1===g.children.length){I.pop();continue}const D=g.children[++I.at(-1)[1]];if(D===null)continue;const{name:v}=D;if(v==="#text"){const d=document.createTextNode(D.value);b.push(d),y.append(d);continue}const o=(T=D==null?void 0:D.attributes)!=null&&T.xmlns?document.createElementNS(D.attributes.xmlns,v):document.createElement(v);if(y.append(o),D.attributes&&this.setAttributes({html:o,element:D,storage:ut,intent:m,linkService:k}),D.children&&D.children.length>0)I.push([D,-1,o]);else if(D.value){const d=document.createTextNode(D.value);n.XfaText.shouldBuildText(v)&&b.push(d),o.append(d)}}for(const g of _.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:b}}static update(H){const ut=`matrix(${H.viewport.transform.join(",")})`;H.div.style.transform=ut,H.div.hidden=!1}}e.XfaLayer=f},(U,e,W)=>{var w,m,B,I,_,b,T,g,u,y,D,v,o,d,l,On,In,Nn,Bn,on,Un,ln,jn,Wn,Hn,Gn,$n,ne,cn,Ce,xe,ce,hn,Re,M,Vn,dn,zn,Xn,un,ke,he;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=W(1),f=W(4),z=W(29),H=W(6),ut=W(5);const bt=class bt extends f.AnnotationEditor{constructor(A){super({...A,name:"inkEditor"});rt(this,l);rt(this,w,0);rt(this,m,0);rt(this,B,this.canvasPointermove.bind(this));rt(this,I,this.canvasPointerleave.bind(this));rt(this,_,this.canvasPointerup.bind(this));rt(this,b,this.canvasPointerdown.bind(this));rt(this,T,new Path2D);rt(this,g,!1);rt(this,u,!1);rt(this,y,!1);rt(this,D,null);rt(this,v,0);rt(this,o,0);rt(this,d,null);this.color=A.color||null,this.thickness=A.thickness||null,this.opacity=A.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(A){f.AnnotationEditor.initialize(A,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(A,N){switch(A){case n.AnnotationEditorParamsType.INK_THICKNESS:bt._defaultThickness=N;break;case n.AnnotationEditorParamsType.INK_COLOR:bt._defaultColor=N;break;case n.AnnotationEditorParamsType.INK_OPACITY:bt._defaultOpacity=N/100;break}}updateParams(A,N){switch(A){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,l,On).call(this,N);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,l,In).call(this,N);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,l,Nn).call(this,N);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,bt._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,bt._defaultColor||f.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(bt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||bt._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||bt._defaultColor||f.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??bt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,l,Ce).call(this),Y(this,l,xe).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,l,ce).call(this)),Y(this,l,he).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,D).disconnect(),lt(this,D,null),super.remove())}setParent(A){!this.parent&&A?this._uiManager.removeShouldRescale(this):this.parent&&A===null&&this._uiManager.addShouldRescale(this),super.setParent(A)}onScaleChanging(){const[A,N]=this.parentDimensions,J=this.width*A,it=this.height*N;this.setDimensions(J,it)}enableEditMode(){t(this,g)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,b)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,b)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lt(this,g,!0),this.div.classList.add("disabled"),Y(this,l,he).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(A){this._focusEventsAllowed&&(super.focusin(A),this.enableEditMode())}canvasPointerdown(A){A.button!==0||!this.isInEditMode()||t(this,g)||(this.setInForeground(),A.preventDefault(),A.type!=="mouse"&&this.div.focus(),Y(this,l,Un).call(this,A.offsetX,A.offsetY))}canvasPointermove(A){A.preventDefault(),Y(this,l,ln).call(this,A.offsetX,A.offsetY)}canvasPointerup(A){A.preventDefault(),Y(this,l,cn).call(this,A)}canvasPointerleave(A){Y(this,l,cn).call(this,A)}get isResizable(){return!this.isEmpty()&&t(this,g)}render(){if(this.div)return this.div;let A,N;this.width&&(A=this.x,N=this.y),super.render(),f.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(vt=>{var Q;return(Q=this.div)==null?void 0:Q.setAttribute("aria-label",vt)});const[J,it,mt,St]=Y(this,l,Bn).call(this);if(this.setAt(J,it,0,0),this.setDims(mt,St),Y(this,l,Ce).call(this),this.width){const[vt,Q]=this.parentDimensions;this.setAspectRatio(this.width*vt,this.height*Q),this.setAt(A*vt,N*Q,this.width*vt,this.height*Q),lt(this,y,!0),Y(this,l,ce).call(this),this.setDims(this.width*vt,this.height*Q),Y(this,l,ne).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,l,xe).call(this),this.div}setDimensions(A,N){const J=Math.round(A),it=Math.round(N);if(t(this,v)===J&&t(this,o)===it)return;lt(this,v,J),lt(this,o,it),this.canvas.style.visibility="hidden";const[mt,St]=this.parentDimensions;this.width=A/mt,this.height=N/St,this.fixAndSetPosition(),t(this,g)&&Y(this,l,hn).call(this,A,N),Y(this,l,ce).call(this),Y(this,l,ne).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(A,N,J){var It,Gt,qt;if(A instanceof z.InkAnnotationElement)return null;const it=super.deserialize(A,N,J);it.thickness=A.thickness,it.color=n.Util.makeHexColor(...A.color),it.opacity=A.opacity;const[mt,St]=it.pageDimensions,vt=it.width*mt,Q=it.height*St,wt=it.parentScale,Pt=A.thickness/2;lt(it,g,!0),lt(it,v,Math.round(vt)),lt(it,o,Math.round(Q));const{paths:Wt,rect:Ut,rotation:zt}=A;for(let{bezier:Et}of Wt){Et=Y(It=bt,M,zn).call(It,Et,Ut,zt);const ot=[];it.paths.push(ot);let ct=wt*(Et[0]-Pt),kt=wt*(Et[1]-Pt);for(let Vt=2,j=Et.length;Vt<j;Vt+=6){const _t=wt*(Et[Vt]-Pt),Ct=wt*(Et[Vt+1]-Pt),Lt=wt*(Et[Vt+2]-Pt),Bt=wt*(Et[Vt+3]-Pt),Rt=wt*(Et[Vt+4]-Pt),R=wt*(Et[Vt+5]-Pt);ot.push([[ct,kt],[_t,Ct],[Lt,Bt],[Rt,R]]),ct=Rt,kt=R}const Xt=Y(this,M,Vn).call(this,ot);it.bezierPath2D.push(Xt)}const Ft=Y(Gt=it,l,un).call(Gt);return lt(it,m,Math.max(f.AnnotationEditor.MIN_SIZE,Ft[2]-Ft[0])),lt(it,w,Math.max(f.AnnotationEditor.MIN_SIZE,Ft[3]-Ft[1])),Y(qt=it,l,hn).call(qt,vt,Q),it}serialize(){if(this.isEmpty())return null;const A=this.getRect(0,0),N=f.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:N,thickness:this.thickness,opacity:this.opacity,paths:Y(this,l,Xn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,A),pageIndex:this.pageIndex,rect:A,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};w=new WeakMap,m=new WeakMap,B=new WeakMap,I=new WeakMap,_=new WeakMap,b=new WeakMap,T=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,D=new WeakMap,v=new WeakMap,o=new WeakMap,d=new WeakMap,l=new WeakSet,On=function(A){const N=this.thickness;this.addCommands({cmd:()=>{this.thickness=A,Y(this,l,he).call(this)},undo:()=>{this.thickness=N,Y(this,l,he).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},In=function(A){const N=this.color;this.addCommands({cmd:()=>{this.color=A,Y(this,l,ne).call(this)},undo:()=>{this.color=N,Y(this,l,ne).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Nn=function(A){A/=100;const N=this.opacity;this.addCommands({cmd:()=>{this.opacity=A,Y(this,l,ne).call(this)},undo:()=>{this.opacity=N,Y(this,l,ne).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Bn=function(){const{parentRotation:A,parentDimensions:[N,J]}=this;switch(A){case 90:return[0,J,J,N];case 180:return[N,J,N,J];case 270:return[N,0,J,N];default:return[0,0,N,J]}},on=function(){const{ctx:A,color:N,opacity:J,thickness:it,parentScale:mt,scaleFactor:St}=this;A.lineWidth=it*mt/St,A.lineCap="round",A.lineJoin="round",A.miterLimit=10,A.strokeStyle=`${N}${(0,ut.opacityToHex)(J)}`},Un=function(A,N){this.canvas.addEventListener("contextmenu",H.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,I)),this.canvas.addEventListener("pointermove",t(this,B)),this.canvas.addEventListener("pointerup",t(this,_)),this.canvas.removeEventListener("pointerdown",t(this,b)),this.isEditing=!0,t(this,y)||(lt(this,y,!0),Y(this,l,ce).call(this),this.thickness||(this.thickness=bt._defaultThickness),this.color||(this.color=bt._defaultColor||f.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=bt._defaultOpacity)),this.currentPath.push([A,N]),lt(this,u,!1),Y(this,l,on).call(this),lt(this,d,()=>{Y(this,l,Hn).call(this),t(this,d)&&window.requestAnimationFrame(t(this,d))}),window.requestAnimationFrame(t(this,d))},ln=function(A,N){const[J,it]=this.currentPath.at(-1);if(this.currentPath.length>1&&A===J&&N===it)return;const mt=this.currentPath;let St=t(this,T);if(mt.push([A,N]),lt(this,u,!0),mt.length<=2){St.moveTo(...mt[0]),St.lineTo(A,N);return}mt.length===3&&(lt(this,T,St=new Path2D),St.moveTo(...mt[0])),Y(this,l,Gn).call(this,St,...mt.at(-3),...mt.at(-2),A,N)},jn=function(){if(this.currentPath.length===0)return;const A=this.currentPath.at(-1);t(this,T).lineTo(...A)},Wn=function(A,N){lt(this,d,null),A=Math.min(Math.max(A,0),this.canvas.width),N=Math.min(Math.max(N,0),this.canvas.height),Y(this,l,ln).call(this,A,N),Y(this,l,jn).call(this);let J;if(this.currentPath.length!==1)J=Y(this,l,$n).call(this);else{const Q=[A,N];J=[[Q,Q.slice(),Q.slice(),Q]]}const it=t(this,T),mt=this.currentPath;this.currentPath=[],lt(this,T,new Path2D);const St=()=>{this.allRawPaths.push(mt),this.paths.push(J),this.bezierPath2D.push(it),this.rebuild()},vt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,l,Ce).call(this),Y(this,l,xe).call(this)),Y(this,l,he).call(this))};this.addCommands({cmd:St,undo:vt,mustExec:!0})},Hn=function(){if(!t(this,u))return;lt(this,u,!1);const A=Math.ceil(this.thickness*this.parentScale),N=this.currentPath.slice(-3),J=N.map(St=>St[0]),it=N.map(St=>St[1]);Math.min(...J)-A,Math.max(...J)+A,Math.min(...it)-A,Math.max(...it)+A;const{ctx:mt}=this;mt.save(),mt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const St of this.bezierPath2D)mt.stroke(St);mt.stroke(t(this,T)),mt.restore()},Gn=function(A,N,J,it,mt,St,vt){const Q=(N+it)/2,wt=(J+mt)/2,Pt=(it+St)/2,Wt=(mt+vt)/2;A.bezierCurveTo(Q+2*(it-Q)/3,wt+2*(mt-wt)/3,Pt+2*(it-Pt)/3,Wt+2*(mt-Wt)/3,Pt,Wt)},$n=function(){const A=this.currentPath;if(A.length<=2)return[[A[0],A[0],A.at(-1),A.at(-1)]];const N=[];let J,[it,mt]=A[0];for(J=1;J<A.length-2;J++){const[Ut,zt]=A[J],[Ft,It]=A[J+1],Gt=(Ut+Ft)/2,qt=(zt+It)/2,Et=[it+2*(Ut-it)/3,mt+2*(zt-mt)/3],ot=[Gt+2*(Ut-Gt)/3,qt+2*(zt-qt)/3];N.push([[it,mt],Et,ot,[Gt,qt]]),[it,mt]=[Gt,qt]}const[St,vt]=A[J],[Q,wt]=A[J+1],Pt=[it+2*(St-it)/3,mt+2*(vt-mt)/3],Wt=[Q+2*(St-Q)/3,wt+2*(vt-wt)/3];return N.push([[it,mt],Pt,Wt,[Q,wt]]),N},ne=function(){if(this.isEmpty()){Y(this,l,Re).call(this);return}Y(this,l,on).call(this);const{canvas:A,ctx:N}=this;N.setTransform(1,0,0,1,0,0),N.clearRect(0,0,A.width,A.height),Y(this,l,Re).call(this);for(const J of this.bezierPath2D)N.stroke(J)},cn=function(A){this.canvas.removeEventListener("pointerleave",t(this,I)),this.canvas.removeEventListener("pointermove",t(this,B)),this.canvas.removeEventListener("pointerup",t(this,_)),this.canvas.addEventListener("pointerdown",t(this,b)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",H.noContextMenu)},10),Y(this,l,Wn).call(this,A.offsetX,A.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ce=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",f.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(A=>{var N;return(N=this.canvas)==null?void 0:N.setAttribute("aria-label",A)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},xe=function(){lt(this,D,new ResizeObserver(A=>{const N=A[0].contentRect;N.width&&N.height&&this.setDimensions(N.width,N.height)})),t(this,D).observe(this.div)},ce=function(){if(!t(this,y))return;const[A,N]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*A),this.canvas.height=Math.ceil(this.height*N),Y(this,l,Re).call(this)},hn=function(A,N){const J=Y(this,l,ke).call(this),it=(A-J)/t(this,m),mt=(N-J)/t(this,w);this.scaleFactor=Math.min(it,mt)},Re=function(){const A=Y(this,l,ke).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+A,this.translationY*this.scaleFactor+A)},M=new WeakSet,Vn=function(A){const N=new Path2D;for(let J=0,it=A.length;J<it;J++){const[mt,St,vt,Q]=A[J];J===0&&N.moveTo(...mt),N.bezierCurveTo(St[0],St[1],vt[0],vt[1],Q[0],Q[1])}return N},dn=function(A,N,J){const[it,mt,St,vt]=N;switch(J){case 0:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]+=it,A[Q+1]=vt-A[Q+1];break;case 90:for(let Q=0,wt=A.length;Q<wt;Q+=2){const Pt=A[Q];A[Q]=A[Q+1]+it,A[Q+1]=Pt+mt}break;case 180:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]=St-A[Q],A[Q+1]+=mt;break;case 270:for(let Q=0,wt=A.length;Q<wt;Q+=2){const Pt=A[Q];A[Q]=St-A[Q+1],A[Q+1]=vt-Pt}break;default:throw new Error("Invalid rotation")}return A},zn=function(A,N,J){const[it,mt,St,vt]=N;switch(J){case 0:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]-=it,A[Q+1]=vt-A[Q+1];break;case 90:for(let Q=0,wt=A.length;Q<wt;Q+=2){const Pt=A[Q];A[Q]=A[Q+1]-mt,A[Q+1]=Pt-it}break;case 180:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]=St-A[Q],A[Q+1]-=mt;break;case 270:for(let Q=0,wt=A.length;Q<wt;Q+=2){const Pt=A[Q];A[Q]=vt-A[Q+1],A[Q+1]=St-Pt}break;default:throw new Error("Invalid rotation")}return A},Xn=function(A,N,J,it){var wt,Pt;const mt=[],St=this.thickness/2,vt=A*N+St,Q=A*J+St;for(const Wt of this.paths){const Ut=[],zt=[];for(let Ft=0,It=Wt.length;Ft<It;Ft++){const[Gt,qt,Et,ot]=Wt[Ft],ct=A*Gt[0]+vt,kt=A*Gt[1]+Q,Xt=A*qt[0]+vt,Vt=A*qt[1]+Q,j=A*Et[0]+vt,_t=A*Et[1]+Q,Ct=A*ot[0]+vt,Lt=A*ot[1]+Q;Ft===0&&(Ut.push(ct,kt),zt.push(ct,kt)),Ut.push(Xt,Vt,j,_t,Ct,Lt),zt.push(Xt,Vt),Ft===It-1&&zt.push(Ct,Lt)}mt.push({bezier:Y(wt=bt,M,dn).call(wt,Ut,it,this.rotation),points:Y(Pt=bt,M,dn).call(Pt,zt,it,this.rotation)})}return mt},un=function(){let A=1/0,N=-1/0,J=1/0,it=-1/0;for(const mt of this.paths)for(const[St,vt,Q,wt]of mt){const Pt=n.Util.bezierBoundingBox(...St,...vt,...Q,...wt);A=Math.min(A,Pt[0]),J=Math.min(J,Pt[1]),N=Math.max(N,Pt[2]),it=Math.max(it,Pt[3])}return[A,J,N,it]},ke=function(){return t(this,g)?Math.ceil(this.thickness*this.parentScale):0},he=function(A=!1){if(this.isEmpty())return;if(!t(this,g)){Y(this,l,ne).call(this);return}const N=Y(this,l,un).call(this),J=Y(this,l,ke).call(this);lt(this,m,Math.max(f.AnnotationEditor.MIN_SIZE,N[2]-N[0])),lt(this,w,Math.max(f.AnnotationEditor.MIN_SIZE,N[3]-N[1]));const it=Math.ceil(J+t(this,m)*this.scaleFactor),mt=Math.ceil(J+t(this,w)*this.scaleFactor),[St,vt]=this.parentDimensions;this.width=it/St,this.height=mt/vt,this.setAspectRatio(it,mt);const Q=this.translationX,wt=this.translationY;this.translationX=-N[0],this.translationY=-N[1],Y(this,l,ce).call(this),Y(this,l,ne).call(this),lt(this,v,it),lt(this,o,mt),this.setDims(it,mt);const Pt=A?J/this.scaleFactor/2:0;this.translate(Q-this.translationX-Pt,wt-this.translationY-Pt)},rt(bt,M),Jt(bt,"_defaultColor",null),Jt(bt,"_defaultOpacity",1),Jt(bt,"_defaultThickness",1),Jt(bt,"_type","ink");let k=bt;e.InkEditor=k},(U,e,W)=>{var k,w,m,B,I,_,b,T,g,u,y,be,_e,Fe,fn,qn,Yn,pn,Me,Kn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=W(1),f=W(4),z=W(6),H=W(29);const E=class E extends f.AnnotationEditor{constructor($){super({...$,name:"stampEditor"});rt(this,y);rt(this,k,null);rt(this,w,null);rt(this,m,null);rt(this,B,null);rt(this,I,null);rt(this,_,null);rt(this,b,null);rt(this,T,null);rt(this,g,!1);rt(this,u,!1);lt(this,B,$.bitmapUrl),lt(this,I,$.bitmapFile)}static initialize($){f.AnnotationEditor.initialize($)}static get supportedTypes(){const $=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",$.map(K=>`image/${K}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting($){return this.supportedTypes.includes($)}static paste($,K){K.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:$.getAsFile()})}remove(){var $,K;t(this,w)&&(lt(this,k,null),this._uiManager.imageManager.deleteId(t(this,w)),($=t(this,_))==null||$.remove(),lt(this,_,null),(K=t(this,b))==null||K.disconnect(),lt(this,b,null)),super.remove()}rebuild(){if(!this.parent){t(this,w)&&Y(this,y,Fe).call(this);return}super.rebuild(),this.div!==null&&(t(this,w)&&Y(this,y,Fe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,k)||t(this,B)||t(this,I))}get isResizable(){return!0}render(){if(this.div)return this.div;let $,K;if(this.width&&($=this.x,K=this.y),super.render(),this.div.hidden=!0,t(this,k)?Y(this,y,fn).call(this):Y(this,y,Fe).call(this),this.width){const[G,at]=this.parentDimensions;this.setAt($*G,K*at,this.width*G,this.height*at)}return this.div}static deserialize($,K,G){if($ instanceof H.StampAnnotationElement)return null;const at=super.deserialize($,K,G),{rect:C,bitmapUrl:V,bitmapId:nt,isSvg:S,accessibilityData:s}=$;nt&&G.imageManager.isValidId(nt)?lt(at,w,nt):lt(at,B,V),lt(at,g,S);const[i,p]=at.pageDimensions;return at.width=(C[2]-C[0])/i,at.height=(C[3]-C[1])/p,s&&(at.altTextData=s),at}serialize($=!1,K=null){if(this.isEmpty())return null;const G={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,w),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,g),structTreeParentId:this._structTreeParentId};if($)return G.bitmapUrl=Y(this,y,Me).call(this,!0),G.accessibilityData=this.altTextData,G;const{decorative:at,altText:C}=this.altTextData;if(!at&&C&&(G.accessibilityData={type:"Figure",alt:C}),K===null)return G;K.stamps||(K.stamps=new Map);const V=t(this,g)?(G.rect[2]-G.rect[0])*(G.rect[3]-G.rect[1]):null;if(!K.stamps.has(t(this,w)))K.stamps.set(t(this,w),{area:V,serialized:G}),G.bitmap=Y(this,y,Me).call(this,!1);else if(t(this,g)){const nt=K.stamps.get(t(this,w));V>nt.area&&(nt.area=V,nt.serialized.bitmap.close(),nt.serialized.bitmap=Y(this,y,Me).call(this,!1))}return G}};k=new WeakMap,w=new WeakMap,m=new WeakMap,B=new WeakMap,I=new WeakMap,_=new WeakMap,b=new WeakMap,T=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakSet,be=function($,K=!1){if(!$){this.remove();return}lt(this,k,$.bitmap),K||(lt(this,w,$.id),lt(this,g,$.isSvg)),Y(this,y,fn).call(this)},_e=function(){lt(this,m,null),this._uiManager.enableWaiting(!1),t(this,_)&&this.div.focus()},Fe=function(){if(t(this,w)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,w)).then(K=>Y(this,y,be).call(this,K,!0)).finally(()=>Y(this,y,_e).call(this));return}if(t(this,B)){const K=t(this,B);lt(this,B,null),this._uiManager.enableWaiting(!0),lt(this,m,this._uiManager.imageManager.getFromUrl(K).then(G=>Y(this,y,be).call(this,G)).finally(()=>Y(this,y,_e).call(this)));return}if(t(this,I)){const K=t(this,I);lt(this,I,null),this._uiManager.enableWaiting(!0),lt(this,m,this._uiManager.imageManager.getFromFile(K).then(G=>Y(this,y,be).call(this,G)).finally(()=>Y(this,y,_e).call(this)));return}const $=document.createElement("input");$.type="file",$.accept=E.supportedTypesStr,lt(this,m,new Promise(K=>{$.addEventListener("change",async()=>{if(!$.files||$.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const G=await this._uiManager.imageManager.getFromFile($.files[0]);Y(this,y,be).call(this,G)}K()}),$.addEventListener("cancel",()=>{this.remove(),K()})}).finally(()=>Y(this,y,_e).call(this))),$.click()},fn=function(){const{div:$}=this;let{width:K,height:G}=t(this,k);const[at,C]=this.pageDimensions,V=.75;if(this.width)K=this.width*at,G=this.height*C;else if(K>V*at||G>V*C){const i=Math.min(V*at/K,V*C/G);K*=i,G*=i}const[nt,S]=this.parentDimensions;this.setDims(K*nt/at,G*S/C),this._uiManager.enableWaiting(!1);const s=lt(this,_,document.createElement("canvas"));$.append(s),$.hidden=!1,Y(this,y,pn).call(this,K,G),Y(this,y,Kn).call(this),t(this,u)||(this.parent.addUndoableEditor(this),lt(this,u,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},qn=function($,K){var V;const[G,at]=this.parentDimensions;this.width=$/G,this.height=K/at,this.setDims($,K),(V=this._initialOptions)!=null&&V.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,T)!==null&&clearTimeout(t(this,T)),lt(this,T,setTimeout(()=>{lt(this,T,null),Y(this,y,pn).call(this,$,K)},200))},Yn=function($,K){const{width:G,height:at}=t(this,k);let C=G,V=at,nt=t(this,k);for(;C>2*$||V>2*K;){const S=C,s=V;C>2*$&&(C=C>=16384?Math.floor(C/2)-1:Math.ceil(C/2)),V>2*K&&(V=V>=16384?Math.floor(V/2)-1:Math.ceil(V/2));const i=new OffscreenCanvas(C,V);i.getContext("2d").drawImage(nt,0,0,S,s,0,0,C,V),nt=i.transferToImageBitmap()}return nt},pn=function($,K){$=Math.ceil($),K=Math.ceil(K);const G=t(this,_);if(!G||G.width===$&&G.height===K)return;G.width=$,G.height=K;const at=t(this,g)?t(this,k):Y(this,y,Yn).call(this,$,K),C=G.getContext("2d");C.filter=this._uiManager.hcmFilter,C.drawImage(at,0,0,at.width,at.height,0,0,$,K)},Me=function($){if($){if(t(this,g)){const at=this._uiManager.imageManager.getSvgUrl(t(this,w));if(at)return at}const K=document.createElement("canvas");return{width:K.width,height:K.height}=t(this,k),K.getContext("2d").drawImage(t(this,k),0,0),K.toDataURL()}if(t(this,g)){const[K,G]=this.pageDimensions,at=Math.round(this.width*K*z.PixelsPerInch.PDF_TO_CSS_UNITS),C=Math.round(this.height*G*z.PixelsPerInch.PDF_TO_CSS_UNITS),V=new OffscreenCanvas(at,C);return V.getContext("2d").drawImage(t(this,k),0,0,t(this,k).width,t(this,k).height,0,0,at,C),V.transferToImageBitmap()}return structuredClone(t(this,k))},Kn=function(){lt(this,b,new ResizeObserver($=>{const K=$[0].contentRect;K.width&&K.height&&Y(this,y,qn).call(this,K.width,K.height)})),t(this,b).observe(this.div)},Jt(E,"_type","stamp");let ut=E;e.StampEditor=ut}],__webpack_module_cache__={};function __w_pdfjs_require__(U){var e=__webpack_module_cache__[U];if(e!==void 0)return e.exports;var W=__webpack_module_cache__[U]={exports:{}};return __webpack_modules__[U](W,W.exports,__w_pdfjs_require__),W.exports}var __webpack_exports__={};return(()=>{var U=__webpack_exports__;Object.defineProperty(U,"__esModule",{value:!0}),Object.defineProperty(U,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(U,"AnnotationEditorLayer",{enumerable:!0,get:function(){return z.AnnotationEditorLayer}}),Object.defineProperty(U,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(U,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(U,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return H.AnnotationEditorUIManager}}),Object.defineProperty(U,"AnnotationLayer",{enumerable:!0,get:function(){return ut.AnnotationLayer}}),Object.defineProperty(U,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(U,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(U,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(U,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(U,"GlobalWorkerOptions",{enumerable:!0,get:function(){return k.GlobalWorkerOptions}}),Object.defineProperty(U,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(U,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(U,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(U,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(U,"PDFDataRangeTransport",{enumerable:!0,get:function(){return W.PDFDataRangeTransport}}),Object.defineProperty(U,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(U,"PDFWorker",{enumerable:!0,get:function(){return W.PDFWorker}}),Object.defineProperty(U,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(U,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(U,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(U,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(U,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(U,"SVGGraphics",{enumerable:!0,get:function(){return W.SVGGraphics}}),Object.defineProperty(U,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(U,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(U,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(U,"XfaLayer",{enumerable:!0,get:function(){return w.XfaLayer}}),Object.defineProperty(U,"build",{enumerable:!0,get:function(){return W.build}}),Object.defineProperty(U,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(U,"getDocument",{enumerable:!0,get:function(){return W.getDocument}}),Object.defineProperty(U,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(U,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(U,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(U,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(U,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(U,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(U,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(U,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(U,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(U,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(U,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(U,"updateTextLayer",{enumerable:!0,get:function(){return f.updateTextLayer}}),Object.defineProperty(U,"version",{enumerable:!0,get:function(){return W.version}});var e=__w_pdfjs_require__(1),W=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),f=__w_pdfjs_require__(26),z=__w_pdfjs_require__(27),H=__w_pdfjs_require__(5),ut=__w_pdfjs_require__(29),k=__w_pdfjs_require__(14),w=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function U(n,f,z,H,ut,k){if(k!==ReactPropTypesSecret){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}U.isRequired=U;function e(){return U}var W={array:U,bigint:U,bool:U,func:U,number:U,object:U,string:U,symbol:U,any:U,arrayOf:e,element:U,elementType:U,instanceOf:e,node:U,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return W.PropTypes=W,W};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);var __spreadArray=function(U,e,W){if(W||arguments.length===2)for(var n=0,f=e.length,z;n<f;n++)(z||!(n in e))&&(z||(z=Array.prototype.slice.call(e,0,n)),z[n]=e[n]);return U.concat(z||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(U,e){var W={};return allEvents.forEach(function(n){var f=U[n];f&&(e?W[n]=function(z){return f(z,e(n))}:W[n]=f)}),W}function makeCancellablePromise(U){var e=!1,W=new Promise(function(n,f){U.then(function(z){return!e&&n(z)}).catch(function(z){return!e&&f(z)})});return{promise:W,cancel:function(){e=!0}}}function r(U){var e,W,n="";if(typeof U=="string"||typeof U=="number")n+=U;else if(typeof U=="object")if(Array.isArray(U)){var f=U.length;for(e=0;e<f;e++)U[e]&&(W=r(U[e]))&&(n&&(n+=" "),n+=W)}else for(W in U)U[W]&&(n&&(n+=" "),n+=W);return n}function clsx(){for(var U,e,W=0,n="",f=arguments.length;W<f;W++)(U=arguments[W])&&(e=r(U))&&(n&&(n+=" "),n+=e);return n}var prefix="Invariant failed";function invariant(U,e){if(!U)throw new Error(prefix)}function warning(U,e){}const DocumentContext=reactExports.createContext(null);function Message({children:U,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},U)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(W=>{invariant(this.pdfDocument),invariant(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(W):Array.isArray(e)?W(e):e.then(W)}).then(W=>{invariant(Array.isArray(W));const n=W[0];new Promise(f=>{invariant(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(z=>{f(z)}).catch(()=>{invariant(!1)}):typeof n=="number"?f(n):invariant(!1)}).then(f=>{const z=f+1;invariant(this.pdfViewer),invariant(z>=1&&z<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:W,pageIndex:f,pageNumber:z})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const W=e-1;invariant(this.pdfViewer),invariant(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:W,pageNumber:e})}addLinkAttributes(e,W,n){e.href=W,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u";function isDefined(U){return typeof U<"u"}function isProvided(U){return isDefined(U)&&U!==null}function isString(U){return typeof U=="string"}function isArrayBuffer(U){return U instanceof ArrayBuffer}function isBlob(U){return invariant(isBrowser),U instanceof Blob}function isDataURI(U){return isString(U)&&/^data:/.test(U)}function dataURItoByteString(U){invariant(isDataURI(U));const[e="",W=""]=U.split(",");return e.split(";").indexOf("base64")!==-1?atob(W):unescape(W)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}function cancelRunningTask(U){U&&U.cancel&&U.cancel()}function makePageCallback(U,e){return Object.defineProperty(U,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(U,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(U,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(U,"originalHeight",{get(){return this.view[3]},configurable:!0}),U}function isCancelException(U){return U.name==="RenderingCancelledException"}function loadFromFile(U){return new Promise((e,W)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return W(new Error("Error while reading a file."));e(n.result)},n.onerror=f=>{if(!f.target)return W(new Error("Error while reading a file."));const{error:z}=f.target;if(!z)return W(new Error("Error while reading a file."));switch(z.code){case z.NOT_FOUND_ERR:return W(new Error("Error while reading a file: File not found."));case z.SECURITY_ERR:return W(new Error("Error while reading a file: Security error."));case z.ABORT_ERR:return W(new Error("Error while reading a file: Aborted."));default:return W(new Error("Error while reading a file."))}},n.readAsArrayBuffer(U)})}function reducer(U,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return U}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const U={};return allEvents.forEach(e=>{U[e]=PropTypes.func}),U})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function U(e,W,n){const{[W]:f,pageNumber:z,pdf:H}=e;if(!isDefined(H))return null;if(isDefined(f)){if(typeof f!="number")return new Error(`\`${W}\` of type \`${typeof f}\` supplied to \`${n}\`, expected \`number\`.`);if(f<0)return new Error(`Expected \`${W}\` to be greater or equal to 0.`);const{numPages:ut}=H;if(f+1>ut)return new Error(`Expected \`${W}\` to be less or equal to ${ut-1}.`)}else if(!isDefined(z))return new Error(`\`${W}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function U(e,W,n){const{[W]:f,pageIndex:z,pdf:H}=e;if(!isDefined(H))return null;if(isDefined(f)){if(typeof f!="number")return new Error(`\`${W}\` of type \`${typeof f}\` supplied to \`${n}\`, expected \`number\`.`);if(f<1)return new Error(`Expected \`${W}\` to be greater or equal to 1.`);const{numPages:ut}=H;if(f>ut)return new Error(`Expected \`${W}\` to be less or equal to ${ut}.`)}else if(!isDefined(z))return new Error(`\`${W}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(U,e,W,n){function f(z){return z instanceof W?z:new W(function(H){H(z)})}return new(W||(W=Promise))(function(z,H){function ut(m){try{w(n.next(m))}catch(B){H(B)}}function k(m){try{w(n.throw(m))}catch(B){H(B)}}function w(m){m.done?z(m.value):f(m.value).then(ut,k)}w((n=n.apply(U,e||[])).next())})},__rest$1=function(U,e){var W={};for(var n in U)Object.prototype.hasOwnProperty.call(U,n)&&e.indexOf(n)<0&&(W[n]=U[n]);if(U!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,n=Object.getOwnPropertySymbols(U);f<n.length;f++)e.indexOf(n[f])<0&&Object.prototype.propertyIsEnumerable.call(U,n[f])&&(W[n[f]]=U[n[f]]);return W};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(U,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const W=prompt("Enter the password to open this PDF file.");U(W);break}case PasswordResponses.INCORRECT_PASSWORD:{const W=prompt("Invalid password. Please try again.");U(W);break}}},Document=reactExports.forwardRef(function U(e,W){var{children:n,className:f,error:z="Failed to load PDF file.",externalLinkRel:H,externalLinkTarget:ut,file:k,inputRef:w,imageResourcesPath:m,loading:B="Loading PDF…",noData:I="No PDF file specified.",onItemClick:_,onLoadError:b,onLoadProgress:T,onLoadSuccess:g,onPassword:u=defaultOnPassword,onSourceError:y,onSourceSuccess:D,options:v,renderMode:o,rotate:d}=e,l=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[c,h]=useResolver(),{value:O,error:a}=c,[E,x]=useResolver(),{value:et,error:$}=E,K=reactExports.useRef(new LinkService),G=reactExports.useRef([]),at=reactExports.useRef({scrollPageIntoView:ft=>{const{dest:bt,pageNumber:Z,pageIndex:tt=Z-1}=ft;if(_){_({dest:bt,pageIndex:tt,pageNumber:Z});return}const A=G.current[tt];if(A){A.scrollIntoView();return}}});reactExports.useImperativeHandle(W,()=>({linkService:K,pages:G,viewer:at}),[]);function C(){D&&D()}function V(){a&&(a.toString(),y&&y(a))}function nt(){h({type:"RESET"})}reactExports.useEffect(nt,[k,h]);const S=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!k)return null;if(typeof k=="string")return isDataURI(k)?{data:dataURItoByteString(k)}:{url:k};if(k instanceof PDFDataRangeTransport)return{range:k};if(isArrayBuffer(k))return{data:k};if(isBrowser&&isBlob(k))return{data:yield loadFromFile(k)};if(invariant(typeof k=="object"),invariant("data"in k||"range"in k||"url"in k),"url"in k&&typeof k.url=="string"&&isDataURI(k.url)){const{url:ft}=k,bt=__rest$1(k,["url"]),Z=dataURItoByteString(ft);return Object.assign({data:Z},bt)}return k}),[k]);reactExports.useEffect(()=>{const ft=makeCancellablePromise(S());return ft.promise.then(bt=>{h({type:"RESOLVE",value:bt})}).catch(bt=>{h({type:"REJECT",error:bt})}),()=>{cancelRunningTask(ft)}},[S,h]),reactExports.useEffect(()=>{if(!(typeof O>"u")){if(O===!1){V();return}C()}},[O]);function s(){et&&(g&&g(et),G.current=new Array(et.numPages),K.current.setDocument(et))}function i(){$&&($.toString(),b&&b($))}function p(){x({type:"RESET"})}reactExports.useEffect(p,[x,O]);function F(){if(!O)return;const ft=v?Object.assign(Object.assign({},O),v):O,bt=pdfjs.getDocument(ft);T&&(bt.onProgress=T),u&&(bt.onPassword=u);const Z=bt;return Z.promise.then(tt=>{x({type:"RESOLVE",value:tt})}).catch(tt=>{Z.destroyed||x({type:"REJECT",error:tt})}),()=>{Z.destroy()}}reactExports.useEffect(F,[v,x,O]),reactExports.useEffect(()=>{if(!(typeof et>"u")){if(et===!1){i();return}s()}},[et]);function M(){K.current.setViewer(at.current),K.current.setExternalLinkRel(H),K.current.setExternalLinkTarget(ut)}reactExports.useEffect(M,[H,ut]);function L(ft,bt){G.current[ft]=bt}function q(ft){delete G.current[ft]}const st=reactExports.useMemo(()=>({imageResourcesPath:m,linkService:K.current,onItemClick:_,pdf:et,registerPage:L,renderMode:o,rotate:d,unregisterPage:q}),[m,_,et,o,d]),ht=reactExports.useMemo(()=>makeEventProps(l,()=>et),[l,et]);function gt(){return React.createElement(DocumentContext.Provider,{value:st},n)}function yt(){return k?et==null?React.createElement(Message,{type:"loading"},typeof B=="function"?B():B):et===!1?React.createElement(Message,{type:"error"},typeof z=="function"?z():z):gt():React.createElement(Message,{type:"no-data"},typeof I=="function"?I():I)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",f),ref:w,style:{"--scale-factor":"1"}},ht),yt())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var U=[],e=0;e<arguments.length;e++)U[e]=arguments[e];var W=U.filter(Boolean);if(W.length<=1){var n=W[0];return n||null}return function(z){W.forEach(function(H){typeof H=="function"?H(z):H&&(H.current=z)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(U){return U in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(U){return"children"in U}function isStructTreeNodeWithOnlyContentChild(U){return isStructTreeNode(U)?U.children.length===1&&0 in U.children&&"id"in U.children[0]:!1}function getRoleAttributes(U){const e={};if(isStructTreeNode(U)){const{role:W}=U,n=W.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(W)){const f=PDF_ROLE_TO_HTML_ROLE[W];f&&(e.role=f)}}return e}function getBaseAttributes(U){const e={};if(isStructTreeNode(U)){if(U.alt!==void 0&&(e["aria-label"]=U.alt),U.lang!==void 0&&(e.lang=U.lang),isStructTreeNodeWithOnlyContentChild(U)){const[W]=U.children;if(W){const n=getBaseAttributes(W);return Object.assign(Object.assign({},e),n)}}}else"id"in U&&(e["aria-owns"]=U.id);return e}function getAttributes(U){return U?Object.assign(Object.assign({},getRoleAttributes(U)),getBaseAttributes(U)):null}function StructTreeItem({className:U,node:e}){const W=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((f,z)=>React.createElement(StructTreeItem,{key:z,node:f})),[e]);return React.createElement("span",Object.assign({className:U},W),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const U=usePageContext();invariant(U);const{onGetStructTreeError:e,onGetStructTreeSuccess:W}=U,[n,f]=useResolver(),{value:z,error:H}=n,{customTextRenderer:ut,page:k}=U;function w(){z&&W&&W(z)}function m(){H&&(H.toString(),e&&e(H))}function B(){f({type:"RESET"})}reactExports.useEffect(B,[f,k]);function I(){if(ut||!k)return;const _=makeCancellablePromise(k.getStructTree()),b=_;return _.promise.then(T=>{f({type:"RESOLVE",value:T})}).catch(T=>{f({type:"REJECT",error:T})}),()=>cancelRunningTask(b)}return reactExports.useEffect(I,[ut,k,f]),reactExports.useEffect(()=>{if(z!==void 0){if(z===!1){m();return}w()}},[z]),z?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:z}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(U){const e=usePageContext();invariant(e);const W=Object.assign(Object.assign({},e),U),{_className:n,canvasBackground:f,devicePixelRatio:z=getDevicePixelRatio(),onRenderError:H,onRenderSuccess:ut,page:k,renderForms:w,renderTextLayer:m,rotate:B,scale:I}=W,{canvasRef:_}=U;invariant(k);const b=reactExports.useRef(null);function T(){k&&ut&&ut(makePageCallback(k,I))}function g(o){isCancelException(o)||(o.toString(),H&&H(o))}const u=reactExports.useMemo(()=>k.getViewport({scale:I*z,rotation:B}),[z,k,B,I]),y=reactExports.useMemo(()=>k.getViewport({scale:I,rotation:B}),[k,B,I]);function D(){if(!k)return;k.cleanup();const{current:o}=b;if(!o)return;o.width=u.width,o.height=u.height,o.style.width=`${Math.floor(y.width)}px`,o.style.height=`${Math.floor(y.height)}px`,o.style.visibility="hidden";const d={annotationMode:w?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:o.getContext("2d",{alpha:!1}),viewport:u};f&&(d.background=f);const l=k.render(d),c=l;return l.promise.then(()=>{o.style.visibility="",T()}).catch(g),()=>cancelRunningTask(c)}reactExports.useEffect(D,[f,b,z,k,w,u,y]);const v=reactExports.useCallback(()=>{const{current:o}=b;o&&(o.width=0,o.height=0)},[b]);return reactExports.useEffect(()=>v,[v]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(_,b),style:{display:"block",userSelect:"none"}},m?React.createElement(StructTree,null):null)}function PageSVG(){const U=usePageContext();invariant(U);const{_className:e,onRenderSuccess:W,onRenderError:n,page:f,rotate:z,scale:H}=U;invariant(f);const[ut,k]=useResolver(),{value:w,error:m}=ut;function B(){f&&W&&W(makePageCallback(f,H))}function I(){m&&(isCancelException(m)||(m.toString(),n&&n(m)))}const _=reactExports.useMemo(()=>f.getViewport({scale:H,rotation:z}),[f,z,H]);function b(){k({type:"RESET"})}reactExports.useEffect(b,[f,k,_]);function T(){if(!f)return;const D=makeCancellablePromise(f.getOperatorList());return D.promise.then(v=>{new pdfjs.SVGGraphics(f.commonObjs,f.objs).getSVG(v,_).then(d=>{if(!(d instanceof SVGElement))throw new Error("getSVG returned unexpected result.");k({type:"RESOLVE",value:d})}).catch(d=>{k({type:"REJECT",error:d})})}).catch(v=>{k({type:"REJECT",error:v})}),()=>cancelRunningTask(D)}reactExports.useEffect(T,[f,k,_]),reactExports.useEffect(()=>{if(w!==void 0){if(w===!1){I();return}B()}},[w]);function g(D){if(!D||!w)return;D.firstElementChild||D.appendChild(w);const{width:v,height:o}=_;w.setAttribute("width",`${v}`),w.setAttribute("height",`${o}`)}const{width:u,height:y}=_;return React.createElement("div",{className:`${e}__svg`,ref:D=>g(D),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:u,height:y,userSelect:"none"}})}function isTextItem(U){return"str"in U}function TextLayer(){const U=usePageContext();invariant(U);const{customTextRenderer:e,onGetTextError:W,onGetTextSuccess:n,onRenderTextLayerError:f,onRenderTextLayerSuccess:z,page:H,pageIndex:ut,pageNumber:k,rotate:w,scale:m}=U;invariant(H);const[B,I]=useResolver(),{value:_,error:b}=B,T=reactExports.useRef(null),g=reactExports.useRef();parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10);function u(){_&&n&&n(_)}function y(){b&&(b.toString(),W&&W(b))}function D(){I({type:"RESET"})}reactExports.useEffect(D,[H,I]);function v(){if(!H)return;const a=makeCancellablePromise(H.getTextContent()),E=a;return a.promise.then(x=>{I({type:"RESOLVE",value:x})}).catch(x=>{I({type:"REJECT",error:x})}),()=>cancelRunningTask(E)}reactExports.useEffect(v,[H,I]),reactExports.useEffect(()=>{if(_!==void 0){if(_===!1){y();return}u()}},[_]);const o=reactExports.useCallback(()=>{z&&z()},[z]),d=reactExports.useCallback(a=>{a.toString(),f&&f(a)},[f]);function l(){const a=g.current;a&&a.classList.add("active")}function c(){const a=g.current;a&&a.classList.remove("active")}const h=reactExports.useMemo(()=>H.getViewport({scale:m,rotation:w}),[H,w,m]);function O(){if(!H||!_)return;const{current:a}=T;if(!a)return;a.innerHTML="";const E=H.streamTextContent({includeMarkedContent:!0}),x={container:a,textContentSource:E,viewport:h},et=pdfjs.renderTextLayer(x),$=et;return et.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",a.append(K),g.current=K;const G=a.querySelectorAll('[role="presentation"]');if(e){let at=0;_.items.forEach((C,V)=>{if(!isTextItem(C))return;const nt=G[at];if(!nt)return;const S=e(Object.assign({pageIndex:ut,pageNumber:k,itemIndex:V},C));nt.innerHTML=S,at+=C.str&&C.hasEOL?2:1})}o()}).catch(d),()=>cancelRunningTask($)}return reactExports.useLayoutEffect(O,[e,d,o,H,ut,k,_,h]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:c,onMouseDown:l,ref:T})}function AnnotationLayer(){const U=useDocumentContext();invariant(U);const e=usePageContext();invariant(e);const W=Object.assign(Object.assign({},U),e),{imageResourcesPath:n,linkService:f,onGetAnnotationsError:z,onGetAnnotationsSuccess:H,onRenderAnnotationLayerError:ut,onRenderAnnotationLayerSuccess:k,page:w,pdf:m,renderForms:B,rotate:I,scale:_=1}=W;invariant(w);const[b,T]=useResolver(),{value:g,error:u}=b,y=reactExports.useRef(null);parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10);function D(){g&&H&&H(g)}function v(){u&&(u.toString(),z&&z(u))}function o(){T({type:"RESET"})}reactExports.useEffect(o,[T,w]);function d(){if(!w)return;const a=makeCancellablePromise(w.getAnnotations()),E=a;return a.promise.then(x=>{T({type:"RESOLVE",value:x})}).catch(x=>{T({type:"REJECT",error:x})}),()=>{cancelRunningTask(E)}}reactExports.useEffect(d,[T,w,B]),reactExports.useEffect(()=>{if(g!==void 0){if(g===!1){v();return}D()}},[g]);function l(){k&&k()}function c(a){ut&&ut(a)}const h=reactExports.useMemo(()=>w.getViewport({scale:_,rotation:I}),[w,I,_]);function O(){if(!m||!w||!g)return;const{current:a}=y;if(!a)return;const E=h.clone({dontFlip:!0}),x={accessibilityManager:null,annotationCanvasMap:null,div:a,l10n:null,page:w,viewport:E},et={annotations:g,annotationStorage:m.annotationStorage,div:a,downloadManager:null,imageResourcesPath:n,linkService:f,page:w,renderForms:B,viewport:E};a.innerHTML="";try{new pdfjs.AnnotationLayer(x).render(et),l()}catch($){c($)}return()=>{}}return reactExports.useEffect(O,[g,n,f,w,B,h]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:y})}var __rest=function(U,e){var W={};for(var n in U)Object.prototype.hasOwnProperty.call(U,n)&&e.indexOf(n)<0&&(W[n]=U[n]);if(U!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,n=Object.getOwnPropertySymbols(U);f<n.length;f++)e.indexOf(n[f])<0&&Object.prototype.propertyIsEnumerable.call(U,n[f])&&(W[n[f]]=U[n[f]]);return W};const defaultScale=1,Page=function U(e){const W=useDocumentContext();invariant(W);const n=Object.assign(Object.assign({},W),e),{_className:f="react-pdf__Page",_enableRegisterUnregisterPage:z=!0,canvasBackground:H,canvasRef:ut,children:k,className:w,customRenderer:m,customTextRenderer:B,devicePixelRatio:I,error:_="Failed to load the page.",height:b,inputRef:T,loading:g="Loading page…",noData:u="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:D,onGetStructTreeError:v,onGetStructTreeSuccess:o,onGetTextError:d,onGetTextSuccess:l,onLoadError:c,onLoadSuccess:h,onRenderAnnotationLayerError:O,onRenderAnnotationLayerSuccess:a,onRenderError:E,onRenderSuccess:x,onRenderTextLayerError:et,onRenderTextLayerSuccess:$,pageIndex:K,pageNumber:G,pdf:at,registerPage:C,renderAnnotationLayer:V=!0,renderForms:nt=!1,renderMode:S="canvas",renderTextLayer:s=!0,rotate:i,scale:p=defaultScale,unregisterPage:F,width:M}=n,L=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[q,st]=useResolver(),{value:ht,error:gt}=q,yt=reactExports.useRef(null);invariant(at);const ft=isProvided(G)?G-1:K??null,bt=G??(isProvided(K)?K+1:null),Z=i??(ht?ht.rotate:null),tt=reactExports.useMemo(()=>{if(!ht)return null;let It=1;const Gt=p??defaultScale;if(M||b){const qt=ht.getViewport({scale:1,rotation:Z});M?It=M/qt.width:b&&(It=b/qt.height)}return Gt*It},[b,ht,Z,p,M]);function A(){return()=>{isProvided(ft)&&z&&F&&F(ft)}}reactExports.useEffect(A,[z,at,ft,F]);function N(){if(h){if(!ht||!tt)return;h(makePageCallback(ht,tt))}if(z&&C){if(!isProvided(ft)||!yt.current)return;C(ft,yt.current)}}function J(){gt&&(gt.toString(),c&&c(gt))}function it(){st({type:"RESET"})}reactExports.useEffect(it,[st,at,ft]);function mt(){if(!at||!bt)return;const It=makeCancellablePromise(at.getPage(bt)),Gt=It;return It.promise.then(qt=>{st({type:"RESOLVE",value:qt})}).catch(qt=>{st({type:"REJECT",error:qt})}),()=>cancelRunningTask(Gt)}reactExports.useEffect(mt,[st,at,ft,bt,C]),reactExports.useEffect(()=>{if(ht!==void 0){if(ht===!1){J();return}N()}},[ht,tt]);const St=reactExports.useMemo(()=>ht&&isProvided(ft)&&bt&&isProvided(Z)&&isProvided(tt)?{_className:f,canvasBackground:H,customTextRenderer:B,devicePixelRatio:I,onGetAnnotationsError:y,onGetAnnotationsSuccess:D,onGetStructTreeError:v,onGetStructTreeSuccess:o,onGetTextError:d,onGetTextSuccess:l,onRenderAnnotationLayerError:O,onRenderAnnotationLayerSuccess:a,onRenderError:E,onRenderSuccess:x,onRenderTextLayerError:et,onRenderTextLayerSuccess:$,page:ht,pageIndex:ft,pageNumber:bt,renderForms:nt,renderTextLayer:s,rotate:Z,scale:tt}:null,[f,H,B,I,y,D,v,o,d,l,O,a,E,x,et,$,ht,ft,bt,nt,s,Z,tt]),vt=reactExports.useMemo(()=>makeEventProps(L,()=>ht&&(tt?makePageCallback(ht,tt):void 0)),[L,ht,tt]),Q=`${ft}@${tt}/${Z}`,wt=`${ft}/${Z}`;function Pt(){switch(S){case"custom":return invariant(m),React.createElement(m,{key:`${Q}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${wt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${Q}_canvas`,canvasRef:ut})}}function Wt(){return s?React.createElement(TextLayer,{key:`${Q}_text`}):null}function Ut(){return V?React.createElement(AnnotationLayer,{key:`${Q}_annotations`}):null}function zt(){return React.createElement(PageContext.Provider,{value:St},Pt(),Wt(),Ut(),k)}function Ft(){return bt?at===null||ht===void 0||ht===null?React.createElement(Message,{type:"loading"},typeof g=="function"?g():g):at===!1||ht===!1?React.createElement(Message,{type:"error"},typeof _=="function"?_():_):zt():React.createElement(Message,{type:"no-data"},typeof u=="function"?u():u)}return React.createElement("div",Object.assign({className:clsx(f,w),"data-page-number":bt,ref:mergeRefs(T,yt),style:{"--scale-factor":`${tt}`,backgroundColor:H||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},vt),Ft())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";export{Document as D,Page as P,pdfjs as p};
